# Session Handoff - 2025-12-23

## Project State
- **Current branch**: main
- **Last commit**: cc70562 - docs: finalize roadmap, changelog, and learnings for onboarding audio & UI
- **Dev server**: `npm run dev`

## Changes Made This Session
| File | Change |
|------|--------|
| `src/features/onboarding/AudioContext.tsx` | Created new shared context for unified muting in onboarding. |
| `src/features/onboarding/WelcomeLayout.tsx` | Fixed "120% height" overflow bug; reduced button padding; integrated AudioContext. |
| `src/features/onboarding/SeniorWelcome.tsx` | Applied AudioContext to all videos; refined Unity video container layout. |
| `src/features/onboarding/RelativeWelcome.tsx` | Mirrored Senior audio logic for symmetry; ensured container dimension consistency. |
| `src/AppCore.tsx` | Refactored layout to use Flexbox `flex-col` for dynamic resizing; updated header to use `glass-panel`. |
| `docs/*.md` | Updated roadmap, changelog, dependencies, architecture, and learnings. |

## Key Patterns Discovered
- **Viewport Inheritance (Flexbox vs. dvh)**: Using `h-[100dvh]` inside nested components with siblings (headers/footers) causes overflow. Standardized on `flex-col` + `flex-1` + `min-h-0` for the content area.
- **Mixed-Orientation Media**: Portrait videos (9:16) in landscape-heavy apps require manual unconstraining (`w-auto h-full`) or a dedicated `MediaContainer` to prevent letterboxing.

## Decisions Made
| Decision | Rationale |
|----------|-----------|
| AudioContext over Local State | Mirror Protocol requires Senior/Relative views to stay in sync. Global muting ensures a consistent experience. |
| Flexible Video Container | Chose to keep white background and manual sizing for Unity video to avoid visual "jumps" reported by the user. |

## Active Issues
- [ ] **Video Refinement**: Standardize on a `MediaContainer` component for onboarding videos to handle aspect ratios cleanly without manual CSS overrides.
- [ ] **Asset Compression**: Onboarding videos and the static unicorn image are >2MB. Need to compress to <500KB/1.5MB for PWA performance.

## Quick Start for Next Session
1. Run `npm run dev`.
2. The current focus is **Refining Media Presentation**.
3. Start by looking at `src/features/onboarding/SeniorWelcome.tsx` (Scene 3 - Unity) to decide on a permanent `MediaContainer` component approach.
