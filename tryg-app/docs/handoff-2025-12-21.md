# Session Handoff - 2025-12-21

## Project State
- **Current branch**: main (assumed)
- **Dev server**: `npm run dev`

## Changes Made This Session
| File | Change |
|------|--------|
| `firestore.rules` | Added admin overwrite permissions for `dinko1991@hotmail.com`. |
| `firebase.json` | Added Firestore rules deployment config. |
| `.firebaserc` | Added default project alias. |
| `mcp_config.json` | **MAJOR REPAIR**: Fixed corruption, configured You.com as local npm package, switched GitHub to npx. |
| `docs/design_prompts.md` | Created documentation of specific design extraction prompts as requested. |
| `ShareModal.tsx` | Added readability styling to inputs and enabled relationship editing. |
| `SettingsModal.tsx` | Reverted to standard settings tabs (removed duplicate profile editing). |
| `FamilyPresence.tsx` | Fixed "-1m" timer bug. |

## Key Patterns Discovered
- **MCP Config Fragility**: The `mcp_config.json` is prone to corruption when multiple tools edit it concurrently or if terminal output buffers overlap. Always read before write, and use atomic writes if possible.
- **You.com MCP**: Requires `serverUrl` AND `url` (or `command` mapping) depending on the client. The most robust fix was switching to the local npm package `@youdotcom-oss/mcp`.
- **Firestore Admin**: For POCs, hardcoding an admin email in `firestore.rules` is a quick way to bypass strict "owner-only" policies without building a full role-based access control (RBAC) system.

## Decisions Made
| Decision | Rationale |
|----------|-----------|
| **Switch GitHub MCP to npx** | The Docker version was failing because Docker wasn't available/configured. `npx` works out of the box. |
| **Admin Email in Rules** | Faster to implement for the user's specific demo needs than a full "Family Admin" role. |

## Active Issues
- [ ] **GitHub PAT Security**: The PAT is stored in plaintext in a file in the user's home directory. This is standard for local config but worth noting.
- [ ] **You.com Rate Limits**: User encountered 429/502 errors previously; resolved by config change but upstream stability varies.

## Quick Start for Next Session
1. **Verify MCP**: Check that all 5 servers (Firebase, GitHub, Perplexity, You.com, Chrome) are green in the agent UI.
2. **Demo Prep**: The user is prepping for a demo. Ensure the "Superpower" editing in ShareModal works for `dinko1991@hotmail.com`.
3. **Design Reference**: If asked about design style, refer to `docs/design_prompts.md`.
