[{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\App.tsx","messages":[{"ruleId":"no-undef","severity":2,"message":"'React' is not defined.","line":18,"column":11,"nodeType":"Identifier","messageId":"undef","endLine":18,"endColumn":16},{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\App.tsx:42:13\n  40 |         const hasSeenOnboarding = localStorage.getItem('tryg_welcome_seen_v2');\n  41 |         if (!hasSeenOnboarding) {\n> 42 |             setShowOnboarding(true);\n     |             ^^^^^^^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  43 |         }\n  44 |     }, []);\n  45 |","line":42,"column":13,"nodeType":null,"endLine":42,"endColumn":30},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 't'. Either include it or remove the dependency array.","line":64,"column":8,"nodeType":"ArrayExpression","endLine":64,"endColumn":10,"suggestions":[{"desc":"Update the dependencies array to be: [t]","fix":{"range":[2352,2354],"text":"[t]"}}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from 'react';\r\nimport { Activity, RotateCcw, X } from 'lucide-react';\r\nimport { SeniorView } from './components/SeniorView';\r\nimport { RelativeView } from './components/RelativeView';\r\nimport { SeniorWelcome } from './features/onboarding/SeniorWelcome';\r\nimport { RelativeWelcome } from './features/onboarding/RelativeWelcome';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { FEATURES } from './config/features';\r\nimport { cn } from './lib/utils';\r\nimport { useTheme } from './contexts/ThemeContext';\r\nimport './index.css';\r\n\r\nimport './index.css';\r\n\r\ninterface NotificationType {\r\n    title: string;\r\n    body: string;\r\n    icon: React.ElementType;\r\n}\r\n\r\nexport default function TrygApp() {\r\n    const { t } = useTranslation();\r\n    const { setMode } = useTheme();\r\n    const [view, setView] = useState<'senior' | 'relative'>('senior');\r\n    const [showOnboarding, setShowOnboarding] = useState(false);\r\n\r\n    // Secret \"Backdoor\" Mode\r\n    const [showSecretScreen, setShowSecretScreen] = useState(false);\r\n\r\n    const [notification, setNotification] = useState<NotificationType | null>(null);\r\n\r\n    // Default to Midnight Theme on mount\r\n    useEffect(() => {\r\n        setMode('dark');\r\n    }, [setMode]);\r\n\r\n    // Force Onboarding for first-time visitors (or cleared cache)\r\n    useEffect(() => {\r\n        // ROTATED KEY to force onboarding for everyone one last time\r\n        const hasSeenOnboarding = localStorage.getItem('tryg_welcome_seen_v2');\r\n        if (!hasSeenOnboarding) {\r\n            setShowOnboarding(true);\r\n        }\r\n    }, []);\r\n\r\n    // Listen for the secret event from SettingsModal\r\n    useEffect(() => {\r\n        const handleSecret = () => setShowSecretScreen(true);\r\n        window.addEventListener('trigger-secret-unicorn', handleSecret);\r\n        return () => window.removeEventListener('trigger-secret-unicorn', handleSecret);\r\n    }, []);\r\n\r\n    // Simulated notification after 5 seconds (only if enabled)\r\n    useEffect(() => {\r\n        if (!FEATURES.demoNotification) return;\r\n        const timer = setTimeout(() => {\r\n            setNotification({\r\n                title: t('notification_water_title'),\r\n                body: t('notification_water_body'),\r\n                icon: Activity\r\n            });\r\n        }, 5000);\r\n        return () => clearTimeout(timer);\r\n    }, []);\r\n\r\n    // Clear notification after 4 seconds\r\n    useEffect(() => {\r\n        if (notification) {\r\n            const timer = setTimeout(() => setNotification(null), 4000);\r\n            return () => clearTimeout(timer);\r\n        }\r\n    }, [notification]);\r\n\r\n    const handleOnboardingComplete = () => {\r\n        localStorage.setItem('tryg_welcome_seen_v2', 'true');\r\n        setShowOnboarding(false);\r\n    };\r\n\r\n    const handleResetOnboarding = () => {\r\n        localStorage.removeItem('tryg_welcome_seen_v2');\r\n        // Also remove old key to be clean\r\n        localStorage.removeItem('tryg_welcome_seen');\r\n        setShowOnboarding(true);\r\n    };\r\n\r\n    // Render the Secret Screen (Isolated)\r\n    if (showSecretScreen) {\r\n        return (\r\n            <div className=\"flex justify-center items-center min-h-screen bg-zinc-900 p-4 font-sans\">\r\n                <div className=\"relative w-full max-w-md h-[850px] bg-black rounded-[3rem] overflow-hidden border-8 border-zinc-800 shadow-2xl ring-1 ring-zinc-700/50\">\r\n                    <button\r\n                        onClick={() => setShowSecretScreen(false)}\r\n                        className=\"absolute top-6 right-6 z-50 p-2 bg-black/40 backdrop-blur-md rounded-full text-white/70 hover:text-white\"\r\n                    >\r\n                        <X size={24} />\r\n                    </button>\r\n                    {view === 'senior' ? (\r\n                        <SeniorWelcome onComplete={() => setShowSecretScreen(false)} />\r\n                    ) : (\r\n                        <RelativeWelcome onComplete={() => setShowSecretScreen(false)} />\r\n                    )}\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div className=\"flex justify-center items-center min-h-screen bg-zinc-800 p-4 font-sans\">\r\n\r\n            {/* Phone Frame Simulator */}\r\n            <div className=\"relative w-full max-w-md h-[850px] bg-white rounded-[3rem] overflow-hidden border-8 border-zinc-900 shadow-2xl ring-1 ring-zinc-400/50\">\r\n\r\n                {/* Push Notification Banner */}\r\n                <div className={`\r\n                    absolute top-4 left-4 right-4 bg-white/90 backdrop-blur-md p-4 rounded-2xl shadow-xl z-[60]\r\n                    transform transition-all duration-500 ease-out border border-stone-200\r\n                    ${notification ? 'translate-y-12 opacity-100' : '-translate-y-40 opacity-0'}\r\n                `}>\r\n                    {notification && (\r\n                        <div className=\"flex gap-3 items-center\">\r\n                            <div className=\"bg-teal-100 p-2 rounded-xl\">\r\n                                <notification.icon className=\"w-6 h-6 text-teal-600\" />\r\n                            </div>\r\n                            <div>\r\n                                <h4 className=\"font-bold text-stone-800 text-sm\">{notification.title}</h4>\r\n                                <p className=\"text-stone-500 text-xs\">{notification.body}</p>\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n                </div>\r\n\r\n                <div className=\"relative h-full overflow-y-auto no-scrollbar\">\r\n                    {/* Role Toggles & Reset - ENHANCED VISIBILITY */}\r\n                    <div className=\"absolute top-4 right-4 z-50 flex gap-2\">\r\n                        <button\r\n                            onClick={handleResetOnboarding}\r\n                            className=\"p-2 bg-white/40 dark:bg-zinc-800/40 backdrop-blur-md border border-white/50 dark:border-zinc-700/50 rounded-full text-stone-900 dark:text-stone-100 shadow-sm transition-all hover:bg-white/60\"\r\n                            title=\"Reset Onboarding\"\r\n                        >\r\n                            <RotateCcw size={16} />\r\n                        </button>\r\n                        <div className=\"flex bg-white/40 dark:bg-zinc-800/40 backdrop-blur-md border border-white/50 dark:border-zinc-700/50 rounded-full p-1 shadow-sm\">\r\n                            <button\r\n                                onClick={() => setView('senior')}\r\n                                className={cn(\r\n                                    \"px-3 py-1.5 rounded-full text-xs font-bold transition-colors\",\r\n                                    view === 'senior'\r\n                                        ? \"bg-white text-stone-900 shadow-sm\"\r\n                                        : \"text-stone-700 dark:text-stone-300 hover:text-black dark:hover:text-white\"\r\n                                )}\r\n                            >\r\n                                {t('role_senior')}\r\n                            </button>\r\n                            <button\r\n                                onClick={() => setView('relative')}\r\n                                className={cn(\r\n                                    \"px-3 py-1.5 rounded-full text-xs font-bold transition-colors\",\r\n                                    view === 'relative'\r\n                                        ? \"bg-white text-stone-900 shadow-sm\"\r\n                                        : \"text-stone-700 dark:text-stone-300 hover:text-black dark:hover:text-white\"\r\n                                )}\r\n                            >\r\n                                {t('role_relative')}\r\n                            </button>\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Content */}\r\n                    <div className=\"flex-1 overflow-hidden h-full\">\r\n                        {showOnboarding ? (\r\n                            view === 'senior' ? (\r\n                                <SeniorWelcome onComplete={handleOnboardingComplete} />\r\n                            ) : (\r\n                                <RelativeWelcome onComplete={handleOnboardingComplete} />\r\n                            )\r\n                        ) : (\r\n                            view === 'senior' ? <SeniorView /> : <RelativeView />\r\n                        )}\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Home indicator */}\r\n                <div className=\"absolute bottom-2 left-1/2 transform -translate-x-1/2 w-32 h-1.5 bg-black/20 rounded-full z-50\"></div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\AppCore.tsx","messages":[{"ruleId":"no-undef","severity":2,"message":"'React' is not defined.","line":34,"column":11,"nodeType":"Identifier","messageId":"undef","endLine":34,"endColumn":16},{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\AppCore.tsx:92:13\n  90 |         const hasSeen = localStorage.getItem('tryg_welcome_seen_v2');\n  91 |         if (!hasSeen) {\n> 92 |             setShowOnboarding(true);\n     |             ^^^^^^^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  93 |         }\n  94 |     }, []);\n  95 |","line":92,"column":13,"nodeType":null,"endLine":92,"endColumn":30}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { CareCircleProvider } from './contexts/CareCircleContext';\r\nimport { LogOut, Settings, Users } from 'lucide-react';\r\nimport { SeniorView } from './components/SeniorView';\r\nimport { RelativeView } from './components/RelativeView';\r\nimport { SettingsModal } from './components/SettingsModal';\r\nimport { BottomNavigation } from './components/BottomNavigation';\r\nimport { PingNotification } from './features/thinkingOfYou';\r\nimport { InstallPrompt } from './components/InstallPrompt';\r\nimport { UpdateToast } from './components/UpdateToast';\r\nimport { PhotoUploadModal, PhotoViewerModal, PhotoNotificationBadge } from './features/photos';\r\nimport { ShareModal } from './components/ShareModal';\r\nimport { useTasks } from './features/tasks';\r\nimport { useSymptoms } from './features/symptoms';\r\nimport { Onboarding, SeniorWelcome, RelativeWelcome } from './features/onboarding';\r\nimport { X } from 'lucide-react';\r\n// import { useSettings } from './hooks/useSettings';\r\nimport { useWeeklyQuestions } from './features/weeklyQuestion';\r\nimport { usePings } from './features/thinkingOfYou';\r\nimport { useCheckIn } from './hooks/useCheckIn';\r\nimport { usePhotos } from './features/photos';\r\nimport { useMemberStatus } from './features/familyPresence';\r\nimport { playCompletionSound, playSuccessSound, playPingSound } from './utils/sounds';\r\nimport { FEATURES } from './config/features';\r\nimport { LivingBackground } from './components/ui/LivingBackground';\r\nimport './index.css';\r\nimport { User } from 'firebase/auth'; // Or your custom user type\r\nimport { AppTab, UserProfile, Member, Task, SymptomLog, CareCircle } from './types';\r\n\r\ninterface NotificationType {\r\n    title: string;\r\n    body: string;\r\n    icon: React.ElementType;\r\n}\r\n\r\n\r\nexport interface AppCoreProps {\r\n    user: User | null;\r\n    userProfile: UserProfile | null;\r\n    careCircle: CareCircle | null; // CareCircle but mapped from hook which might differ slightly\r\n    onSignOut: () => Promise<void>;\r\n    inviteCode: string | null;\r\n    onGetInviteCode: () => Promise<void>;\r\n    members?: Member[];\r\n    updateMember: (data: Partial<Member>) => Promise<void>;\r\n    updateAnyMember: (memberId: string, data: Partial<Member>) => Promise<void>;\r\n}\r\n\r\nexport default function TrygAppCore({\r\n    user,\r\n    userProfile,\r\n    careCircle,\r\n    onSignOut,\r\n    inviteCode,\r\n    onGetInviteCode,\r\n    members = [],\r\n    updateMember,\r\n    updateAnyMember,\r\n}: AppCoreProps) {\r\n    const { t, i18n } = useTranslation();\r\n    // View is determined by user role - no toggle allowed\r\n    const isSenior = userProfile?.role === 'senior';\r\n    // const [activePing, setActivePing] = useState(null); // Unused?\r\n    const [notification, setNotification] = useState<NotificationType | null>(null);\r\n    const [showSettings, setShowSettings] = useState(false);\r\n    const [showShare, setShowShare] = useState(false);\r\n    const [activeTab, setActiveTab] = useState<AppTab>('daily');\r\n    const [showPhotoViewer, setShowPhotoViewer] = useState(false);\r\n    const [showOnboarding, setShowOnboarding] = useState(false);\r\n    const [showSecretScreen, setShowSecretScreen] = useState(false);\r\n\r\n    const handleStartOnboarding = () => {\r\n        setShowSettings(false);\r\n        setShowOnboarding(true);\r\n    };\r\n\r\n    // 游游 JUZU EXCEPTION: Force Bosnian (Requested by User)\r\n    useEffect(() => {\r\n        const nameToCheck = (userProfile?.displayName || user?.displayName || '').toLowerCase();\r\n        if (nameToCheck.includes('juzu')) {\r\n            if (i18n.language !== 'bs') {\r\n                i18n.changeLanguage('bs');\r\n            }\r\n        }\r\n    }, [userProfile, user, i18n]);\r\n\r\n    // Force Onboarding logic\r\n    useEffect(() => {\r\n        const hasSeen = localStorage.getItem('tryg_welcome_seen_v2');\r\n        if (!hasSeen) {\r\n            setShowOnboarding(true);\r\n        }\r\n    }, []);\r\n\r\n    // Secret Screen Listener\r\n    useEffect(() => {\r\n        const handleSecret = () => setShowSecretScreen(true);\r\n        window.addEventListener('trigger-secret-unicorn', handleSecret);\r\n        return () => window.removeEventListener('trigger-secret-unicorn', handleSecret);\r\n    }, []);\r\n\r\n    const handleOnboardingComplete = () => {\r\n        localStorage.setItem('tryg_welcome_seen_v2', 'true');\r\n        setShowOnboarding(false);\r\n        setShowSecretScreen(false);\r\n    };\r\n\r\n    // Firebase hooks for real-time data\r\n    const { tasks, toggleTask, addTask } = useTasks(careCircle?.id);\r\n    const { symptoms, addSymptom } = useSymptoms(careCircle?.id);\r\n    // Per-member status tracking\r\n    const {\r\n        memberStatuses,\r\n        myStatus,\r\n        setMyStatus,\r\n        relativeStatuses,\r\n        seniorStatus\r\n    } = useMemberStatus(careCircle?.id, user?.uid ?? null, (userProfile?.displayName ?? undefined) as string | null, userProfile?.role ?? 'relative');\r\n    const {\r\n        answers: weeklyAnswers,\r\n        addAnswer: addWeeklyAnswer,\r\n        toggleLike: onToggleLike,\r\n        addReply: onReply\r\n    } = useWeeklyQuestions(careCircle?.id);\r\n    const { latestPing, sendPing, dismissPing } = usePings(careCircle?.id, user?.uid ?? null);\r\n    const { lastCheckIn, recordCheckIn } = useCheckIn(careCircle?.id);\r\n    const { latestPhoto, uploading, deletePhoto } = usePhotos(careCircle?.id, user?.uid ?? null);\r\n\r\n    // Incoming pings logic\r\n    useEffect(() => {\r\n        if (latestPing && FEATURES.pingSound) {\r\n            playPingSound();\r\n        }\r\n    }, [latestPing]);\r\n\r\n    // Notification clear logic\r\n    useEffect(() => {\r\n        if (notification) {\r\n            const timer = setTimeout(() => setNotification(null), 4000);\r\n            return () => clearTimeout(timer);\r\n        }\r\n    }, [notification]);\r\n\r\n    const handleToggleTask = async (id: string) => {\r\n        const task = tasks.find(t => t.id === id || t.id === `task_${id}`);\r\n        const willBeCompleted = task && !task.completed;\r\n        await toggleTask(id);\r\n        if (willBeCompleted && FEATURES.completionSounds) {\r\n            playCompletionSound();\r\n        }\r\n    };\r\n\r\n    const handleCheckIn = async () => {\r\n        await recordCheckIn();\r\n        if (FEATURES.completionSounds) {\r\n            playSuccessSound();\r\n        }\r\n    };\r\n\r\n    const handleAddSymptom = async (symptomData: Partial<SymptomLog>) => {\r\n        return await addSymptom(symptomData);\r\n    };\r\n\r\n    const handleAddTaskFromRelative = async (newTask: Partial<Task>) => {\r\n        return await addTask({\r\n            ...newTask,\r\n            createdByRole: 'relative',\r\n            createdByName: relativeName || userProfile?.displayName || 'Familie',\r\n            createdByUserId: user?.uid\r\n        });\r\n    };\r\n\r\n    const handleSendPing = async (toRole: 'senior' | 'relative') => {\r\n        const fromName = isSenior ? seniorName : relativeName;\r\n        return await sendPing(fromName, (user?.uid ?? undefined) as string, toRole);\r\n    };\r\n\r\n    const handleWeeklyAnswer = async (answer: string) => {\r\n        return await addWeeklyAnswer({\r\n            text: answer,\r\n            userId: user?.uid,\r\n            userName: isSenior ? seniorName : (relativeName || 'P친r칮rende')\r\n        });\r\n    };\r\n\r\n    // Live update: prefer real-time member data over static user profile\r\n    const currentMember = members.find(m => m.userId === user?.uid);\r\n    const seniorMember = members.find(m => m.role === 'senior');\r\n\r\n    const effectiveDisplayName = currentMember?.displayName || userProfile?.displayName;\r\n\r\n    // Get display names - Source of Truth is ALWAYS the membership record\r\n    const seniorName = seniorMember?.displayName || careCircle?.seniorName || (userProfile?.role === 'senior' ? effectiveDisplayName : 'Senior');\r\n\r\n    // Relative name logic\r\n    const relativeName = userProfile?.role === 'relative'\r\n        ? effectiveDisplayName || 'P친r칮rende'\r\n        : members.find(m => m.role === 'relative')?.displayName || 'P친r칮rende';\r\n\r\n    return (\r\n        <CareCircleProvider value={{\r\n            careCircleId: careCircle?.id ?? null,\r\n            seniorId: careCircle?.seniorId || null,\r\n            seniorName: seniorName,\r\n            currentUserId: user?.uid ?? null,\r\n            userRole: userProfile?.role ?? null,\r\n            userName: isSenior ? seniorName : relativeName,\r\n            relativeName: relativeName,\r\n            memberStatuses,\r\n            members,\r\n            relativeStatuses,\r\n            seniorStatus: seniorStatus || null,\r\n            myStatus: myStatus,\r\n            setMyStatus: setMyStatus,\r\n            activeTab: activeTab as AppTab,\r\n            setActiveTab: setActiveTab,\r\n            tasks,\r\n            toggleTask: handleToggleTask,\r\n            addTask: isSenior ? addTask : handleAddTaskFromRelative,\r\n            symptoms,\r\n            addSymptom: handleAddSymptom,\r\n            weeklyAnswers,\r\n            addWeeklyAnswer: handleWeeklyAnswer,\r\n            toggleLike: (answerId: string, userId: string, isLiked: boolean) => onToggleLike(answerId, userId, isLiked),\r\n            addReply: onReply,\r\n            latestPing,\r\n            sendPing: handleSendPing,\r\n            dismissPing: dismissPing,\r\n            lastCheckIn,\r\n            recordCheckIn: handleCheckIn,\r\n            updateMember: updateMember,\r\n            updateAnyMember: updateAnyMember\r\n        }}>\r\n            <div className=\"flex justify-center items-center min-h-screen bg-stone-50 dark:bg-zinc-950 sm:bg-zinc-800 sm:p-4\">\r\n\r\n                {/* Phone Frame Simulator (Responsive) */}\r\n                {/* Mobile: Full screen, no border. Desktop: Phone frame with border. */}\r\n                <div className=\"relative w-full sm:max-w-md h-[100dvh] sm:h-[850px] bg-white sm:rounded-[3rem] overflow-hidden sm:border-8 sm:border-zinc-900 shadow-2xl sm:ring-1 sm:ring-zinc-400/50 flex flex-col\">\r\n\r\n                    {/* Push Notification Banner */}\r\n                    <div className={`\r\n          absolute top-4 left-4 right-4 bg-white/90 backdrop-blur-md p-4 rounded-2xl shadow-xl z-[60]\r\n          transform transition-all duration-500 ease-out border border-stone-200\r\n          ${notification ? 'translate-y-12 opacity-100' : '-translate-y-40 opacity-0'}\r\n        `}>\r\n                        {notification && (\r\n                            <div className=\"flex gap-3 items-center\">\r\n                                <div className=\"bg-teal-100 p-2 rounded-xl\">\r\n                                    <notification.icon className=\"w-6 h-6 text-teal-600\" />\r\n                                </div>\r\n                                <div>\r\n                                    <h4 className=\"font-bold theme-text text-sm\">{notification.title}</h4>\r\n                                    <p className=\"theme-text-muted text-xs opacity-80\">{notification.body}</p>\r\n                                </div>\r\n                            </div>\r\n                        )}\r\n                    </div>\r\n\r\n                    {/* Header - COMPACT - Moved to Relative to push content down */}\r\n                    <div className=\"relative h-10 z-50 flex justify-between items-center px-3 glass-panel border-b-0 rounded-none bg-transparent shadow-none shrink-0\">\r\n                        <button\r\n                            onClick={() => setShowShare(true)}\r\n                            className=\"p-2 rounded-full hover:bg-black/10 dark:hover:bg-white/10 transition-colors\"\r\n                            aria-label=\"Care Circle\"\r\n                        >\r\n                            <Users className=\"w-5 h-5 theme-text\" />\r\n                        </button>\r\n\r\n                        <button\r\n                            onClick={() => setShowSettings(true)}\r\n                            className=\"p-2 rounded-full hover:bg-black/10 dark:hover:bg-white/10 transition-colors\"\r\n                            aria-label={t('settings')}\r\n                        >\r\n                            <Settings className=\"w-5 h-5 theme-text\" />\r\n                        </button>\r\n\r\n                        <button\r\n                            onClick={onSignOut}\r\n                            className=\"p-1.5 rounded-full hover:bg-black/10 dark:hover:bg-white/10 transition-colors\"\r\n                            aria-label={t('sign_out')}\r\n                        >\r\n                            <LogOut className=\"w-4 h-4 theme-text\" />\r\n                        </button>\r\n                    </div>\r\n\r\n                    {/* Care Circle & Family Share Modal */}\r\n                    {showShare && (\r\n                        <ShareModal\r\n                            members={members}\r\n                            inviteCode={inviteCode}\r\n                            onGetInviteCode={onGetInviteCode}\r\n                            seniorName={seniorName}\r\n                            currentUserId={user?.uid ?? undefined}\r\n                            onClose={() => setShowShare(false)}\r\n                        />\r\n                    )}\r\n\r\n                    {/* Unified Settings Modal */}\r\n                    {showSettings && (\r\n                        <SettingsModal\r\n                            user={user}\r\n                            careCircle={careCircle}\r\n                            onClose={() => setShowSettings(false)}\r\n                            onSignOut={onSignOut}\r\n                            onStartOnboarding={handleStartOnboarding}\r\n                        />\r\n                    )}\r\n\r\n                    {/* SECRET SCREEN OVERLAY */}\r\n                    {showSecretScreen && (\r\n                        <div className=\"absolute inset-0 z-[100] bg-zinc-900\">\r\n                            <button\r\n                                onClick={() => setShowSecretScreen(false)}\r\n                                className=\"absolute top-6 right-6 z-50 p-2 bg-black/40 backdrop-blur-md rounded-full text-white/70 hover:text-white\"\r\n                            >\r\n                                <X size={24} />\r\n                            </button>\r\n                            {isSenior ? (\r\n                                <SeniorWelcome onComplete={() => setShowSecretScreen(false)} />\r\n                            ) : (\r\n                                <RelativeWelcome onComplete={() => setShowSecretScreen(false)} />\r\n                            )}\r\n                        </div>\r\n                    )}\r\n\r\n                    <div className=\"flex-1 min-h-0 relative z-10\">\r\n                        {/* LivingBackground for circadian atmosphere (Living Design 游) */}\r\n                        {FEATURES.livingDesign ? (\r\n                            <LivingBackground>\r\n                                <div className=\"h-full overflow-hidden\">\r\n                                    {/* Ping Notification from Firestore */}\r\n                                    {latestPing && (\r\n                                        <PingNotification\r\n                                            ping={latestPing}\r\n                                            onDismiss={dismissPing}\r\n                                        />\r\n                                    )}\r\n\r\n                                    {showOnboarding ? (\r\n                                        <Onboarding show={showOnboarding} onComplete={handleOnboardingComplete} />\r\n                                    ) : (\r\n                                        isSenior ? (\r\n                                            <SeniorView />\r\n                                        ) : (\r\n                                            <RelativeView />\r\n                                        )\r\n                                    )}\r\n                                    {/* Photo notification badge */}\r\n                                    {latestPhoto && !showOnboarding && (\r\n                                        <div className=\"absolute bottom-24 left-4 right-4 z-40 flex justify-center\">\r\n                                            <PhotoNotificationBadge\r\n                                                photo={latestPhoto}\r\n                                                onClick={() => setShowPhotoViewer(true)}\r\n                                            />\r\n                                        </div>\r\n                                    )}\r\n                                </div>\r\n                            </LivingBackground>\r\n                        ) : (\r\n                            /* Fallback: Static gradient when Living Design is disabled */\r\n                            <div className=\"h-full bg-gradient-to-b from-sky-100 via-sky-50 to-stone-100 overflow-hidden\">\r\n                                <div className=\"h-full\">\r\n                                    {latestPing && (\r\n                                        <PingNotification\r\n                                            ping={latestPing}\r\n                                            onDismiss={dismissPing}\r\n                                        />\r\n                                    )}\r\n                                    {showOnboarding ? (\r\n                                        <Onboarding show={showOnboarding} onComplete={handleOnboardingComplete} />\r\n                                    ) : (\r\n                                        isSenior ? (\r\n                                            <SeniorView />\r\n                                        ) : (\r\n                                            <RelativeView />\r\n                                        )\r\n                                    )}\r\n                                    {latestPhoto && !showOnboarding && (\r\n                                        <div className=\"absolute bottom-24 left-4 right-4 z-40 flex justify-center\">\r\n                                            <PhotoNotificationBadge\r\n                                                photo={latestPhoto}\r\n                                                onClick={() => setShowPhotoViewer(true)}\r\n                                            />\r\n                                        </div>\r\n                                    )}\r\n                                </div>\r\n                            </div>\r\n                        )}\r\n                    </div>\r\n\r\n                    {/* Global Bottom Navigation (Shrink-0) */}\r\n                    <div className=\"shrink-0\">\r\n                        <BottomNavigation\r\n                            activeTab={activeTab}\r\n                            onTabChange={setActiveTab}\r\n                        />\r\n                    </div>\r\n\r\n                    {/* Photo upload modal */}\r\n                    <PhotoUploadModal isOpen={uploading} />\r\n\r\n                    {/* Photo viewer modal */}\r\n                    {showPhotoViewer && latestPhoto && (\r\n                        <PhotoViewerModal\r\n                            isOpen={showPhotoViewer}\r\n                            onClose={() => setShowPhotoViewer(false)}\r\n                            photo={latestPhoto}\r\n                            onDelete={async (id, path) => {\r\n                                await deletePhoto(id, path);\r\n                                setShowPhotoViewer(false);\r\n                            }}\r\n                        />\r\n                    )}\r\n\r\n                    {/* iOS PWA Install Prompt */}\r\n                    <InstallPrompt />\r\n\r\n                    {/* PWA Update Toast */}\r\n                    <UpdateToast />\r\n\r\n\r\n\r\n                    {/* Home indicator */}\r\n                    <div className=\"absolute bottom-2 left-1/2 transform -translate-x-1/2 w-32 h-1.5 bg-black/20 rounded-full z-50\"></div>\r\n                </div>\r\n            </div>\r\n        </CareCircleProvider>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\AppWithAuth.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\components\\AuthScreen.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\components\\BottomNavigation.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\components\\CircleSetup.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\components\\CloudDataCleaner.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\components\\ConsentModal.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\components\\CoordinationTab.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\components\\ErrorBoundary.tsx","messages":[{"ruleId":"no-undef","severity":2,"message":"'process' is not defined.","line":60,"column":22,"nodeType":"Identifier","messageId":"undef","endLine":60,"endColumn":29}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { ErrorInfo } from 'react';\r\nimport { AlertCircle, RefreshCw } from 'lucide-react';\r\nimport * as Sentry from '@sentry/react';\r\n\r\ninterface ErrorBoundaryProps {\r\n    children: React.ReactNode;\r\n}\r\n\r\ninterface ErrorBoundaryState {\r\n    hasError: boolean;\r\n    error: Error | null;\r\n}\r\n\r\nclass ErrorBoundary extends React.Component<ErrorBoundaryProps, ErrorBoundaryState> {\r\n    constructor(props: ErrorBoundaryProps) {\r\n        super(props);\r\n        this.state = { hasError: false, error: null };\r\n    }\r\n\r\n    static getDerivedStateFromError(error: Error): ErrorBoundaryState {\r\n        return { hasError: true, error };\r\n    }\r\n\r\n    componentDidCatch(error: Error, errorInfo: ErrorInfo) {\r\n        // Log to console in development\r\n        console.error('App Error:', error, errorInfo);\r\n\r\n        // Send to Sentry for production monitoring\r\n        Sentry.captureException(error, { contexts: { react: { componentStack: errorInfo.componentStack } } });\r\n    }\r\n\r\n    handleRetry = () => {\r\n        this.setState({ hasError: false, error: null });\r\n    };\r\n\r\n    render() {\r\n        if (this.state.hasError) {\r\n            return (\r\n                <div className=\"flex flex-col items-center justify-center min-h-screen bg-stone-50 p-8 text-center\">\r\n                    <div className=\"w-20 h-20 bg-orange-100 rounded-full flex items-center justify-center mb-6\">\r\n                        <AlertCircle className=\"w-10 h-10 text-orange-500\" />\r\n                    </div>\r\n\r\n                    <h1 className=\"text-2xl font-bold text-stone-800 mb-2\">\r\n                        Ups! Noget gik galt\r\n                    </h1>\r\n\r\n                    <p className=\"text-stone-500 mb-8 max-w-xs\">\r\n                        Der opstod en fejl. Pr칮v at genstarte appen.\r\n                    </p>\r\n\r\n                    <button\r\n                        onClick={this.handleRetry}\r\n                        className=\"flex items-center gap-2 bg-teal-600 text-white px-6 py-3 rounded-2xl font-semibold shadow-lg hover:bg-teal-700 transition-colors\"\r\n                    >\r\n                        <RefreshCw className=\"w-5 h-5\" />\r\n                        Pr칮v igen\r\n                    </button>\r\n\r\n                    {process.env.NODE_ENV === 'development' && this.state.error && (\r\n                        <details className=\"mt-8 text-left bg-stone-100 p-4 rounded-xl max-w-sm\">\r\n                            <summary className=\"text-sm text-stone-600 cursor-pointer\">\r\n                                Tekniske detaljer\r\n                            </summary>\r\n                            <pre className=\"text-xs text-red-600 mt-2 overflow-auto\">\r\n                                {this.state.error.toString()}\r\n                            </pre>\r\n                        </details>\r\n                    )}\r\n                </div>\r\n            );\r\n        }\r\n\r\n        return this.props.children;\r\n    }\r\n}\r\n\r\nexport default ErrorBoundary;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\components\\FamilyDataFixer.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\components\\InstallPrompt.tsx","messages":[{"ruleId":null,"message":"Unused eslint-disable directive (no problems were reported from 'react-refresh/only-export-components').","line":17,"column":1,"severity":1,"nodeType":null,"fix":{"range":[478,542],"text":" "}},{"ruleId":"no-undef","severity":2,"message":"'React' is not defined.","line":114,"column":29,"nodeType":"Identifier","messageId":"undef","endLine":114,"endColumn":34}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":1,"source":"// @ts-check\r\n/**\r\n * iOS PWA Install Prompt\r\n * \r\n * Shows installation instructions for iOS Safari users who haven't\r\n * added the app to their home screen yet. This improves the PWA\r\n * experience by guiding seniors to \"Add to Home Screen\".\r\n */\r\n\r\nimport { useState, useEffect } from 'react';\r\nimport { X, Share, Download } from 'lucide-react';\r\n\r\n/**\r\n * Android/Chrome Install Prompt Hook\r\n * Captures the 'beforeinstallprompt' event to show a custom install button\r\n */\r\n// eslint-disable-next-line react-refresh/only-export-components\r\ninterface BeforeInstallPromptEvent extends Event {\r\n    prompt: () => Promise<void>;\r\n    userChoice: Promise<{ outcome: 'accepted' | 'dismissed'; platform: string }>;\r\n}\r\n\r\nconst useAndroidInstallPrompt = () => {\r\n    const [deferredPrompt, setDeferredPrompt] = useState<BeforeInstallPromptEvent | null>(null);\r\n    const [showPrompt, setShowPrompt] = useState(false);\r\n\r\n    useEffect(() => {\r\n        const handler = (e: Event) => {\r\n            // Prevent Chrome 67 and earlier from automatically showing the prompt\r\n            e.preventDefault();\r\n            // Stash the event so it can be triggered later.\r\n            setDeferredPrompt(e as BeforeInstallPromptEvent);\r\n\r\n            // Check if dismissed recently\r\n            const wasDismissed = localStorage.getItem('pwa-android-dismissed');\r\n            if (!wasDismissed) {\r\n                setShowPrompt(true);\r\n            }\r\n        };\r\n\r\n        window.addEventListener('beforeinstallprompt', handler);\r\n        return () => window.removeEventListener('beforeinstallprompt', handler);\r\n    }, []);\r\n\r\n    const install = async () => {\r\n        if (!deferredPrompt) return;\r\n\r\n        // Show the install prompt\r\n        deferredPrompt.prompt();\r\n\r\n        // Wait for the user to respond to the prompt\r\n        const { outcome } = await deferredPrompt.userChoice;\r\n        console.log(`User response to the install prompt: ${outcome}`);\r\n\r\n        // We've used the prompt, and can't use it again, throw it away\r\n        setDeferredPrompt(null);\r\n        setShowPrompt(false);\r\n    };\r\n\r\n    const dismiss = () => {\r\n        setShowPrompt(false);\r\n        // Remember dismissal for a few days to not annoy user\r\n        localStorage.setItem('pwa-android-dismissed', Date.now().toString());\r\n    };\r\n\r\n    return { showAndroidPrompt: showPrompt && !!deferredPrompt, install, dismissAndroid: dismiss };\r\n};\r\n\r\n/**\r\n * Detects if user is on iOS Safari (not in standalone/PWA mode)\r\n */\r\nconst useIOSInstallPrompt = () => {\r\n    const [shouldShow, setShouldShow] = useState(false);\r\n    const [_dismissed, setDismissed] = useState(false);\r\n\r\n    useEffect(() => {\r\n        // Check if iOS device\r\n        // Check if iOS device\r\n        // MSStream is IE-specific, used for detection\r\n        const isIOS = /iPad|iPhone|iPod/.test(navigator.userAgent) && !('MSStream' in window);\r\n\r\n        // Check if already in standalone mode (installed as PWA)\r\n        // standalone is Safari-specific\r\n        interface NavigatorIOS extends Navigator {\r\n            standalone?: boolean;\r\n        }\r\n        const isStandalone = window.matchMedia('(display-mode: standalone)').matches ||\r\n            (window.navigator as NavigatorIOS).standalone === true;\r\n\r\n        // Check if already dismissed (stored in localStorage)\r\n        const wasDismissed = localStorage.getItem('pwa-install-dismissed');\r\n\r\n        if (isIOS && !isStandalone && !wasDismissed) {\r\n            // Delay showing prompt for better UX\r\n            const timer = setTimeout(() => setShouldShow(true), 2000);\r\n            return () => clearTimeout(timer);\r\n        }\r\n    }, []);\r\n\r\n    const dismiss = () => {\r\n        setDismissed(true);\r\n        setShouldShow(false);\r\n        // Remember dismissal for 7 days\r\n        localStorage.setItem('pwa-install-dismissed', Date.now().toString());\r\n    };\r\n\r\n    return { shouldShow, dismiss };\r\n};\r\n\r\n/**\r\n * PWA Install Prompt Component\r\n * Shows localized (Danish) instructions for adding to home screen\r\n */\r\nexport const InstallPrompt: React.FC = () => {\r\n    const { shouldShow: shouldShowIOS, dismiss: dismissIOS } = useIOSInstallPrompt();\r\n    const { showAndroidPrompt, install, dismissAndroid } = useAndroidInstallPrompt();\r\n\r\n    if (!shouldShowIOS && !showAndroidPrompt) return null;\r\n\r\n    // ANDROID / DESKTOP CHROME PROMPT\r\n    if (showAndroidPrompt) {\r\n        return (\r\n            <div className=\"fixed bottom-4 left-4 right-4 bg-white p-4 rounded-2xl shadow-xl z-50 animate-slide-up border border-teal-100 flex items-center justify-between\">\r\n                <div className=\"flex items-center gap-3\">\r\n                    <div className=\"w-10 h-10 bg-teal-100 rounded-xl flex items-center justify-center\">\r\n                        <Download className=\"w-5 h-5 text-teal-600\" />\r\n                    </div>\r\n                    <div>\r\n                        <p className=\"font-bold text-stone-800 text-sm\">Installer appen</p>\r\n                        <p className=\"text-xs text-stone-500\">For nemmere adgang</p>\r\n                    </div>\r\n                </div>\r\n                <div className=\"flex items-center gap-2\">\r\n                    <button\r\n                        onClick={dismissAndroid}\r\n                        className=\"p-2 text-stone-400 hover:text-stone-600\"\r\n                    >\r\n                        <X className=\"w-5 h-5\" />\r\n                    </button>\r\n                    <button\r\n                        onClick={install}\r\n                        className=\"bg-teal-600 text-white px-4 py-2 rounded-xl text-sm font-bold shadow-sm hover:bg-teal-700 transition-colors\"\r\n                    >\r\n                        Installer\r\n                    </button>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    // iOS PROMPT (Existing)\r\n    return (\r\n        <div className=\"fixed bottom-0 inset-x-0 bg-white p-6 shadow-2xl z-50 animate-slide-up border-t-4 border-teal-500 safe-area-bottom\">\r\n            {/* Close button */}\r\n            <button\r\n                onClick={dismissIOS}\r\n                className=\"absolute top-3 right-3 p-2 text-stone-400 hover:text-stone-600\"\r\n                aria-label=\"Luk\"\r\n            >\r\n                <X className=\"w-5 h-5\" />\r\n            </button>\r\n\r\n            {/* Icon */}\r\n            <div className=\"flex items-center gap-3 mb-3\">\r\n                <div className=\"w-12 h-12 bg-teal-100 rounded-xl flex items-center justify-center\">\r\n                    <Share className=\"w-6 h-6 text-teal-600\" />\r\n                </div>\r\n                <div>\r\n                    <p className=\"font-bold text-lg text-stone-800\">F친 den bedste oplevelse</p>\r\n                    <p className=\"text-sm text-stone-500\">Installer appen p친 din hjemmesk칝rm</p>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Instructions */}\r\n            <div className=\"bg-stone-50 rounded-xl p-4 mb-4\">\r\n                <ol className=\"space-y-3 text-stone-700\">\r\n                    <li className=\"flex items-center gap-3\">\r\n                        <span className=\"w-6 h-6 bg-teal-500 text-white rounded-full flex items-center justify-center text-sm font-bold\">1</span>\r\n                        <span>Tryk p친 <span className=\"inline-flex items-center gap-1 font-bold text-blue-600\"><Share className=\"w-4 h-4\" /> Del</span> knappen nedenfor</span>\r\n                    </li>\r\n                    <li className=\"flex items-center gap-3\">\r\n                        <span className=\"w-6 h-6 bg-teal-500 text-white rounded-full flex items-center justify-center text-sm font-bold\">2</span>\r\n                        <span>V칝lg <span className=\"font-bold\">\"F칮j til hjemmesk칝rm\"</span></span>\r\n                    </li>\r\n                    <li className=\"flex items-center gap-3\">\r\n                        <span className=\"w-6 h-6 bg-teal-500 text-white rounded-full flex items-center justify-center text-sm font-bold\">3</span>\r\n                        <span>Tryk <span className=\"font-bold\">\"Tilf칮j\"</span> 칮verst til h칮jre</span>\r\n                    </li>\r\n                </ol>\r\n            </div>\r\n\r\n            {/* Bouncing arrow pointing to Safari's share button */}\r\n            <div className=\"flex flex-col items-center text-stone-400\">\r\n                <span className=\"text-xs mb-1\">Del-knappen er her</span>\r\n                <span className=\"text-2xl animate-bounce\">游녢</span>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default InstallPrompt;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\components\\LanguageSwitcher.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\components\\PrivacySettings.tsx","messages":[{"ruleId":"no-undef","severity":2,"message":"'React' is not defined.","line":32,"column":31,"nodeType":"Identifier","messageId":"undef","endLine":32,"endColumn":36}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// Privacy Settings Screen - GDPR data export, deletion, and pause controls\r\n// Accessible from app settings\r\n\r\nimport { useState } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport {\r\n    Shield,\r\n    Download,\r\n    Trash2,\r\n    Pause,\r\n    Play,\r\n    ChevronRight,\r\n    AlertTriangle,\r\n    Check,\r\n    Loader2,\r\n    X\r\n} from 'lucide-react';\r\nimport { collection, getDocs, doc, writeBatch } from 'firebase/firestore';\r\nimport { deleteUser, User } from 'firebase/auth';\r\nimport { db, auth } from '../config/firebase';\r\nimport { CareCircle } from '../types';\r\nimport { Task, SymptomLog } from '../types';\r\n\r\nexport interface PrivacySettingsProps {\r\n    user: User; // User from firebase/auth\r\n    careCircle: CareCircle | null;\r\n    onClose: () => void;\r\n    onPauseChange?: (paused: boolean) => void;\r\n    isPaused?: boolean;\r\n}\r\n\r\nexport const PrivacySettings: React.FC<PrivacySettingsProps> = ({\r\n    user,\r\n    careCircle,\r\n    onClose,\r\n    onPauseChange,\r\n    isPaused = false\r\n}) => {\r\n    const { t } = useTranslation();\r\n    const [exporting, setExporting] = useState(false);\r\n    const [exported, setExported] = useState(false);\r\n    const [showDeleteConfirm, setShowDeleteConfirm] = useState(false);\r\n    const [deleting, setDeleting] = useState(false);\r\n    const [deleteError, setDeleteError] = useState<string | null>(null);\r\n\r\n    // Export all user data as JSON\r\n    const handleExportData = async () => {\r\n        setExporting(true);\r\n        try {\r\n            const exportData = {\r\n                exportDate: new Date().toISOString(),\r\n                user: {\r\n                    email: user.email,\r\n                    displayName: user.displayName,\r\n                    uid: user.uid,\r\n                },\r\n                careCircle: careCircle ? {\r\n                    id: careCircle.id,\r\n                    seniorName: careCircle.seniorName,\r\n                } : null,\r\n                tasks: [] as Task[],\r\n                symptoms: [] as SymptomLog[],\r\n                settings: [] as Record<string, unknown>[],\r\n            };\r\n\r\n            if (careCircle?.id) {\r\n                // Fetch tasks\r\n                const tasksSnapshot = await getDocs(\r\n                    collection(db, 'careCircles', careCircle.id, 'tasks')\r\n                );\r\n                exportData.tasks = tasksSnapshot.docs.map(d => ({ id: d.id, ...d.data() })) as Task[];\r\n\r\n                // Fetch symptoms\r\n                const symptomsSnapshot = await getDocs(\r\n                    collection(db, 'careCircles', careCircle.id, 'symptoms')\r\n                );\r\n                exportData.symptoms = symptomsSnapshot.docs.map(d => ({ id: d.id, ...d.data() })) as SymptomLog[];\r\n\r\n                // Fetch settings\r\n                const settingsDoc = await getDocs(\r\n                    collection(db, 'careCircles', careCircle.id, 'settings')\r\n                );\r\n                exportData.settings = settingsDoc.docs.map(d => ({ id: d.id, ...d.data() }));\r\n            }\r\n\r\n            // Create and download JSON file\r\n            const blob = new Blob([JSON.stringify(exportData, null, 2)], { type: 'application/json' });\r\n            const url = URL.createObjectURL(blob);\r\n            const a = document.createElement('a');\r\n            a.href = url;\r\n            a.download = `tryg-data-export-${new Date().toISOString().split('T')[0]}.json`;\r\n            document.body.appendChild(a);\r\n            a.click();\r\n            document.body.removeChild(a);\r\n            URL.revokeObjectURL(url);\r\n\r\n            setExported(true);\r\n            setTimeout(() => setExported(false), 3000);\r\n        } catch (err) {\r\n            console.error('Export error:', err);\r\n            alert(t('privacy_export_error'));\r\n        } finally {\r\n            setExporting(false);\r\n        }\r\n    };\r\n\r\n    // Delete all user data and account\r\n    const handleDeleteAccount = async () => {\r\n        setDeleting(true);\r\n        setDeleteError(null);\r\n\r\n        try {\r\n            const batch = writeBatch(db);\r\n\r\n            // Delete care circle data if exists\r\n            if (careCircle?.id) {\r\n                // Delete tasks\r\n                const tasksSnapshot = await getDocs(\r\n                    collection(db, 'careCircles', careCircle.id, 'tasks')\r\n                );\r\n                tasksSnapshot.docs.forEach(d => batch.delete(d.ref));\r\n\r\n                // Delete symptoms\r\n                const symptomsSnapshot = await getDocs(\r\n                    collection(db, 'careCircles', careCircle.id, 'symptoms')\r\n                );\r\n                symptomsSnapshot.docs.forEach(d => batch.delete(d.ref));\r\n\r\n                // Delete settings\r\n                const settingsSnapshot = await getDocs(\r\n                    collection(db, 'careCircles', careCircle.id, 'settings')\r\n                );\r\n                settingsSnapshot.docs.forEach(d => batch.delete(d.ref));\r\n\r\n                // Delete pings\r\n                const pingsSnapshot = await getDocs(\r\n                    collection(db, 'careCircles', careCircle.id, 'pings')\r\n                );\r\n                pingsSnapshot.docs.forEach(d => batch.delete(d.ref));\r\n\r\n                // Delete membership\r\n                batch.delete(doc(db, 'careCircleMemberships', `${careCircle.id}_${user.uid}`));\r\n\r\n                // If user is the senior (owner), delete the circle itself\r\n                if (careCircle.seniorId === user.uid) {\r\n                    batch.delete(doc(db, 'careCircles', careCircle.id));\r\n                }\r\n            }\r\n\r\n            // Delete user profile\r\n            batch.delete(doc(db, 'users', user.uid));\r\n\r\n            // Commit all deletes\r\n            await batch.commit();\r\n\r\n            // Delete Firebase Auth account\r\n            if (auth.currentUser) {\r\n                await deleteUser(auth.currentUser);\r\n            }\r\n\r\n            // User is now logged out, page will redirect to login\r\n        } catch (err: unknown) {\r\n            console.error('Delete error:', err);\r\n            if ((err as { code?: string }).code === 'auth/requires-recent-login') {\r\n                setDeleteError(t('privacy_error_relogin'));\r\n            } else {\r\n                setDeleteError(t('privacy_error_generic'));\r\n            }\r\n            setDeleting(false);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50\">\r\n            <div className=\"bg-white rounded-3xl shadow-2xl w-full max-w-md max-h-[90vh] overflow-y-auto\">\r\n\r\n                {/* Header */}\r\n                <div className=\"sticky top-0 bg-white p-4 border-b border-stone-100 flex items-center justify-between\">\r\n                    <div className=\"flex items-center gap-3\">\r\n                        <div className=\"w-10 h-10 bg-teal-100 rounded-xl flex items-center justify-center\">\r\n                            <Shield className=\"w-5 h-5 text-teal-600\" />\r\n                        </div>\r\n                        <h2 className=\"text-xl font-bold text-stone-800\">{t('privacy_title')}</h2>\r\n                    </div>\r\n                    <button\r\n                        onClick={onClose}\r\n                        className=\"p-2 rounded-full hover:bg-stone-100 transition-colors\"\r\n                    >\r\n                        <X className=\"w-5 h-5 text-stone-500\" />\r\n                    </button>\r\n                </div>\r\n\r\n                <div className=\"p-4 space-y-4\">\r\n\r\n                    {/* Pause Sharing */}\r\n                    <div className=\"bg-stone-50 rounded-2xl p-4\">\r\n                        <div className=\"flex items-center justify-between\">\r\n                            <div className=\"flex items-center gap-3\">\r\n                                {isPaused ? (\r\n                                    <Pause className=\"w-6 h-6 text-amber-600\" />\r\n                                ) : (\r\n                                    <Play className=\"w-6 h-6 text-teal-600\" />\r\n                                )}\r\n                                <div>\r\n                                    <h3 className=\"font-bold text-stone-800\">{t('privacy_pause_sharing')}</h3>\r\n                                    <p className=\"text-sm text-stone-500\">\r\n                                        {isPaused ? t('privacy_pause_on') : t('privacy_pause_off')}\r\n                                    </p>\r\n                                </div>\r\n                            </div>\r\n                            <button\r\n                                onClick={() => onPauseChange?.(!isPaused)}\r\n                                className={`w-14 h-8 rounded-full transition-colors relative ${isPaused ? 'bg-amber-500' : 'bg-teal-500'\r\n                                    }`}\r\n                            >\r\n                                <div className={`absolute top-1 w-6 h-6 bg-white rounded-full shadow transition-transform ${isPaused ? 'left-7' : 'left-1'\r\n                                    }`} />\r\n                            </button>\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Export Data */}\r\n                    <button\r\n                        onClick={handleExportData}\r\n                        disabled={exporting}\r\n                        className=\"w-full bg-stone-50 rounded-2xl p-4 flex items-center justify-between hover:bg-stone-100 transition-colors disabled:opacity-50\"\r\n                    >\r\n                        <div className=\"flex items-center gap-3\">\r\n                            {exporting ? (\r\n                                <Loader2 className=\"w-6 h-6 text-teal-600 animate-spin\" />\r\n                            ) : exported ? (\r\n                                <Check className=\"w-6 h-6 text-teal-600\" />\r\n                            ) : (\r\n                                <Download className=\"w-6 h-6 text-teal-600\" />\r\n                            )}\r\n                            <div className=\"text-left\">\r\n                                <h3 className=\"font-bold text-stone-800\">{t('privacy_download_data')}</h3>\r\n                                <p className=\"text-sm text-stone-500\">{t('privacy_download_desc')}</p>\r\n                            </div>\r\n                        </div>\r\n                        <ChevronRight className=\"w-5 h-5 text-stone-400\" />\r\n                    </button>\r\n\r\n                    {/* Delete Account */}\r\n                    {!showDeleteConfirm ? (\r\n                        <button\r\n                            onClick={() => setShowDeleteConfirm(true)}\r\n                            className=\"w-full bg-red-50 rounded-2xl p-4 flex items-center justify-between hover:bg-red-100 transition-colors\"\r\n                        >\r\n                            <div className=\"flex items-center gap-3\">\r\n                                <Trash2 className=\"w-6 h-6 text-red-600\" />\r\n                                <div className=\"text-left\">\r\n                                    <h3 className=\"font-bold text-red-800\">{t('privacy_delete_account')}</h3>\r\n                                    <p className=\"text-sm text-red-600\">{t('privacy_delete_desc')}</p>\r\n                                </div>\r\n                            </div>\r\n                            <ChevronRight className=\"w-5 h-5 text-red-400\" />\r\n                        </button>\r\n                    ) : (\r\n                        <div className=\"bg-red-50 rounded-2xl p-4 border-2 border-red-200\">\r\n                            <div className=\"flex items-center gap-2 mb-3\">\r\n                                <AlertTriangle className=\"w-6 h-6 text-red-600\" />\r\n                                <h3 className=\"font-bold text-red-800\">{t('privacy_confirm_title')}</h3>\r\n                            </div>\r\n                            <p className=\"text-sm text-red-700 mb-4\">\r\n                                {t('privacy_confirm_desc')}\r\n                            </p>\r\n\r\n                            {deleteError && (\r\n                                <div className=\"bg-red-100 text-red-800 p-3 rounded-xl text-sm mb-4\">\r\n                                    {deleteError}\r\n                                </div>\r\n                            )}\r\n\r\n                            <div className=\"flex gap-2\">\r\n                                <button\r\n                                    onClick={() => setShowDeleteConfirm(false)}\r\n                                    className=\"flex-1 py-2 bg-white text-stone-700 rounded-xl font-medium hover:bg-stone-100\"\r\n                                >\r\n                                    {t('privacy_cancel')}\r\n                                </button>\r\n                                <button\r\n                                    onClick={handleDeleteAccount}\r\n                                    disabled={deleting}\r\n                                    className=\"flex-1 py-2 bg-red-600 text-white rounded-xl font-medium hover:bg-red-700 disabled:opacity-50 flex items-center justify-center gap-2\"\r\n                                >\r\n                                    {deleting ? (\r\n                                        <>\r\n                                            <Loader2 className=\"w-4 h-4 animate-spin\" />\r\n                                            {t('privacy_deleting')}\r\n                                        </>\r\n                                    ) : (\r\n                                        t('privacy_confirm_delete')\r\n                                    )}\r\n                                </button>\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n\r\n                    {/* Info section */}\r\n                    <div className=\"text-center pt-4\">\r\n                        <p className=\"text-xs text-stone-400\">\r\n                            {t('privacy_info_storage')}\r\n                        </p>\r\n                        <a\r\n                            href=\"/privacy-policy.html\"\r\n                            className=\"text-xs text-teal-600 hover:underline\"\r\n                        >\r\n                            {t('privacy_policy_link')}\r\n                        </a>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default PrivacySettings;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\components\\RelativeView.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\components\\SeniorView.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\components\\SettingsModal.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'resolvePath' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":9,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":9,"endColumn":21},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":13,"column":17,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":13,"endColumn":20,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[602,605],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[602,605],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":56,"column":27,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":56,"endColumn":30,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2209,2212],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2209,2212],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useMemo } from 'react';\r\nimport { Modal } from './ui/Modal';\r\nimport { Button } from './ui/Button';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { useTheme } from '../contexts/ThemeContext';\r\nimport { Sun, Moon, SunMoon, Globe, Shield, LogOut, Download, Trash2, ChevronRight, BookOpen } from 'lucide-react';\r\nimport { User } from 'firebase/auth';\r\nimport { deleteUser, reauthenticateWithPopup, GoogleAuthProvider } from 'firebase/auth';\r\nimport { resolvePath } from '../utils/assetUtils';\r\n\r\ninterface SettingsModalProps {\r\n    user: User | null;\r\n    careCircle: any;\r\n    onClose: () => void;\r\n    onSignOut: () => void;\r\n    onStartOnboarding: () => void;\r\n}\r\n\r\n// 游 TURBO: Moved `languages` array outside the component.\r\n// This prevents it from being recreated on every render, reducing garbage collection pressure.\r\nconst languages = [\r\n    { code: 'da', label: 'Dansk', flag: '游뾇릖' },\r\n    { code: 'bs', label: 'Bosanski', flag: '游游' },\r\n    { code: 'tr', label: 'T칲rk칞e', flag: '游좷릖' }\r\n];\r\n\r\nexport const SettingsModal: React.FC<SettingsModalProps> = ({\r\n    user,\r\n    careCircle,\r\n    onClose,\r\n    onSignOut,\r\n    onStartOnboarding\r\n}) => {\r\n    const { t, i18n } = useTranslation();\r\n    const { mode, setMode } = useTheme();\r\n    const [showPrivacy, setShowPrivacy] = useState(false);\r\n    const [showDeleteConfirm, setShowDeleteConfirm] = useState(false);\r\n    const [deleting, setDeleting] = useState(false);\r\n    const [pauseSharing, setPauseSharing] = useState(false);\r\n\r\n    // 游 TURBO: Memoized `themes` array to avoid recreation on re-renders.\r\n    // The `t` function from i18next is stable, so this only computes once.\r\n    const themes = useMemo(() => [\r\n        { id: 'auto', label: t('theme_auto', 'Auto (F칮lger solen)'), icon: SunMoon },\r\n        { id: 'light', label: t('theme_light', 'Lys'), icon: Sun },\r\n        { id: 'dark', label: t('theme_dark', 'M칮rk'), icon: Moon }\r\n    ], [t]);\r\n\r\n    const handleDeleteAccount = async () => {\r\n        if (!user) return;\r\n        setDeleting(true);\r\n        try {\r\n            // Re-authenticate if needed\r\n            try {\r\n                await deleteUser(user);\r\n            } catch (err: any) {\r\n                if (err.code === 'auth/requires-recent-login') {\r\n                    const provider = new GoogleAuthProvider();\r\n                    await reauthenticateWithPopup(user, provider);\r\n                    await deleteUser(user);\r\n                } else {\r\n                    throw err;\r\n                }\r\n            }\r\n            onClose();\r\n        } catch (error) {\r\n            console.error('Error deleting account:', error);\r\n            alert(t('privacy_error_generic'));\r\n        } finally {\r\n            setDeleting(false);\r\n        }\r\n    };\r\n\r\n    const handleExportData = async () => {\r\n        // Simple data export - in production would be more comprehensive\r\n        const data = {\r\n            email: user?.email,\r\n            circleId: careCircle?.id,\r\n            exportedAt: new Date().toISOString()\r\n        };\r\n        const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });\r\n        const url = URL.createObjectURL(blob);\r\n        const a = document.createElement('a');\r\n        a.href = url;\r\n        a.download = 'tryg-data-export.json';\r\n        a.click();\r\n    };\r\n\r\n    // Privacy sub-view\r\n    if (showPrivacy) {\r\n        return (\r\n            <Modal isOpen={true} onClose={() => setShowPrivacy(false)} title={t('privacy_title')}>\r\n                <div className=\"space-y-4 relative min-h-[400px] pb-12\">\r\n                    {/* Pause Sharing Toggle */}\r\n                    <div className=\"flex items-center justify-between p-4 bg-stone-50 rounded-xl\">\r\n                        <div>\r\n                            <h4 className=\"font-bold text-stone-800\">{t('privacy_pause_sharing')}</h4>\r\n                            <p className=\"text-xs text-stone-500\">\r\n                                {pauseSharing ? t('privacy_pause_on') : t('privacy_pause_off')}\r\n                            </p>\r\n                        </div>\r\n                        <button\r\n                            onClick={() => setPauseSharing(!pauseSharing)}\r\n                            className={`w-14 h-8 rounded-full transition-colors ${pauseSharing ? 'bg-amber-500' : 'bg-stone-300'}`}\r\n                        >\r\n                            <div className={`w-6 h-6 bg-white rounded-full shadow transition-transform ${pauseSharing ? 'translate-x-7' : 'translate-x-1'}`} />\r\n                        </button>\r\n                    </div>\r\n\r\n                    {/* Download Data */}\r\n                    <button\r\n                        onClick={handleExportData}\r\n                        className=\"w-full flex items-center justify-between p-4 bg-stone-50 rounded-xl hover:bg-stone-100 transition-colors\"\r\n                    >\r\n                        <div className=\"flex items-center gap-3\">\r\n                            <Download className=\"w-5 h-5 text-teal-600\" />\r\n                            <div className=\"text-left\">\r\n                                <h4 className=\"font-bold text-stone-800\">{t('privacy_download_data')}</h4>\r\n                                <p className=\"text-xs text-stone-500\">{t('privacy_download_desc')}</p>\r\n                            </div>\r\n                        </div>\r\n                        <ChevronRight className=\"w-5 h-5 text-stone-400\" />\r\n                    </button>\r\n\r\n                    {/* Delete Account */}\r\n                    {!showDeleteConfirm ? (\r\n                        <button\r\n                            onClick={() => setShowDeleteConfirm(true)}\r\n                            className=\"w-full flex items-center justify-between p-4 bg-red-50 rounded-xl hover:bg-red-100 transition-colors\"\r\n                        >\r\n                            <div className=\"flex items-center gap-3\">\r\n                                <Trash2 className=\"w-5 h-5 text-red-600\" />\r\n                                <div className=\"text-left\">\r\n                                    <h4 className=\"font-bold text-red-700\">{t('privacy_delete_account')}</h4>\r\n                                    <p className=\"text-xs text-red-500\">{t('privacy_delete_desc')}</p>\r\n                                </div>\r\n                            </div>\r\n                            <ChevronRight className=\"w-5 h-5 text-red-400\" />\r\n                        </button>\r\n                    ) : (\r\n                        <div className=\"p-4 bg-red-50 rounded-xl border-2 border-red-200 space-y-3\">\r\n                            <h4 className=\"font-bold text-red-700\">{t('privacy_confirm_title')}</h4>\r\n                            <p className=\"text-sm text-red-600\">{t('privacy_confirm_desc')}</p>\r\n                            <div className=\"flex gap-2\">\r\n                                <Button\r\n                                    variant=\"secondary\"\r\n                                    size=\"small\"\r\n                                    onClick={() => setShowDeleteConfirm(false)}\r\n                                    className=\"flex-1\"\r\n                                >\r\n                                    {t('privacy_cancel')}\r\n                                </Button>\r\n                                <Button\r\n                                    variant=\"primary\"\r\n                                    size=\"small\"\r\n                                    onClick={handleDeleteAccount}\r\n                                    disabled={deleting}\r\n                                    className=\"flex-1 bg-red-600 hover:bg-red-700\"\r\n                                >\r\n                                    {deleting ? t('privacy_deleting') : t('privacy_confirm_delete')}\r\n                                </Button>\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n\r\n                    {/* Info */}\r\n                    <p className=\"text-xs text-stone-400 text-center pt-2 pb-6\">\r\n                        {t('privacy_info_storage')}\r\n                    </p>\r\n\r\n                    <Button variant=\"secondary\" className=\"w-full\" onClick={() => setShowPrivacy(false)}>\r\n                        {t('back')}\r\n                    </Button>\r\n                </div>\r\n            </Modal>\r\n        );\r\n    }\r\n\r\nreturn (\r\n    <Modal isOpen={true} onClose={onClose} title={t('settings')}>\r\n        <div className=\"space-y-6\">\r\n\r\n            {/* General Section */}\r\n            <section>\r\n                <h3 className=\"text-xs font-bold text-stone-500 uppercase tracking-wider mb-3\">{t('general')}</h3>\r\n\r\n                {/* Theme Selection */}\r\n                <div className=\"space-y-2 mb-4\">\r\n                    <label className=\"text-sm font-medium text-stone-700\">{t('theme')}</label>\r\n                    <div className=\"grid grid-cols-3 gap-2\">\r\n                        {themes.map((theme) => (\r\n                            <button\r\n                                key={theme.id}\r\n                                onClick={() => setMode(theme.id as 'auto' | 'light' | 'dark')}\r\n                                className={`p-3 rounded-xl border-2 transition-all flex flex-col items-center gap-1 ${mode === theme.id\r\n                                    ? 'border-teal-500 bg-teal-50'\r\n                                    : 'border-stone-200 hover:border-teal-300'\r\n                                    }`}\r\n                            >\r\n                                <theme.icon className={`w-5 h-5 ${mode === theme.id ? 'text-teal-600' : 'text-stone-500'}`} />\r\n                                <span className={`text-xs font-medium ${mode === theme.id ? 'text-teal-700' : 'text-stone-600'}`}>\r\n                                    {theme.label.split(' ')[0]}\r\n                                </span>\r\n                            </button>\r\n                        ))}\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Language Selection */}\r\n                <div className=\"space-y-2\">\r\n                    <label className=\"text-sm font-medium text-stone-700 flex items-center gap-2\">\r\n                        <Globe className=\"w-4 h-4\" />\r\n                        {t('language_selection')}\r\n                    </label>\r\n                    <div className=\"grid grid-cols-3 gap-2\">\r\n                        {languages.map((lang) => (\r\n                            <button\r\n                                key={lang.code}\r\n                                onClick={() => i18n.changeLanguage(lang.code)}\r\n                                className={`p-3 rounded-xl border-2 transition-all flex flex-col items-center gap-1 ${i18n.language === lang.code\r\n                                    ? 'border-teal-500 bg-teal-50'\r\n                                    : 'border-stone-200 hover:border-teal-300'\r\n                                    }`}\r\n                            >\r\n                                <span className=\"text-xl\">{lang.flag}</span>\r\n                                <span className={`text-xs font-medium ${i18n.language === lang.code ? 'text-teal-700' : 'text-stone-600'}`}>\r\n                                    {lang.label}\r\n                                </span>\r\n                            </button>\r\n                        ))}\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Onboarding Button */}\r\n                <div className=\"pt-4\">\r\n                    <button\r\n                        onClick={onStartOnboarding}\r\n                        className=\"w-full flex items-center justify-between p-4 bg-teal-50 border-2 border-teal-100 rounded-xl hover:bg-teal-100 hover:border-teal-200 transition-colors group\"\r\n                    >\r\n                        <div className=\"flex items-center gap-3\">\r\n                            <div className=\"p-2 bg-white rounded-full text-teal-600 shadow-sm group-hover:scale-110 transition-transform\">\r\n                                <BookOpen className=\"w-5 h-5\" />\r\n                            </div>\r\n                            <div className=\"text-left\">\r\n                                <h4 className=\"font-bold text-teal-900\">{t('app_guide_button', 'App Guide')}</h4>\r\n                                <p className=\"text-xs text-teal-700\">{t('app_guide_desc', 'Se hvordan appen virker')}</p>\r\n                            </div>\r\n                        </div>\r\n                        <ChevronRight className=\"w-5 h-5 text-teal-400 group-hover:text-teal-600 group-hover:translate-x-1 transition-all\" />\r\n                    </button>\r\n                </div>\r\n            </section>\r\n\r\n            {/* Privacy & Data Section */}\r\n            <section>\r\n                <h3 className=\"text-xs font-bold text-stone-500 uppercase tracking-wider mb-3\">{t('privacy_data')}</h3>\r\n                <button\r\n                    onClick={() => setShowPrivacy(true)}\r\n                    className=\"w-full flex items-center justify-between p-4 bg-stone-50 rounded-xl hover:bg-stone-100 transition-colors\"\r\n                >\r\n                    <div className=\"flex items-center gap-3\">\r\n                        <Shield className=\"w-5 h-5 text-teal-600\" />\r\n                        <span className=\"font-medium text-stone-800\">{t('privacy_title')}</span>\r\n                    </div>\r\n                    <ChevronRight className=\"w-5 h-5 text-stone-400\" />\r\n                </button>\r\n            </section>\r\n\r\n            {/* Sign Out */}\r\n            <div className=\"border-t border-stone-100 pt-4\">\r\n                <button\r\n                    onClick={onSignOut}\r\n                    className=\"w-full flex items-center justify-center gap-2 p-4 text-red-600 hover:bg-red-50 rounded-xl transition-colors font-semibold\"\r\n                >\r\n                    <LogOut className=\"w-5 h-5\" />\r\n                    {t('sign_out')}\r\n                </button>\r\n                <div className=\"text-center mt-2\">\r\n                    <p className=\"text-[10px] text-stone-300\">Version 1.0.3  Build 2024</p>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </Modal>\r\n);\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\components\\ShareModal.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\components\\TabNavigation.tsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":2,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":5,"column":14,"nodeType":"Identifier","messageId":"namedExport","endLine":5,"endColumn":18}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\r\nimport { Calendar, Heart } from 'lucide-react';\r\n\r\n// Tab definitions for SeniorView navigation\r\nexport const TABS = [\r\n    { id: 'daily', label: 'Min dag', icon: Calendar, emoji: '游늶' },\r\n    { id: 'family', label: 'Familie', icon: Heart, emoji: '游눞' },\r\n];\r\n\r\nexport interface TabNavigationProps {\r\n    activeTab: string;\r\n    onTabChange: (tabId: string) => void;\r\n}\r\n\r\nexport const TabNavigation: React.FC<TabNavigationProps> = ({ activeTab, onTabChange }) => {\r\n    return (\r\n        <div className=\"flex gap-2 p-2 bg-stone-100 rounded-2xl\">\r\n            {TABS.map(tab => {\r\n                const isActive = activeTab === tab.id;\r\n                return (\r\n                    <button\r\n                        key={tab.id}\r\n                        onClick={() => onTabChange(tab.id)}\r\n                        className={`\r\n                            flex-1 flex items-center justify-center gap-2 py-3 px-4 rounded-xl\r\n                            font-semibold text-lg transition-all duration-200\r\n                            focus:outline-none focus:ring-2 focus:ring-teal-400 focus:ring-offset-2\r\n                            ${isActive\r\n                                ? 'bg-white text-teal-600 shadow-md'\r\n                                : 'text-stone-500 hover:bg-stone-200'\r\n                            }\r\n                        `}\r\n                        aria-label={tab.label}\r\n                        aria-selected={isActive}\r\n                        role=\"tab\"\r\n                    >\r\n                        <span className=\"text-xl\">{tab.emoji}</span>\r\n                        <span>{tab.label}</span>\r\n                    </button>\r\n                );\r\n            })}\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default TabNavigation;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\components\\UpdateToast.tsx","messages":[{"ruleId":"@typescript-eslint/ban-ts-comment","severity":2,"message":"Use \"@ts-expect-error\" instead of \"@ts-ignore\", as \"@ts-ignore\" will do nothing if the following line is error-free.","line":10,"column":1,"nodeType":"Line","messageId":"tsIgnoreInsteadOfExpectError","endLine":10,"endColumn":52,"suggestions":[{"messageId":"replaceTsIgnoreWithTsExpectError","fix":{"range":[198,249],"text":"// @ts-expect-error - Virtual module from vite-plugin-pwa"},"desc":"Replace \"@ts-ignore\" with \"@ts-expect-error\"."}]},{"ruleId":"@typescript-eslint/no-unused-expressions","severity":2,"message":"Expected an assignment or function call and instead saw an expression.","line":22,"column":13,"nodeType":"ExpressionStatement","messageId":"unusedExpression","endLine":24,"endColumn":32}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// @ts-check\r\n/**\r\n * PWA Update Toast\r\n * \r\n * Shows a notification when a new app version is available.\r\n * Uses vite-plugin-pwa's service worker registration.\r\n */\r\n\r\nimport React from 'react';\r\n// @ts-ignore - Virtual module from vite-plugin-pwa\r\nimport { useRegisterSW } from 'virtual:pwa-register/react';\r\nimport { RefreshCw, X } from 'lucide-react';\r\n\r\nexport const UpdateToast: React.FC = () => {\r\n    const {\r\n        needRefresh: [needRefresh, setNeedRefresh],\r\n        updateServiceWorker\r\n    } = useRegisterSW({\r\n        /** @param {any} r */\r\n        onRegistered(r: ServiceWorkerRegistration | undefined) {\r\n            // Check for updates every hour\r\n            r && setInterval(() => {\r\n                r.update();\r\n            }, 60 * 60 * 1000);\r\n        },\r\n        /** @param {unknown} error */\r\n        onRegisterError(error: unknown) {\r\n            console.error('SW registration error:', error);\r\n        }\r\n    });\r\n\r\n    const close = () => {\r\n        setNeedRefresh(false);\r\n    };\r\n\r\n    if (!needRefresh) return null;\r\n\r\n    return (\r\n        <div className=\"fixed bottom-20 inset-x-4 z-50 animate-slide-up\">\r\n            <div className=\"bg-teal-600 text-white rounded-2xl shadow-xl p-4 flex items-center gap-3\">\r\n                <div className=\"w-10 h-10 bg-teal-500 rounded-full flex items-center justify-center shrink-0\">\r\n                    <RefreshCw className=\"w-5 h-5\" />\r\n                </div>\r\n                <div className=\"flex-1 min-w-0\">\r\n                    <p className=\"font-bold\">Ny opdatering klar</p>\r\n                    <p className=\"text-teal-100 text-sm\">Tryk for at opdatere appen</p>\r\n                </div>\r\n                <button\r\n                    onClick={() => updateServiceWorker(true)}\r\n                    className=\"bg-white text-teal-600 px-4 py-2 rounded-xl font-bold text-sm hover:bg-teal-50 transition-colors shrink-0\"\r\n                >\r\n                    Opdater\r\n                </button>\r\n                <button\r\n                    onClick={close}\r\n                    className=\"p-2 text-teal-200 hover:text-white\"\r\n                    aria-label=\"Luk\"\r\n                >\r\n                    <X className=\"w-5 h-5\" />\r\n                </button>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default UpdateToast;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\components\\animations\\index.tsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":2,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":18,"column":14,"nodeType":"Identifier","messageId":"namedExport","endLine":18,"endColumn":37},{"ruleId":"react-refresh/only-export-components","severity":2,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":27,"column":14,"nodeType":"Identifier","messageId":"namedExport","endLine":27,"endColumn":35},{"ruleId":"react-refresh/only-export-components","severity":2,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":36,"column":14,"nodeType":"Identifier","messageId":"namedExport","endLine":36,"endColumn":28},{"ruleId":"react-refresh/only-export-components","severity":2,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":45,"column":14,"nodeType":"Identifier","messageId":"namedExport","endLine":45,"endColumn":29},{"ruleId":"react-refresh/only-export-components","severity":2,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":54,"column":14,"nodeType":"Identifier","messageId":"namedExport","endLine":54,"endColumn":40},{"ruleId":"react-refresh/only-export-components","severity":2,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":62,"column":14,"nodeType":"Identifier","messageId":"namedExport","endLine":62,"endColumn":35}],"suppressedMessages":[],"errorCount":6,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * Animation Components\r\n * \r\n * Reusable framer-motion wrappers for micro-animations.\r\n * Provides consistent animations across the app.\r\n */\r\n\r\nimport React, { ReactNode } from 'react';\r\nimport { motion, AnimatePresence, Variants } from 'framer-motion';\r\n\r\n// ============================================================================\r\n// ANIMATION VARIANTS\r\n// ============================================================================\r\n\r\n/**\r\n * Slide out to the right when completed\r\n */\r\nexport const slideOutRight: Variants = {\r\n    initial: { opacity: 1, x: 0 },\r\n    animate: { opacity: 1, x: 0 },\r\n    exit: { opacity: 0, x: 100, transition: { duration: 0.3 } }\r\n};\r\n\r\n/**\r\n * Fade in from bottom (for modals)\r\n */\r\nexport const slideUpFade: Variants = {\r\n    initial: { opacity: 0, y: 50 },\r\n    animate: { opacity: 1, y: 0, transition: { duration: 0.3, ease: 'easeOut' } },\r\n    exit: { opacity: 0, y: 50, transition: { duration: 0.2 } }\r\n};\r\n\r\n/**\r\n * Simple fade\r\n */\r\nexport const fade: Variants = {\r\n    initial: { opacity: 0 },\r\n    animate: { opacity: 1, transition: { duration: 0.2 } },\r\n    exit: { opacity: 0, transition: { duration: 0.15 } }\r\n};\r\n\r\n/**\r\n * Scale in with spring (for success states)\r\n */\r\nexport const popIn: Variants = {\r\n    initial: { opacity: 0, scale: 0.8 },\r\n    animate: { opacity: 1, scale: 1, transition: { type: 'spring', stiffness: 300, damping: 20 } },\r\n    exit: { opacity: 0, scale: 0.8, transition: { duration: 0.15 } }\r\n};\r\n\r\n/**\r\n * Stagger children (for lists)\r\n */\r\nexport const staggerContainer: Variants = {\r\n    animate: {\r\n        transition: {\r\n            staggerChildren: 0.05\r\n        }\r\n    }\r\n};\r\n\r\nexport const staggerItem: Variants = {\r\n    initial: { opacity: 0, y: 10 },\r\n    animate: { opacity: 1, y: 0 }\r\n};\r\n\r\n// ============================================================================\r\n// WRAPPER COMPONENTS\r\n// ============================================================================\r\n\r\ninterface AnimatedListProps {\r\n    children: ReactNode;\r\n    className?: string;\r\n}\r\n\r\n/**\r\n * Animated list container - staggers child animations\r\n */\r\nexport const AnimatedList: React.FC<AnimatedListProps> = ({ children, className = '' }) => (\r\n    <motion.div\r\n        className={className}\r\n        variants={staggerContainer}\r\n        initial=\"initial\"\r\n        animate=\"animate\"\r\n    >\r\n        {children}\r\n    </motion.div>\r\n);\r\n\r\ninterface AnimatedItemProps {\r\n    children: ReactNode;\r\n    className?: string;\r\n    layoutId?: string;\r\n}\r\n\r\n/**\r\n * Animated list item - for items within AnimatedList\r\n */\r\nexport const AnimatedItem: React.FC<AnimatedItemProps> = ({ children, className = '', layoutId }) => (\r\n    <motion.div\r\n        className={className}\r\n        variants={staggerItem}\r\n        layout\r\n        layoutId={layoutId}\r\n    >\r\n        {children}\r\n    </motion.div>\r\n);\r\n\r\ninterface AnimatedTaskCardProps {\r\n    children: ReactNode;\r\n    taskId: string;\r\n    isCompleted: boolean;\r\n    onAnimationComplete?: () => void;\r\n    className?: string;\r\n}\r\n\r\n/**\r\n * Task card with completion animation\r\n * Slides out to the right when completed\r\n */\r\nexport const AnimatedTaskCard: React.FC<AnimatedTaskCardProps> = ({\r\n    children,\r\n    taskId,\r\n    isCompleted,\r\n    onAnimationComplete,\r\n    className = ''\r\n}) => (\r\n    <motion.div\r\n        key={taskId}\r\n        layout\r\n        initial={{ opacity: 1, x: 0, height: 'auto' }}\r\n        animate={{\r\n            opacity: isCompleted ? 0.6 : 1,\r\n            x: 0,\r\n            scale: isCompleted ? 0.98 : 1\r\n        }}\r\n        exit={{\r\n            opacity: 0,\r\n            x: 100,\r\n            height: 0,\r\n            marginBottom: 0,\r\n            transition: { duration: 0.3, ease: 'easeInOut' }\r\n        }}\r\n        transition={{ duration: 0.2 }}\r\n        onAnimationComplete={onAnimationComplete}\r\n        className={className}\r\n    >\r\n        {children}\r\n    </motion.div>\r\n);\r\n\r\ninterface AnimatedModalProps {\r\n    isOpen: boolean;\r\n    onClose: () => void;\r\n    children: ReactNode;\r\n    className?: string;\r\n}\r\n\r\n/**\r\n * Modal wrapper with slide-up animation\r\n */\r\nexport const AnimatedModal: React.FC<AnimatedModalProps> = ({ isOpen, onClose, children, className = '' }) => (\r\n    <AnimatePresence>\r\n        {isOpen && (\r\n            <>\r\n                {/* Backdrop */}\r\n                <motion.div\r\n                    className=\"fixed inset-0 bg-black/40 z-40\"\r\n                    initial={{ opacity: 0 }}\r\n                    animate={{ opacity: 1 }}\r\n                    exit={{ opacity: 0 }}\r\n                    onClick={onClose}\r\n                />\r\n                {/* Modal content */}\r\n                <motion.div\r\n                    className={`fixed inset-x-4 bottom-4 z-50 bg-white rounded-3xl shadow-xl max-h-[85vh] overflow-auto ${className}`}\r\n                    variants={slideUpFade}\r\n                    initial=\"initial\"\r\n                    animate=\"animate\"\r\n                    exit=\"exit\"\r\n                >\r\n                    {children}\r\n                </motion.div>\r\n            </>\r\n        )}\r\n    </AnimatePresence>\r\n);\r\n\r\ninterface AnimatedCheckmarkProps {\r\n    show: boolean;\r\n}\r\n\r\n/**\r\n * Success checkmark animation\r\n */\r\nexport const AnimatedCheckmark: React.FC<AnimatedCheckmarkProps> = ({ show }) => (\r\n    <AnimatePresence>\r\n        {show && (\r\n            <motion.div\r\n                variants={popIn}\r\n                initial=\"initial\"\r\n                animate=\"animate\"\r\n                exit=\"exit\"\r\n            >\r\n                九늎r\n            </motion.div>\r\n        )}\r\n    </AnimatePresence>\r\n);\r\n\r\nexport { AnimatePresence } from 'framer-motion';\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\components\\layouts\\RelativeViewLayout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\components\\relative\\modals\\RelativeModals.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\components\\senior\\FamilyTab.tsx","messages":[{"ruleId":"no-undef","severity":2,"message":"'React' is not defined.","line":10,"column":25,"nodeType":"Identifier","messageId":"undef","endLine":10,"endColumn":30},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":34,"column":52,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":34,"endColumn":55,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1166,1169],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1166,1169],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":35,"column":56,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":35,"endColumn":59,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1261,1264],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1261,1264],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":36,"column":56,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":36,"endColumn":59,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1356,1359],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1356,1359],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":37,"column":60,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":37,"endColumn":63,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1457,1460],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1457,1460],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":5,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useCareCircleContext } from '../../contexts/CareCircleContext';\r\nimport { CoffeeToggle } from '../../features/coffee';\r\nimport { ThinkingOfYouButton } from '../../features/thinkingOfYou';\r\nimport { FamilyPresence, StatusList } from '../../features/familyPresence';\r\nimport { MemoryTrigger } from '../../features/weeklyQuestion';\r\nimport { HelpExchange } from '../../features/helpExchange';\r\nimport { FEATURES } from '../../config/features';\r\nimport { useHelpExchange } from '../../features/helpExchange';\r\n\r\nexport const FamilyTab: React.FC = () => {\r\n\r\n    const {\r\n        userName,\r\n        careCircleId,\r\n        currentUserId,\r\n        memberStatuses,\r\n        members,\r\n        relativeStatuses,\r\n\r\n        sendPing\r\n    } = useCareCircleContext();\r\n\r\n    // Fetch HelpExchange data directly in the tab\r\n    const {\r\n        helpOffers: allOffersFetched,\r\n        helpRequests: allRequestsFetched,\r\n        addOffer,\r\n        addRequest,\r\n        removeOffer,\r\n        removeRequest\r\n    } = useHelpExchange(careCircleId, currentUserId, 'senior', userName);\r\n\r\n    // Filter offers/requests by role\r\n    const helpOffers = allOffersFetched.filter((o: any) => o.createdByRole === 'senior');\r\n    const helpRequests = allRequestsFetched.filter((r: any) => r.createdByRole === 'senior');\r\n    const relativeOffers = allOffersFetched.filter((o: any) => o.createdByRole === 'relative');\r\n    const relativeRequests = allRequestsFetched.filter((r: any) => r.createdByRole === 'relative');\r\n\r\n    return (\r\n        <div className=\"tab-content animate-fade-in space-y-4\">\r\n            {/* Spontan Kaffe Signal */}\r\n            <CoffeeToggle />\r\n\r\n            {/* Thinking of You */}\r\n            {FEATURES.thinkingOfYou && (\r\n                <ThinkingOfYouButton\r\n                    onSendPing={() => sendPing('relative')}\r\n                    fromName={userName}\r\n                />\r\n            )}\r\n\r\n            {/* Family Presence */}\r\n            {memberStatuses.length > 0 && (\r\n                <FamilyPresence\r\n                    memberStatuses={memberStatuses}\r\n                    currentUserId={currentUserId || ''}\r\n                    seniorName={userName}\r\n                />\r\n            )}\r\n\r\n            {/* Legacy Family Status List */}\r\n            {FEATURES.familyStatusCard && memberStatuses.length === 0 && (\r\n                <StatusList\r\n                    members={members}\r\n                    relativeStatuses={relativeStatuses}\r\n                    lastUpdated={null} // statusLastUpdated was passed before, but it was just 'null' in AppCore call mostly\r\n                />\r\n            )}\r\n\r\n            {/* Memory Trigger */}\r\n            {FEATURES.memoryTriggers && <MemoryTrigger />}\r\n\r\n            {/* Help Exchange */}\r\n            {FEATURES.helpExchange && (\r\n                <HelpExchange\r\n                    onOffer={addOffer}\r\n                    onRequest={addRequest}\r\n                    onRemoveOffer={removeOffer}\r\n                    onRemoveRequest={removeRequest}\r\n                    activeOffers={helpOffers}\r\n                    activeRequests={helpRequests}\r\n                    relativeOffers={relativeOffers}\r\n                    relativeRequests={relativeRequests}\r\n                    seniorName={userName}\r\n                />\r\n            )}\r\n        </div>\r\n    );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\components\\senior\\modals\\SeniorModals.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":113,"column":56,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":113,"endColumn":59,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4367,4370],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4367,4370],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\r\nimport { Phone } from 'lucide-react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { Modal } from '../../ui/Modal';\r\nimport { Button } from '../../ui/Button';\r\nimport { BodyPainSelector } from '../../../features/symptoms';\r\nimport { SYMPTOMS_LIST } from '../../../data/constants';\r\nimport { WeeklyQuestionModal } from '../../../features/weeklyQuestion';\r\nimport { MatchCelebration } from '../../../features/helpExchange';\r\nimport { ActiveMatch } from '../../../features/helpExchange/useHelpExchangeMatch';\r\nimport { useCareCircleContext } from '../../../contexts/CareCircleContext';\r\n\r\ninterface SeniorModalsProps {\r\n    showCallModal: boolean;\r\n    setShowCallModal: (show: boolean) => void;\r\n    showSymptomModal: boolean;\r\n    setShowSymptomModal: (show: boolean) => void;\r\n    showWeeklyModal: boolean;\r\n    setShowWeeklyModal: (show: boolean) => void;\r\n    showAddTaskModal: boolean;\r\n    setShowAddTaskModal: (show: boolean) => void;\r\n    activeMatch: ActiveMatch | null;\r\n    setActiveMatch: (match: ActiveMatch | null) => void;\r\n}\r\n\r\nexport const SeniorModals: React.FC<SeniorModalsProps> = ({\r\n    showCallModal,\r\n    setShowCallModal,\r\n    showSymptomModal,\r\n    setShowSymptomModal,\r\n    showWeeklyModal,\r\n    setShowWeeklyModal,\r\n    showAddTaskModal,\r\n    setShowAddTaskModal,\r\n    activeMatch,\r\n    setActiveMatch\r\n}) => {\r\n    const { t } = useTranslation();\r\n    const {\r\n        userName,\r\n        relativeName,\r\n        currentUserId,\r\n        addSymptom,\r\n        addTask,\r\n        weeklyAnswers,\r\n        addWeeklyAnswer,\r\n        toggleLike,\r\n        addReply,\r\n        members\r\n    } = useCareCircleContext();\r\n\r\n    // Symptom flow state\r\n    const [selectedSymptom, setSelectedSymptom] = useState<typeof SYMPTOMS_LIST[number] | null>(null);\r\n    const [showBodySelector, setShowBodySelector] = useState(false);\r\n\r\n    // Add Task state\r\n    const [newTaskTitle, setNewTaskTitle] = useState('');\r\n    const [newTaskPeriod, setNewTaskPeriod] = useState('morgen');\r\n    const [newTaskRecurring, setNewTaskRecurring] = useState(false);\r\n\r\n    const handleAddSymptom = (symptom: typeof SYMPTOMS_LIST[number]) => {\r\n        addSymptom(symptom);\r\n        setShowSymptomModal(false);\r\n        setSelectedSymptom(null);\r\n        setShowBodySelector(false);\r\n    };\r\n\r\n    const handleAddTask = () => {\r\n        if (newTaskTitle.trim()) {\r\n            addTask({\r\n                title: newTaskTitle.trim(),\r\n                period: newTaskPeriod,\r\n                type: 'activity',\r\n                recurring: newTaskRecurring\r\n            });\r\n            setNewTaskTitle('');\r\n            setNewTaskPeriod('morgen');\r\n            setNewTaskRecurring(false);\r\n            setShowAddTaskModal(false);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <>\r\n            {/* Call Modal */}\r\n            {showCallModal && (\r\n                <div className=\"absolute inset-0 bg-black/50 flex items-center justify-center p-4 z-[100]\">\r\n                    <div className=\"bg-white rounded-3xl p-8 w-full max-w-sm text-center animate-slide-up\">\r\n                        <div className=\"w-20 h-20 bg-rose-100 rounded-full flex items-center justify-center mx-auto mb-4\">\r\n                            <Phone className=\"w-10 h-10 text-rose-600\" />\r\n                        </div>\r\n                        <h3 className=\"text-2xl font-bold theme-text mb-2\">{t('calling')}</h3>\r\n                        <p className=\"theme-text-muted mb-8\">{t('calling_to', { name: relativeName })}</p>\r\n                        <Button variant=\"danger\" onClick={() => setShowCallModal(false)}>{t('end_call')}</Button>\r\n                    </div>\r\n                </div>\r\n            )}\r\n\r\n            {/* Symptom Modal */}\r\n            <Modal\r\n                isOpen={showSymptomModal}\r\n                onClose={() => {\r\n                    setShowSymptomModal(false);\r\n                    setSelectedSymptom(null);\r\n                    setShowBodySelector(false);\r\n                }}\r\n                title={showBodySelector ? t('where_does_it_hurt') : t('how_do_you_feel')}\r\n            >\r\n                {showBodySelector ? (\r\n                    <BodyPainSelector\r\n                        onSelectLocation={(bodyLocation) => {\r\n                            handleAddSymptom({\r\n                                ...(selectedSymptom as any),\r\n                                bodyLocation\r\n                            });\r\n                        }}\r\n                        onBack={() => {\r\n                            setShowBodySelector(false);\r\n                            setSelectedSymptom(null);\r\n                        }}\r\n                    />\r\n                ) : (\r\n                    <div className=\"grid grid-cols-2 gap-4\">\r\n                        {SYMPTOMS_LIST.map(sym => (\r\n                            <button\r\n                                key={sym.id}\r\n                                onClick={() => {\r\n                                    if (sym.id === 'pain') {\r\n                                        setSelectedSymptom(sym);\r\n                                        setShowBodySelector(true);\r\n                                    } else {\r\n                                        handleAddSymptom(sym);\r\n                                    }\r\n                                }}\r\n                                className={`\r\n                                    flex flex-col items-center justify-center gap-2 p-6 rounded-2xl\r\n                                    transition-transform active:scale-95 border-2 border-transparent hover:border-stone-300\r\n                                    ${sym.color}\r\n                                `}\r\n                            >\r\n                                <sym.icon className=\"w-10 h-10\" />\r\n                                <span className=\"font-bold\">{sym.label}</span>\r\n                            </button>\r\n                        ))}\r\n                    </div>\r\n                )}\r\n            </Modal>\r\n\r\n            {/* Weekly Question Modal */}\r\n            <WeeklyQuestionModal\r\n                isOpen={showWeeklyModal}\r\n                onClose={() => setShowWeeklyModal(false)}\r\n                answers={weeklyAnswers}\r\n                onAnswer={(answerObj: Record<string, unknown>) => addWeeklyAnswer(answerObj.answer as string)}\r\n                userName={userName}\r\n                currentUserId={currentUserId || undefined}\r\n                onToggleLike={toggleLike}\r\n                onReply={addReply}\r\n                members={members}\r\n            />\r\n\r\n            {/* Add Task Modal */}\r\n            <Modal isOpen={showAddTaskModal} onClose={() => setShowAddTaskModal(false)} title={t('add_own_task')}>\r\n                <div className=\"space-y-4\">\r\n                    <div>\r\n                        <label className=\"block text-sm font-medium text-slate-700 mb-1\">{t('what_needs_done')}</label>\r\n                        <input\r\n                            type=\"text\"\r\n                            value={newTaskTitle}\r\n                            onChange={(e) => setNewTaskTitle(e.target.value)}\r\n                            placeholder={t('example_call_doctor')}\r\n                            className=\"w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:border-teal-500 focus:outline-none text-lg\"\r\n                            autoFocus\r\n                        />\r\n                    </div>\r\n\r\n                    <div>\r\n                        <label className=\"block text-sm font-medium text-slate-700 mb-2\">{t('when_question')}</label>\r\n                        <div className=\"grid grid-cols-2 gap-2\">\r\n                            {[\r\n                                { key: 'morgen', labelKey: 'time_period_morning', icon: '驕勇' },\r\n                                { key: 'frokost', labelKey: 'time_period_lunch', icon: '游꽇勇' },\r\n                                { key: 'eftermiddag', labelKey: 'time_period_afternoon', icon: '游꺇勇' },\r\n                                { key: 'aften', labelKey: 'time_period_evening', icon: '游깿' }\r\n                            ].map(period => (\r\n                                <button\r\n                                    key={period.key}\r\n                                    onClick={() => setNewTaskPeriod(period.key)}\r\n                                    className={`p-3 rounded-xl border-2 transition-all text-left ${newTaskPeriod === period.key\r\n                                        ? 'border-teal-500 bg-teal-50'\r\n                                        : 'border-slate-200 hover:border-slate-300'\r\n                                        }`}\r\n                                >\r\n                                    <div className=\"flex items-center gap-2\">\r\n                                        <span className=\"text-lg\">{period.icon}</span>\r\n                                        <span className={`font-medium ${newTaskPeriod === period.key ? 'text-teal-700' : 'text-slate-700'}`}>\r\n                                            {t(period.labelKey)}\r\n                                        </span>\r\n                                    </div>\r\n                                </button>\r\n                            ))}\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div className=\"flex items-center gap-3 p-4 bg-slate-50 rounded-xl border-2 border-slate-100\">\r\n                        <input\r\n                            type=\"checkbox\"\r\n                            toggle-id=\"recurring\"\r\n                            checked={newTaskRecurring}\r\n                            onChange={(e) => setNewTaskRecurring(e.target.checked)}\r\n                            className=\"w-6 h-6 rounded-md border-slate-300 text-teal-600 focus:ring-teal-500\"\r\n                        />\r\n                        <label className=\"flex-1 font-medium text-slate-700 cursor-pointer\" onClick={() => setNewTaskRecurring(!newTaskRecurring)}>\r\n                            {t('make_daily')}\r\n                        </label>\r\n                    </div>\r\n\r\n                    <Button\r\n                        onClick={handleAddTask}\r\n                        className=\"w-full\"\r\n                        disabled={!newTaskTitle.trim()}\r\n                    >\r\n                        {t('add_task_button')}\r\n                    </Button>\r\n                </div>\r\n            </Modal>\r\n\r\n            {/* Match Celebration Modal */}\r\n            {activeMatch && (\r\n                <MatchCelebration\r\n                    match={activeMatch}\r\n                    seniorName={userName}\r\n                    onDismiss={() => setActiveMatch(null)}\r\n                    onAction={(action) => {\r\n                        // Action handling logic moved from SeniorView\r\n                        let taskTitle = '';\r\n                        switch (action) {\r\n                            case 'call': taskTitle = t('match_task_call', { name: relativeName }); break;\r\n                            case 'plan-visit': taskTitle = t('match_task_visit', { name: relativeName }); break;\r\n                            case 'plan-meal': taskTitle = t('match_task_meal', { name: relativeName }); break;\r\n                            default: taskTitle = activeMatch.celebration?.title || t('match_task_default', { name: relativeName });\r\n                        }\r\n                        addTask({\r\n                            title: taskTitle,\r\n                            period: 'eftermiddag',\r\n                            type: 'appointment'\r\n                        });\r\n                        setActiveMatch(null);\r\n                    }}\r\n                />\r\n            )}\r\n        </>\r\n    );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\components\\shared\\AmbientTab.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\components\\shared\\HealthTab.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":21,"column":52,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":21,"endColumn":55,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[873,876],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[873,876],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":22,"column":39,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":22,"endColumn":42,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[928,931],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[928,931],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/purity","severity":2,"message":"Error: Cannot call impure function during render\n\n`Date.now` is an impure function. Calling an impure function can produce unstable results that update unpredictably when the component happens to re-render. (https://react.dev/reference/rules/components-and-hooks-must-be-pure#components-and-hooks-must-be-idempotent).\n\nC:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\components\\shared\\HealthTab.tsx:46:41\n  44 |         symptomLogs.forEach(log => {\n  45 |             const date = log.loggedAt?.toDate ? log.loggedAt.toDate() : new Date(log.loggedAt);\n> 46 |             const daysAgo = Math.floor((Date.now() - date.getTime()) / (1000 * 60 * 60 * 24));\n     |                                         ^^^^^^^^^^ Cannot call impure function\n  47 |             if (daysAgo >= 0 && daysAgo < 14) {\n  48 |                 days[13 - daysAgo].count++;\n  49 |             }","line":46,"column":41,"nodeType":null,"endLine":46,"endColumn":51},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":57,"column":54,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":57,"endColumn":57,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2331,2334],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2331,2334],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":177,"column":57,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":177,"endColumn":60,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8705,8708],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8705,8708],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":5,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useMemo } from 'react';\r\nimport { ChevronDown, ChevronUp, AlertCircle } from 'lucide-react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { useCareCircleContext } from '../../contexts/CareCircleContext';\r\nimport { SYMPTOMS_LIST } from '../../data/constants';\r\n\r\nexport const HealthTab: React.FC = () => {\r\n    const { t } = useTranslation();\r\n    const {\r\n        symptoms: symptomLogs = []\r\n    } = useCareCircleContext();\r\n\r\n    const [expandedDates, setExpandedDates] = useState<Record<string, boolean>>(() => {\r\n        const today = new Date().toLocaleDateString('da-DK', { weekday: 'short', day: 'numeric', month: 'short' });\r\n        return { [today]: true };\r\n    });\r\n    const [filterDate, setFilterDate] = useState<string | null>(null);\r\n\r\n\r\n    // Group symptoms by date\r\n    const groupedSymptoms = useMemo<Record<string, any[]>>(() => {\r\n        const grouped: Record<string, any[]> = {};\r\n        symptomLogs.forEach(log => {\r\n            const date = log.loggedAt?.toDate ? log.loggedAt.toDate() : new Date(log.loggedAt);\r\n            const dateKey = date.toLocaleDateString('da-DK', { weekday: 'short', day: 'numeric', month: 'short' });\r\n            if (!grouped[dateKey]) grouped[dateKey] = [];\r\n            grouped[dateKey].push({ ...log, dateObj: date });\r\n        });\r\n        return grouped;\r\n    }, [symptomLogs]);\r\n\r\n    // Chart data - 14 days\r\n    const chartData = useMemo(() => {\r\n        const days = Array(14).fill(null).map((_, i) => {\r\n            const d = new Date();\r\n            d.setDate(d.getDate() - (13 - i));\r\n            return {\r\n                date: d,\r\n                dateKey: d.toLocaleDateString('da-DK', { weekday: 'short', day: 'numeric', month: 'short' }),\r\n                count: 0\r\n            };\r\n        });\r\n\r\n        symptomLogs.forEach(log => {\r\n            const date = log.loggedAt?.toDate ? log.loggedAt.toDate() : new Date(log.loggedAt);\r\n            const daysAgo = Math.floor((Date.now() - date.getTime()) / (1000 * 60 * 60 * 24));\r\n            if (daysAgo >= 0 && daysAgo < 14) {\r\n                days[13 - daysAgo].count++;\r\n            }\r\n        });\r\n\r\n        return days;\r\n    }, [symptomLogs]);\r\n\r\n    const maxCount = Math.max(...chartData.map(d => d.count), 1);\r\n\r\n    const displayedSymptoms = useMemo<Record<string, any[]>>(() => {\r\n        if (!filterDate) return groupedSymptoms;\r\n        return { [filterDate]: groupedSymptoms[filterDate] || [] };\r\n    }, [groupedSymptoms, filterDate]);\r\n\r\n    const totalSymptoms = symptomLogs.length;\r\n    const symptomCounts: Record<string, number> = {};\r\n    symptomLogs.forEach(log => {\r\n        const label = log.label || 'Unknown';\r\n        symptomCounts[label] = (symptomCounts[label] || 0) + 1;\r\n    });\r\n    const mostCommon = Object.entries(symptomCounts).sort((a, b) => b[1] - a[1])[0];\r\n\r\n    const toggleDate = (dateKey: string) => {\r\n        setExpandedDates(prev => ({\r\n            ...prev,\r\n            [dateKey]: !prev[dateKey]\r\n        }));\r\n    };\r\n\r\n    const handleChartClick = (dateKey: string) => {\r\n        if (filterDate === dateKey) {\r\n            setFilterDate(null);\r\n        } else {\r\n            setFilterDate(dateKey);\r\n            setExpandedDates(prev => ({ ...prev, [dateKey]: true }));\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"tab-content animate-fade-in p-4 space-y-6\">\r\n            <h2 className=\"text-2xl font-bold theme-text mb-2\">{t('health_title')}</h2>\r\n\r\n            {/* Summary Stats */}\r\n            {totalSymptoms > 0 && (\r\n                <div className=\"grid grid-cols-2 gap-3\">\r\n                    <div className=\"theme-card-secondary rounded-xl p-3 border border-orange-100\">\r\n                        <p className=\"text-2xl font-bold text-orange-600\">{totalSymptoms}</p>\r\n                        <p className=\"text-xs text-orange-500\">Symptomer (14 dage)</p>\r\n                    </div>\r\n                    {mostCommon && (\r\n                        <div className=\"theme-card-secondary rounded-xl p-3 border border-purple-100\">\r\n                            <p className=\"text-lg font-bold text-purple-600 truncate\">{mostCommon[0]}</p>\r\n                            <p className=\"text-xs text-purple-500\">Mest hyppige ({mostCommon[1]}x)</p>\r\n                        </div>\r\n                    )}\r\n                </div>\r\n            )}\r\n\r\n            {/* Clickable Chart */}\r\n            <div className=\"p-4 theme-card-secondary rounded-xl border border-orange-200\">\r\n                <div className=\"flex items-center justify-between mb-2\">\r\n                    <h4 className=\"font-bold theme-text\">Symptom-oversigt (14 dage)</h4>\r\n                    {filterDate && (\r\n                        <button\r\n                            onClick={() => setFilterDate(null)}\r\n                            className=\"text-xs text-orange-600 font-medium hover:underline\"\r\n                        >\r\n                            {t('view_all')}\r\n                        </button>\r\n                    )}\r\n                </div>\r\n                <p className=\"text-xs text-slate-500 mb-3\">{t('chart_filter_hint')}</p>\r\n                <div className=\"flex items-end gap-1 h-24 pb-2\">\r\n                    {chartData.map((day, i) => (\r\n                        <button\r\n                            key={i}\r\n                            onClick={() => day.count > 0 && handleChartClick(day.dateKey)}\r\n                            className={`flex-1 flex flex-col items-center gap-1 transition-all ${filterDate === day.dateKey ? 'scale-110' : ''} ${day.count > 0 ? 'cursor-pointer' : 'cursor-default'}`}\r\n                        >\r\n                            {day.count > 0 && (\r\n                                <span className={`text-[10px] font-bold ${filterDate === day.dateKey ? 'text-orange-800' : 'text-orange-600'}`}>{day.count}</span>\r\n                            )}\r\n                            <div\r\n                                className={`w-full rounded-t-sm transition-all ${day.count > 0\r\n                                    ? filterDate === day.dateKey\r\n                                        ? 'bg-orange-600'\r\n                                        : 'bg-orange-400 hover:bg-orange-500'\r\n                                    : 'bg-slate-200'\r\n                                    }`}\r\n                                style={{ height: `${Math.max((day.count / maxCount) * 60, 4)}px` }}\r\n                            />\r\n                        </button>\r\n                    ))}\r\n                </div>\r\n                <div className=\"flex justify-between text-[10px] text-stone-400 font-bold px-2\">\r\n                    <span>{t('time_days_ago_short', { count: 14 })}</span><span>{t('today')}</span>\r\n                </div>\r\n            </div>\r\n\r\n\r\n\r\n            {/* Symptom Log */}\r\n            <div>\r\n                <h4 className=\"font-bold theme-text mb-3\">\r\n                    {t('symptom_log_title')} {filterDate ? `(${filterDate})` : t('symptom_log_last_14_days')}\r\n                </h4>\r\n                {Object.keys(displayedSymptoms).length === 0 ? (\r\n                    <p className=\"text-slate-500 text-sm italic\">{t('no_symptoms_recorded')}</p>\r\n                ) : (\r\n                    <div className=\"space-y-2\">\r\n                        {Object.entries(displayedSymptoms).map(([dateStr, logs]) => (\r\n                            <div key={dateStr} className=\"border rounded-xl overflow-hidden shadow-sm\">\r\n                                <button\r\n                                    onClick={() => toggleDate(dateStr)}\r\n                                    className=\"w-full flex items-center justify-between p-3 theme-card-secondary hover:bg-slate-100 transition-colors\"\r\n                                >\r\n                                    <span className=\"font-bold theme-text\">{dateStr}</span>\r\n                                    <div className=\"flex items-center gap-2\">\r\n                                        <span className=\"text-xs text-slate-500\">{logs?.length || 0} {t('symptoms_count_label')}</span>\r\n                                        {expandedDates[dateStr] ? (\r\n                                            <ChevronUp className=\"w-4 h-4 text-slate-400\" />\r\n                                        ) : (\r\n                                            <ChevronDown className=\"w-4 h-4 text-slate-400\" />\r\n                                        )}\r\n                                    </div>\r\n                                </button>\r\n\r\n                                {expandedDates[dateStr] && logs && (\r\n                                    <ul className=\"divide-y border-t bg-white\">\r\n                                        {logs.map((log: any, i: number) => {\r\n                                            const symptomDef = SYMPTOMS_LIST.find(s => s.id === log.id) || { icon: AlertCircle, label: t('unknown') };\r\n                                            const SymptomIcon = symptomDef.icon || AlertCircle;\r\n                                            const timeStr = log.dateObj.toLocaleTimeString('da-DK', { hour: '2-digit', minute: '2-digit' });\r\n\r\n                                            return (\r\n                                                <li key={i} className=\"flex flex-col gap-1 text-sm p-3\">\r\n                                                    <div className=\"flex items-center gap-3\">\r\n                                                        <SymptomIcon className=\"w-5 h-5 text-slate-400\" />\r\n                                                        <span className=\"font-medium theme-text\">{log.label}</span>\r\n                                                        <span className=\"text-slate-400 ml-auto\">{timeStr}</span>\r\n                                                    </div>\r\n                                                    {log.bodyLocation && (\r\n                                                        <div className=\"ml-8 text-xs text-slate-500 space-y-1\">\r\n                                                            <div>游늸 {t('location_prefix')}: <span className=\"font-medium\">{log.bodyLocation.emoji} {log.bodyLocation.label}</span></div>\r\n                                                            {log.bodyLocation.severity && (\r\n                                                                <div>游늵 {t('intensity_prefix')}: <span className=\"font-medium\">{log.bodyLocation.severity.emoji} {log.bodyLocation.severity.label}</span></div>\r\n                                                            )}\r\n                                                        </div>\r\n                                                    )}\r\n                                                </li>\r\n                                            );\r\n                                        })}\r\n                                    </ul>\r\n                                )}\r\n                            </div>\r\n                        ))}\r\n                    </div>\r\n                )}\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\components\\shared\\SpilTab.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\components\\ui\\Avatar.tsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":2,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":79,"column":10,"nodeType":"Identifier","messageId":"namedExport","endLine":79,"endColumn":24}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/// <reference types=\"vite/client\" />\r\nimport React from 'react';\r\nimport { cva, type VariantProps } from 'class-variance-authority';\r\nimport { cn } from '../../lib/utils';\r\n\r\n/**\r\n * Avatar size variants using CVA\r\n */\r\nconst avatarVariants = cva(\r\n    \"rounded-full overflow-hidden bg-stone-100\",\r\n    {\r\n        variants: {\r\n            size: {\r\n                sm: \"w-8 h-8\",\r\n                md: \"w-12 h-12\",\r\n                lg: \"w-16 h-16\",\r\n                xl: \"w-24 h-24\",\r\n            },\r\n        },\r\n        defaultVariants: {\r\n            size: \"md\",\r\n        },\r\n    }\r\n);\r\n\r\ntype AvatarId = 'louise' | 'fatima' | 'brad' | 'bearded' | 'senior' | 'home' | 'work' | 'car' | 'coffee' | 'moon' | string;\r\n\r\ninterface AvatarProps extends VariantProps<typeof avatarVariants> {\r\n    id: AvatarId;\r\n    className?: string;\r\n}\r\n\r\n// Map IDs to image filenames\r\nconst IMAGE_MAP: Record<string, string> = {\r\n    'louise': 'louise.png',\r\n    'fatima': 'fatima.png',\r\n    'brad': 'brad.png',\r\n    'bearded': 'brad.png',\r\n    'senior': 'brad.png',\r\n    'home': 'home.png',\r\n    'work': 'work.png',\r\n    'car': 'car.png',\r\n    'coffee': 'coffee.png',\r\n    'moon': 'moon.png',\r\n    'juzu': 'juzu.png'\r\n};\r\n\r\n/**\r\n * Avatar Component\r\n * Renders avatars and status icons using individual image files.\r\n */\r\nexport const Avatar: React.FC<AvatarProps> = ({ id, className, size }) => {\r\n    // Fallback for unknown IDs\r\n    if (!id || !IMAGE_MAP[id]) {\r\n        return (\r\n            <div className={cn(\r\n                avatarVariants({ size }),\r\n                \"bg-stone-200 flex items-center justify-center font-bold text-stone-500 uppercase\",\r\n                className\r\n            )}>\r\n                {id ? id.charAt(0) : '?'}\r\n            </div>\r\n        );\r\n    }\r\n\r\n    const imagePath = `${import.meta.env.BASE_URL}assets/avatars/${IMAGE_MAP[id]}`;\r\n\r\n    return (\r\n        <div className={cn(avatarVariants({ size }), className)}>\r\n            <img\r\n                src={imagePath}\r\n                alt={id}\r\n                className=\"w-full h-full object-cover\"\r\n            />\r\n        </div>\r\n    );\r\n};\r\n\r\nexport { avatarVariants };\r\nexport default Avatar;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\components\\ui\\Button.tsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":2,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":71,"column":10,"nodeType":"Identifier","messageId":"namedExport","endLine":71,"endColumn":24}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { ButtonHTMLAttributes } from 'react';\r\nimport { cva, type VariantProps } from 'class-variance-authority';\r\nimport { cn } from '../../lib/utils';\r\n\r\n/**\r\n * Button variants using CVA for type-safe, maintainable styling\r\n */\r\nconst buttonVariants = cva(\r\n    // Base styles (always applied)\r\n    \"rounded-2xl font-semibold transition-all duration-200 flex items-center justify-center relative overflow-hidden focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-teal-500\",\r\n    {\r\n        variants: {\r\n            variant: {\r\n                primary: \"bg-teal-600 text-white shadow-lg shadow-teal-200 hover:bg-teal-700 active:scale-95\",\r\n                secondary: \"bg-stone-100 text-stone-800 hover:bg-stone-200\",\r\n                danger: \"bg-rose-100 text-rose-700 hover:bg-rose-200 border-2 border-rose-200\",\r\n                outline: \"border-2 border-teal-600 text-teal-700 hover:bg-teal-50\",\r\n                ghost: \"bg-transparent text-stone-500 hover:text-stone-800\",\r\n                locked: \"bg-stone-200 text-stone-400 cursor-not-allowed\",\r\n            },\r\n            size: {\r\n                small: \"py-2 px-4 text-sm\",\r\n                normal: \"py-3 px-6 text-base\",\r\n                large: \"py-6 px-8 text-xl h-24\",\r\n                xl: \"py-8 px-8 text-2xl h-32\",\r\n            },\r\n        },\r\n        defaultVariants: {\r\n            variant: \"primary\",\r\n            size: \"normal\",\r\n        },\r\n    }\r\n);\r\n\r\nexport interface ButtonProps\r\n    extends ButtonHTMLAttributes<HTMLButtonElement>,\r\n    VariantProps<typeof buttonVariants> {\r\n    'aria-label'?: string;\r\n}\r\n\r\nexport const Button: React.FC<ButtonProps> = ({\r\n    children,\r\n    onClick,\r\n    variant,\r\n    size,\r\n    className,\r\n    disabled = false,\r\n    'aria-label': ariaLabel,\r\n    ...props\r\n}) => {\r\n    return (\r\n        <button\r\n            onClick={onClick}\r\n            disabled={disabled}\r\n            aria-label={ariaLabel}\r\n            className={cn(\r\n                buttonVariants({\r\n                    variant: disabled ? 'locked' : variant,\r\n                    size\r\n                }),\r\n                className\r\n            )}\r\n            {...props}\r\n        >\r\n            {children}\r\n        </button>\r\n    );\r\n};\r\n\r\n// Export variants for external use (e.g., link styled as button)\r\nexport { buttonVariants };\r\n\r\nexport default Button;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\components\\ui\\LiquidView.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\components\\ui\\LivingBackground.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\components\\ui\\MemberActionMenu.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\components\\ui\\Modal.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\components\\ui\\Pictogram.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\components\\ui\\RelationsSelect.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\components\\ui\\Skeleton.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\config.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\config\\features.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\config\\firebase.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\contexts\\CareCircleContext.tsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":2,"message":"Fast refresh only works when a file only exports components. Move your React context(s) to a separate file.","line":4,"column":14,"nodeType":"Identifier","messageId":"reactContext","endLine":4,"endColumn":31},{"ruleId":"react-refresh/only-export-components","severity":2,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":41,"column":14,"nodeType":"Identifier","messageId":"namedExport","endLine":41,"endColumn":34}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { createContext, useContext } from 'react';\r\nimport { CareCircleContextValue } from '../types';\r\n\r\nexport const CareCircleContext = createContext<CareCircleContextValue>({\r\n    careCircleId: null,\r\n    seniorId: null,\r\n    seniorName: 'Senior',\r\n    currentUserId: null,\r\n    userRole: null,\r\n    userName: 'Bruger',\r\n    relativeName: 'P친r칮rende',\r\n    memberStatuses: [],\r\n    members: [],\r\n    relativeStatuses: [],\r\n    seniorStatus: null,\r\n    myStatus: 'home',\r\n    setMyStatus: async () => { },\r\n    activeTab: 'daily',\r\n    setActiveTab: () => { },\r\n    tasks: [],\r\n    toggleTask: () => { },\r\n    addTask: () => { },\r\n    symptoms: [],\r\n    addSymptom: async () => undefined,\r\n    weeklyAnswers: [],\r\n    addWeeklyAnswer: async () => undefined,\r\n    toggleLike: async () => { },\r\n    addReply: async () => { },\r\n    latestPing: null,\r\n    sendPing: async () => undefined,\r\n    dismissPing: () => { },\r\n    lastCheckIn: null,\r\n    recordCheckIn: async () => undefined,\r\n    updateMember: async () => { },\r\n    updateAnyMember: async () => { },\r\n});\r\n\r\n/**\r\n * Hook to access CareCircle context\r\n */\r\nexport const useCareCircleContext = () => {\r\n    const context = useContext(CareCircleContext);\r\n    if (!context) {\r\n        throw new Error('useCareCircleContext must be used within a CareCircleProvider');\r\n    }\r\n    return context;\r\n};\r\n\r\n/**\r\n * Provider component that wraps the app and provides circle state\r\n */\r\nexport const CareCircleProvider = CareCircleContext.Provider;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\contexts\\ThemeContext.tsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":2,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":64,"column":14,"nodeType":"Identifier","messageId":"namedExport","endLine":64,"endColumn":22}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { createContext, useContext, useState, useEffect, useMemo } from 'react';\r\nimport { useCircadianTheme, CircadianPhase } from '../hooks/useCircadianTheme';\r\n\r\ntype ThemeMode = 'auto' | 'light' | 'dark';\r\n\r\ninterface ThemeContextType {\r\n    mode: ThemeMode;\r\n    circadianPhase: CircadianPhase;\r\n    setMode: (mode: ThemeMode) => void;\r\n    isDark: boolean;\r\n}\r\n\r\nconst ThemeContext = createContext<ThemeContextType | undefined>(undefined);\r\n\r\nexport const ThemeProvider: React.FC<{ children: React.ReactNode }> = ({ children }) => {\r\n    // Load persisted mode or default to auto\r\n    const [mode, setModeState] = useState<ThemeMode>(() => {\r\n        const saved = localStorage.getItem('theme-mode');\r\n        return (saved as ThemeMode) || 'auto';\r\n    });\r\n\r\n    // Use the robust Circadian Engine\r\n    const circadianPhase = useCircadianTheme(mode === 'dark');\r\n\r\n    // Persist mode changes\r\n    const setMode = (newMode: ThemeMode) => {\r\n        setModeState(newMode);\r\n        localStorage.setItem('theme-mode', newMode);\r\n    };\r\n\r\n    // Determine if we should be in dark mode\r\n    // Determine if we should be in dark mode\r\n    const isDark = useMemo(() => {\r\n        if (mode === 'dark') return true;\r\n        if (mode === 'light') return false;\r\n        // AUTO: Phase 'midnight' is strictly for dark mode\r\n        return circadianPhase === 'midnight';\r\n    }, [mode, circadianPhase]);\r\n\r\n    // Apply theme class to body\r\n    useEffect(() => {\r\n        const body = document.body;\r\n        if (isDark) {\r\n            body.classList.add('theme-dark');\r\n        } else {\r\n            body.classList.remove('theme-dark');\r\n        }\r\n    }, [isDark]);\r\n\r\n    const value = useMemo(() => ({\r\n        mode,\r\n        circadianPhase,\r\n        setMode,\r\n        isDark\r\n    }), [mode, circadianPhase, isDark]);\r\n\r\n    return (\r\n        <ThemeContext.Provider value={value}>\r\n            {children}\r\n        </ThemeContext.Provider>\r\n    );\r\n};\r\n\r\nexport const useTheme = () => {\r\n    const context = useContext(ThemeContext);\r\n    if (!context) {\r\n        throw new Error('useTheme must be used within a ThemeProvider');\r\n    }\r\n    return context;\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\data\\constants.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\data\\wordGameData.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\data\\wordGameData_bs.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\data\\wordGameData_tr.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\features\\ambient\\ActivityTimeline.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\features\\ambient\\AmbientHero.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\features\\ambient\\BriefingStory.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\features\\ambient\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\features\\coffee\\CoffeeInviteCard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\features\\coffee\\CoffeeToggle.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\features\\coffee\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\features\\familyPresence\\AmbientDashboard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\features\\familyPresence\\FamilyPresence.tsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Declaration or statement expected.","line":97,"column":5}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\r\nimport { Users } from 'lucide-react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { useCareCircleContext } from '../../contexts/CareCircleContext';\r\nimport { Avatar } from '../../components/ui/Avatar';\r\nimport { MemberStatus } from './useMemberStatus';\r\nimport { FirestoreDate } from '../../types';\r\nimport { toJsDate } from '../../utils/dateUtils';\r\n\r\ninterface MemberStatusRowProps {\r\n    name: string;\r\n    status: string;\r\n    role: string;\r\n    timestamp?: FirestoreDate;\r\n    isCurrentUser?: boolean;\r\n}\r\n\r\n// 游 TURBO: Memoized MemberStatusRow to prevent re-renders when parent state changes.\r\n// This is a high-frequency component, so memoization provides a significant performance boost.\r\nconst MemberStatusRow: React.FC<MemberStatusRowProps> = React.memo(({ name, status, role, timestamp, isCurrentUser = false }) => {\r\n    const { t } = useTranslation();\r\n    const avatarId = role === 'senior' ? 'senior' :\r\n        name.toLowerCase().includes('louise') ? 'louise' :\r\n            name.toLowerCase().includes('juzu') ? 'juzu' :\r\n                (name.toLowerCase().includes('brad') || name.toLowerCase().includes('senior')) ? 'brad' : 'fatima';\r\n\r\n    const statusIdMapping: Record<string, string> = {\r\n        'home': 'home',\r\n        'work': 'work',\r\n        'traveling': 'car',\r\n        'available': 'coffee',\r\n        'busy': 'moon',\r\n        'good': 'home',\r\n        'default': 'home'\r\n    };\r\n\r\n    const statusIconId = statusIdMapping[status] || 'home';\r\n    const config = role === 'senior'\r\n        ? { label: t('peace_all_well'), color: 'text-green-600' }\r\n        : { label: t(`status_${status}`), color: 'text-stone-500' };\r\n\r\n    let timeString = '';\r\n    if (timestamp) {\r\n        const date = toJsDate(timestamp);\r\n\r\n        if (date) {\r\n            const now = new Date();\r\n            const diffMs = now.getTime() - date.getTime();\r\n\r\n            const diffMins = Math.max(0, Math.floor(diffMs / 60000)); // Prevent negative values\r\n\r\n            if (diffMins < 60) {\r\n                timeString = `${diffMins}m`;\r\n            } else if (diffMins < 1440) {\r\n                timeString = `${Math.floor(diffMins / 60)}t`;\r\n            } else {\r\n                timeString = date.toLocaleDateString('da-DK', { day: 'numeric', month: 'short' });\r\n            }\r\n        }\r\n\r\n        return (\r\n            <div className={`\r\n            flex items-center justify-between p-3 rounded-xl transition-all\r\n            ${isCurrentUser ? 'bg-indigo-50/50 border border-indigo-100/50' : 'hover:bg-stone-50 border border-transparent hover:border-stone-100'}\r\n        `}>\r\n                <div className=\"flex items-center gap-3\">\r\n                    {/* Avatar with connection glow when available */}\r\n                    <div className={`relative ${status === 'available' ? 'animate-glow' : ''}`}>\r\n                        <Avatar id={avatarId} size=\"md\" className=\"shadow-sm border-2 border-white\" />\r\n                        <div className={`absolute -bottom-0.5 -right-0.5 w-3.5 h-3.5 rounded-full border-2 border-white ${status === 'available' ? 'bg-teal-500' :\r\n                            status === 'home' ? 'bg-green-500' :\r\n                                status === 'work' ? 'bg-indigo-500' :\r\n                                    status === 'traveling' ? 'bg-amber-500' : 'bg-stone-400'\r\n                            }`} />\r\n                    </div>\r\n                    <div>\r\n                        <span className={`text-sm font-bold block text-left ${isCurrentUser ? 'text-indigo-900' : 'text-stone-700'}`}>\r\n                            {name} {isCurrentUser && <span className=\"opacity-50 text-xs font-normal\">({t('you')})</span>}\r\n                        </span>\r\n                        <span className={`text-xs font-medium block text-left ${config.color || 'text-stone-500'}`}>\r\n                            {config.label}\r\n                        </span>\r\n                    </div>\r\n                </div>\r\n                <div className=\"flex flex-col items-end gap-1\">\r\n                    <div className=\"bg-stone-100/80 p-1.5 rounded-lg backdrop-blur-sm\">\r\n                        <Avatar id={statusIconId} size=\"sm\" />\r\n                    </div>\r\n                    {timeString && (\r\n                        <span className=\"text-[10px] font-medium text-stone-400 tabular-nums\">\r\n                            {timeString}\r\n                        </span>\r\n                    )}\r\n                </div>\r\n            </div>\r\n        );\r\n    });\r\n\r\ninterface FamilyPresenceProps {\r\n    memberStatuses?: MemberStatus[];\r\n    currentUserId?: string;\r\n    seniorName?: string;\r\n    compact?: boolean;\r\n}\r\n\r\nexport const FamilyPresence: React.FC<FamilyPresenceProps> = ({\r\n    memberStatuses: propsMembers,\r\n    currentUserId: propsUserId,\r\n    seniorName: propsSeniorName,\r\n    compact = false\r\n}) => {\r\n    const { t } = useTranslation();\r\n    const context = useCareCircleContext();\r\n    const memberStatuses = propsMembers ?? context?.memberStatuses ?? [];\r\n    const currentUserId = propsUserId ?? context?.currentUserId;\r\n    const seniorName = propsSeniorName ?? context?.seniorName ?? 'Far/Mor';\r\n\r\n    // 游 TURBO: Create a lookup map for member statuses to optimize the render loop.\r\n    // This reduces the complexity from O(n*m) to O(n+m), preventing a nested loop.\r\n    const statusMap = React.useMemo(() => {\r\n        return memberStatuses.reduce((acc: Record<string, MemberStatus>, status: MemberStatus) => {\r\n            acc[status.docId] = status;\r\n            return acc;\r\n        }, {} as Record<string, MemberStatus>);\r\n    }, [memberStatuses]);\r\n\r\n\r\n    if (memberStatuses.length === 0) {\r\n        return (\r\n            <div className={`bg-stone-50 rounded-xl ${compact ? 'p-3' : 'p-4'} border border-stone-200`}>\r\n                <p className=\"text-stone-400 text-sm text-center\">{t('no_relatives')}</p>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div className={`bg-white rounded-2xl ${compact ? 'p-3' : 'p-4'} border border-stone-100 shadow-sm overflow-hidden`}>\r\n            <div className=\"flex items-center justify-between mb-3\">\r\n                <div className=\"flex items-center gap-2\">\r\n                    <div className=\"p-1.5 bg-indigo-50 rounded-lg\">\r\n                        <Users className=\"w-4 h-4 text-indigo-600\" />\r\n                    </div>\r\n                    <h4 className=\"text-xs font-bold text-stone-500 uppercase tracking-wide\">\r\n                        {t('family_circle')}\r\n                    </h4>\r\n                </div>\r\n            </div>\r\n            <div className=\"space-y-1\">\r\n                {context.members.map((member) => {\r\n                    // O(1) lookup instead of O(m) .find()\r\n                    const statusObj = statusMap[member.userId || ''];\r\n                    // Name source of truth: THE MEMBER RECORD\r\n                    const displayName = member.displayName || (member.role === 'senior' ? seniorName : 'P친r칮rende');\r\n\r\n                    return (\r\n                        <MemberStatusRow\r\n                            key={member.userId}\r\n                            name={displayName}\r\n                            status={statusObj?.status || 'home'}\r\n                            role={member.role}\r\n                            timestamp={statusObj?.updatedAt}\r\n                            isCurrentUser={member.userId === currentUserId}\r\n                        />\r\n                    );\r\n                })}\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default FamilyPresence;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\features\\familyPresence\\StatusCard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\features\\familyPresence\\SuperpowerBadge.tsx","messages":[],"suppressedMessages":[{"ruleId":"react-refresh/only-export-components","severity":2,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":204,"column":10,"nodeType":"Identifier","messageId":"namedExport","endLine":204,"endColumn":23,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\features\\familyPresence\\config.ts","messages":[{"ruleId":"no-undef","severity":2,"message":"'React' is not defined.","line":10,"column":11,"nodeType":"Identifier","messageId":"undef","endLine":10,"endColumn":16},{"ruleId":"no-undef","severity":2,"message":"'React' is not defined.","line":33,"column":11,"nodeType":"Identifier","messageId":"undef","endLine":33,"endColumn":16}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Briefcase, Home, Car, Coffee, Moon, Wifi, Ear, Wrench, Star } from 'lucide-react';\r\n\r\n// ============================================================================\r\n// STATUS CONFIGURATION\r\n// ============================================================================\r\n\r\nexport interface StatusOption {\r\n    id: string;\r\n    label: string;\r\n    icon: React.ElementType;\r\n    color: string;\r\n}\r\n\r\n/**\r\n * Status options for family members\r\n */\r\nexport const STATUS_OPTIONS: StatusOption[] = [\r\n    { id: 'work', label: 'P친 arbejde', icon: Briefcase, color: 'bg-indigo-100 text-indigo-600' },\r\n    { id: 'home', label: 'Hjemme', icon: Home, color: 'bg-green-100 text-green-600' },\r\n    { id: 'traveling', label: 'Undervejs', icon: Car, color: 'bg-amber-100 text-amber-600' },\r\n    { id: 'available', label: 'Har tid til en snak', icon: Coffee, color: 'bg-teal-100 text-teal-600' },\r\n    { id: 'busy', label: 'Optaget', icon: Moon, color: 'bg-stone-100 text-stone-500' },\r\n];\r\n\r\n// ============================================================================\r\n// ARCHETYPE CONFIGURATION\r\n// ============================================================================\r\n\r\nexport type Archetype = 'tech_wizard' | 'listener' | 'fixer' | 'driver' | 'cheerleader';\r\n\r\nexport interface ArchetypeConfig {\r\n    id: Archetype;\r\n    icon: React.ElementType;\r\n    label: string;\r\n    description: string;\r\n    action: string;\r\n    color: string;\r\n}\r\n\r\nexport const ARCHETYPE_CONFIG: Record<Archetype, ArchetypeConfig> = {\r\n    tech_wizard: {\r\n        id: 'tech_wizard',\r\n        icon: Wifi,\r\n        label: 'Teknik-Ekspert',\r\n        description: 'Ring n친r iPad driller eller WiFi ikke virker',\r\n        action: 'call',\r\n        color: 'bg-blue-600'\r\n    },\r\n    listener: {\r\n        id: 'listener',\r\n        icon: Ear,\r\n        label: 'Lytteren',\r\n        description: 'Ring for en god snak og lidt tr칮st',\r\n        action: 'call',\r\n        color: 'bg-purple-600'\r\n    },\r\n    fixer: {\r\n        id: 'fixer',\r\n        icon: Wrench,\r\n        label: 'Fikser-Typen',\r\n        description: 'Ring n친r noget skal repareres derhjemme',\r\n        action: 'call',\r\n        color: 'bg-orange-600'\r\n    },\r\n    driver: {\r\n        id: 'driver',\r\n        icon: Car,\r\n        label: 'Chauff칮ren',\r\n        description: 'Ring for en tur til l칝gen eller butikken',\r\n        action: 'call',\r\n        color: 'bg-green-600'\r\n    },\r\n    cheerleader: {\r\n        id: 'cheerleader',\r\n        icon: Star,\r\n        label: 'Heppen',\r\n        description: 'Del gode nyheder og f친 et stort smil',\r\n        action: 'message',\r\n        color: 'bg-amber-500'\r\n    }\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\features\\familyPresence\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\features\\familyPresence\\useMemberStatus.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\features\\helpExchange\\HelpExchange.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\features\\helpExchange\\MatchCelebration.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\features\\helpExchange\\config.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\features\\helpExchange\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\features\\helpExchange\\useHelpExchange.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\features\\helpExchange\\useHelpExchangeMatch.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\features\\memories\\AudioRecorder.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\features\\memories\\MemoriesGallery.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\features\\memories\\useMemories.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\features\\onboarding\\AudioContext.tsx","messages":[],"suppressedMessages":[{"ruleId":"react-refresh/only-export-components","severity":2,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":22,"column":14,"nodeType":"Identifier","messageId":"namedExport","endLine":22,"endColumn":22,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\features\\onboarding\\Onboarding.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\features\\onboarding\\RelationshipMatrix.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\features\\onboarding\\RelativeWelcome.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\features\\onboarding\\SeniorWelcome.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\features\\onboarding\\WelcomeLayout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\features\\onboarding\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\features\\onboarding\\useVideoAutoplay.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\features\\onboarding\\useVideoAutoplay.ts","messages":[],"suppressedMessages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'isMuted'. Either include it or remove the dependency array.","line":24,"column":8,"nodeType":"ArrayExpression","endLine":24,"endColumn":14,"suggestions":[{"desc":"Update the dependencies array to be: [isMuted, step]","fix":{"range":[1011,1017],"text":"[isMuted, step]"}}],"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\features\\photos\\PhotoShare.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\features\\photos\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\features\\photos\\usePhotos.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\features\\symptoms\\BodyPainSelector.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\features\\symptoms\\SymptomSummary.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\features\\symptoms\\constants.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\features\\symptoms\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\features\\symptoms\\useSymptoms.ts","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 'SAFE_SYMPTOM_FIELDS'. Either include it or remove the dependency array.","line":73,"column":8,"nodeType":"ArrayExpression","endLine":73,"endColumn":10,"suggestions":[{"desc":"Update the dependencies array to be: [SAFE_SYMPTOM_FIELDS]","fix":{"range":[2525,2527],"text":"[SAFE_SYMPTOM_FIELDS]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\n// Symptoms hook - real-time symptom log sync via Firestore\r\n// Replaces localStorage for multi-user symptom tracking\r\n\r\nimport { useState, useEffect, useCallback } from 'react';\r\nimport {\r\n    collection,\r\n    doc,\r\n    setDoc,\r\n    deleteDoc,\r\n    onSnapshot,\r\n    serverTimestamp,\r\n    query,\r\n    orderBy,\r\n    limit\r\n} from 'firebase/firestore';\r\nimport { db } from '../../config/firebase';\r\n\r\nimport { SymptomLog, SymptomStats } from '../../types';\r\nimport { toJsDate } from '../../utils/dateUtils';\r\n\r\nexport function useSymptoms(circleId: string | null) {\r\n    const [symptoms, setSymptoms] = useState<SymptomLog[]>([]);\r\n    const [loading, setLoading] = useState<boolean>(true);\r\n    const [error, setError] = useState<string | null>(null);\r\n\r\n    // Subscribe to symptoms from Firestore (most recent first, limited)\r\n    useEffect(() => {\r\n        if (!circleId) {\r\n            setTimeout(() => {\r\n                setSymptoms([]);\r\n                setLoading(false);\r\n            }, 0);\r\n            return;\r\n        }\r\n\r\n        const symptomsRef = collection(db, 'careCircles', circleId, 'symptoms');\r\n        const symptomsQuery = query(symptomsRef, orderBy('loggedAt', 'desc'), limit(50));\r\n\r\n        const unsubscribe = onSnapshot(symptomsQuery,\r\n            (snapshot) => {\r\n                const symptomsList = snapshot.docs.map(doc => ({\r\n                    id: doc.id,\r\n                    ...doc.data()\r\n                })) as SymptomLog[];\r\n                setSymptoms(symptomsList);\r\n                setLoading(false);\r\n            },\r\n            (err: unknown) => {\r\n                console.error('Error fetching symptoms:', err);\r\n                setError(err instanceof Error ? err.message : 'Unknown error');\r\n                setLoading(false);\r\n            }\r\n        );\r\n\r\n        return () => unsubscribe();\r\n    }, [circleId]);\r\n\r\n    // Whitelist of safe fields to save to Firestore\r\n    // React components and their Symbol properties are NOT safe\r\n    const SAFE_SYMPTOM_FIELDS = ['id', 'label', 'color', 'bodyLocation'];\r\n\r\n    const sanitizeSymptomData = useCallback((data: Partial<SymptomLog>) => {\r\n        const clean: Record<string, unknown> = {};\r\n        const safeData = data as Record<string, unknown>;\r\n        SAFE_SYMPTOM_FIELDS.forEach(key => {\r\n            const val = safeData[key];\r\n            if (val !== undefined && typeof val !== 'function' && typeof val !== 'symbol') {\r\n                clean[key] = val;\r\n            }\r\n        });\r\n        return clean;\r\n    }, []);\r\n\r\n    // Add a new symptom log\r\n    const addSymptom = useCallback(async (symptomData: Partial<SymptomLog>) => {\r\n        if (!circleId) return;\r\n\r\n        const now = new Date();\r\n        const timeString = now.getHours().toString().padStart(2, '0') + ':' +\r\n            now.getMinutes().toString().padStart(2, '0');\r\n        const dateString = now.toLocaleDateString('da-DK');\r\n\r\n        const symptomId = `symptom_${Date.now()}`;\r\n        const symptomRef = doc(db, 'careCircles', circleId, 'symptoms', symptomId);\r\n\r\n        try {\r\n            await setDoc(symptomRef, {\r\n                ...sanitizeSymptomData(symptomData),\r\n                time: timeString,\r\n                date: dateString,\r\n                loggedAt: serverTimestamp(),\r\n            });\r\n            return symptomId;\r\n        } catch (err: unknown) {\r\n            console.error('Error adding symptom:', err);\r\n            setError(err instanceof Error ? err.message : 'Unknown error');\r\n            throw err;\r\n        }\r\n    }, [circleId, sanitizeSymptomData]);\r\n\r\n    // Delete a symptom log\r\n    const removeSymptom = useCallback(async (symptomId: string) => {\r\n        if (!circleId) return;\r\n\r\n        try {\r\n            await deleteDoc(doc(db, 'careCircles', circleId, 'symptoms', symptomId));\r\n        } catch (err: unknown) {\r\n            console.error('Error removing symptom:', err);\r\n            setError(err instanceof Error ? err.message : 'Unknown error');\r\n            throw err;\r\n        }\r\n    }, [circleId]);\r\n\r\n    // Get symptoms for a specific date range (for reports)\r\n    const getSymptomsByDateRange = useCallback((startDate: Date, endDate: Date) => {\r\n        return symptoms.filter(s => {\r\n            const symptomDate = toJsDate(s.loggedAt);\r\n            if (!symptomDate) return false;\r\n            return symptomDate >= startDate && symptomDate <= endDate;\r\n        });\r\n    }, [symptoms]);\r\n\r\n    // Get symptom stats for doctor report\r\n    const getSymptomStats = useCallback(() => {\r\n        const stats: Record<string, SymptomStats> = {};\r\n        symptoms.forEach(s => {\r\n            const type = s.id || s.label || 'unknown';\r\n            if (!stats[type]) {\r\n                stats[type] = { count: 0, lastOccurrence: null };\r\n            }\r\n            stats[type].count++;\r\n            if (!stats[type].lastOccurrence) {\r\n                stats[type].lastOccurrence = s.date;\r\n            }\r\n        });\r\n        return stats;\r\n    }, [symptoms]);\r\n\r\n    return {\r\n        symptoms,\r\n        loading,\r\n        error,\r\n        addSymptom,\r\n        removeSymptom,\r\n        getSymptomsByDateRange,\r\n        getSymptomStats,\r\n    };\r\n}\r\n\r\nexport default useSymptoms;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\features\\tasks\\ProgressRing.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\features\\tasks\\TaskCard.tsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":2,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":120,"column":10,"nodeType":"Identifier","messageId":"namedExport","endLine":120,"endColumn":22},{"ruleId":"react-refresh/only-export-components","severity":2,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":120,"column":24,"nodeType":"Identifier","messageId":"namedExport","endLine":120,"endColumn":45},{"ruleId":"react-refresh/only-export-components","severity":2,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":120,"column":47,"nodeType":"Identifier","messageId":"namedExport","endLine":120,"endColumn":63}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\r\nimport { cva } from 'class-variance-authority';\r\nimport { CheckCircle, Pill, Activity, Sun, Clock, Heart } from 'lucide-react';\r\nimport { cn } from '../../lib/utils';\r\nimport { Task } from '../../types';\r\n\r\n/**\r\n * Task card container variants\r\n * Premium styling with glass effect and plush shadows\r\n */\r\nconst cardVariants = cva(\r\n    \"relative p-4 rounded-2xl border transition-all cursor-pointer\",\r\n    {\r\n        variants: {\r\n            state: {\r\n                completed: \"bg-gradient-to-br from-stone-50/90 to-stone-100/80 border-stone-200/50 shadow-sm\",\r\n                pending: \"glass-premium shadow-plush hover:shadow-plush-lg hover:border-teal-200/60\",\r\n            },\r\n        },\r\n        defaultVariants: {\r\n            state: \"pending\",\r\n        },\r\n    }\r\n);\r\n\r\nconst iconContainerVariants = cva(\r\n    \"w-16 h-16 rounded-2xl flex items-center justify-center shadow-inner\",\r\n    {\r\n        variants: {\r\n            state: {\r\n                completed: \"bg-stone-200 text-stone-400\",\r\n                pending: \"bg-blue-50 text-blue-600\",\r\n            },\r\n        },\r\n        defaultVariants: {\r\n            state: \"pending\",\r\n        },\r\n    }\r\n);\r\n\r\nconst checkboxVariants = cva(\r\n    \"w-12 h-12 rounded-full border-4 flex items-center justify-center transition-all\",\r\n    {\r\n        variants: {\r\n            state: {\r\n                completed: \"bg-teal-500 border-teal-500 shadow-[0_0_16px_4px_hsl(174_55%_38%/0.3)]\",\r\n                pending: \"border-stone-200 bg-white shadow-sm hover:border-teal-300 hover:shadow-plush\",\r\n            },\r\n        },\r\n        defaultVariants: {\r\n            state: \"pending\",\r\n        },\r\n    }\r\n);\r\n\r\ninterface TaskCardProps {\r\n    task: Task;\r\n    onToggle: () => void;\r\n}\r\n\r\nconst TASK_ICONS: Record<string, React.ElementType> = {\r\n    medication: Pill,\r\n    hydration: Activity,\r\n    activity: Sun,\r\n    appointment: Clock,\r\n};\r\n\r\nexport const TaskCard: React.FC<TaskCardProps> = ({ task, onToggle }) => {\r\n    const state = task.completed ? 'completed' : 'pending';\r\n    const Icon = TASK_ICONS[task.type || 'activity'] || Sun;\r\n\r\n    return (\r\n        <div\r\n            onClick={onToggle}\r\n            className={cn(cardVariants({ state }))}\r\n        >\r\n            <div className=\"flex items-center justify-between\">\r\n                <div className=\"flex items-center gap-4\">\r\n                    {/* Pictogram Container */}\r\n                    <div className={cn(iconContainerVariants({ state }), \"shrink-0\")}>\r\n                        <Icon className=\"w-8 h-8\" />\r\n                    </div>\r\n\r\n                    <div>\r\n                        <div className=\"flex items-center gap-2 flex-wrap\">\r\n                            <h3 className={cn(\r\n                                \"text-xl font-bold tracking-tight\",\r\n                                task.completed ? \"theme-text-muted opacity-60 line-through\" : \"theme-text\"\r\n                            )}>\r\n                                {task.title}\r\n                            </h3>\r\n                            {/* Social Attribution Stamp */}\r\n                            {task.createdByRole === 'relative' && task.createdByName && (\r\n                                <span className=\"inline-flex items-center gap-1 bg-indigo-50 px-2 py-0.5 rounded-lg\">\r\n                                    <Heart className=\"w-3 h-3 text-indigo-500 fill-indigo-200\" />\r\n                                    <span className=\"text-[10px] text-indigo-700 font-medium\">Fra {task.createdByName}</span>\r\n                                </span>\r\n                            )}\r\n                        </div>\r\n                        <p className=\"theme-text-muted font-medium opacity-80\">{task.time}</p>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Checkbox with celebration animation */}\r\n                <div className={cn(\r\n                    checkboxVariants({ state }),\r\n                    task.completed && 'animate-celebrate relative'\r\n                )}>\r\n                    {task.completed && <CheckCircle className=\"text-white w-8 h-8\" />}\r\n                    {/* Celebration ring burst */}\r\n                    {task.completed && (\r\n                        <span className=\"absolute inset-0 rounded-full border-2 border-teal-400 animate-ping opacity-75\" />\r\n                    )}\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport { cardVariants, iconContainerVariants, checkboxVariants };\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\features\\tasks\\TimePickerModal.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\features\\tasks\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\features\\tasks\\useTasks.ts","messages":[{"ruleId":"react-hooks/immutability","severity":2,"message":"Error: Cannot access variable before it is declared\n\n`checkDailyReset` is accessed before it is declared, which prevents the earlier access from updating when this value changes over time.\n\nC:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\features\\tasks\\useTasks.ts:67:13\n  65 |     useEffect(() => {\n  66 |         if (circleId && tasks.length > 0) {\n> 67 |             checkDailyReset(circleId, tasks);\n     |             ^^^^^^^^^^^^^^^ `checkDailyReset` accessed before it is declared\n  68 |         }\n  69 |     }, [circleId, tasks.length > 0]);\n  70 |\n\nC:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\features\\tasks\\useTasks.ts:71:5\n  69 |     }, [circleId, tasks.length > 0]);\n  70 |\n> 71 |     const checkDailyReset = async (cId: string, currentTasks: Task[]) => {\n     |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 72 |         try {\n     | ^^^^^^^^^^^^^\n> 73 |             const today = new Date().toISOString().split('T')[0]; // YYYY-MM-DD\n     뵢n     | ^^^^^^^^^^^^^\n> 86 |         }\n     | ^^^^^^^^^^^^^\n> 87 |     };\n     | ^^^^^^^ `checkDailyReset` is declared here\n  88 |\n  89 |     const performDailyReset = async (cId: string, currentTasks: Task[], dateStr: string) => {\n  90 |         try {","line":67,"column":13,"nodeType":null,"endLine":67,"endColumn":28},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'checkDailyReset' and 'tasks'. Either include them or remove the dependency array.","line":69,"column":8,"nodeType":"ArrayExpression","endLine":69,"endColumn":36,"suggestions":[{"desc":"Update the dependencies array to be: [checkDailyReset, circleId, tasks]","fix":{"range":[2220,2248],"text":"[checkDailyReset, circleId, tasks]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a complex expression in the dependency array. Extract it to a separate variable so it can be statically checked.","line":69,"column":19,"nodeType":"BinaryExpression","endLine":69,"endColumn":35}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\n// Tasks hook - real-time task sync via Firestore\r\n// Replaces localStorage for multi-user task management\r\n\r\nimport { useState, useEffect, useCallback } from 'react';\r\nimport {\r\n    collection,\r\n    doc,\r\n    getDoc,\r\n    setDoc,\r\n    updateDoc,\r\n    deleteDoc,\r\n    onSnapshot,\r\n    serverTimestamp,\r\n    query,\r\n    orderBy\r\n} from 'firebase/firestore';\r\nimport { db } from '../../config/firebase';\r\nimport { INITIAL_TASKS } from '../../data/constants';\r\n\r\nimport { Task } from '../../types';\r\n\r\nexport function useTasks(circleId: string | null) {\r\n    const [tasks, setTasks] = useState<Task[]>([]);\r\n    const [loading, setLoading] = useState<boolean>(true);\r\n    const [error, setError] = useState<string | null>(null);\r\n\r\n    // Subscribe to tasks from Firestore\r\n    useEffect(() => {\r\n        if (!circleId) {\r\n            setTasks(INITIAL_TASKS as Task[]); // Fallback to defaults\r\n            setLoading(false);\r\n            return;\r\n        }\r\n\r\n        const tasksRef = collection(db, 'careCircles', circleId, 'tasks');\r\n        const tasksQuery = query(tasksRef, orderBy('period'), orderBy('time'));\r\n\r\n        const unsubscribe = onSnapshot(tasksQuery,\r\n            (snapshot) => {\r\n                if (snapshot.empty) {\r\n                    // Initialize with default tasks if none exist\r\n                    // Initialize with default tasks if none exist\r\n                    initializeDefaultTasks(circleId);\r\n                } else {\r\n                    const tasksList = snapshot.docs.map(doc => ({\r\n                        id: doc.id,\r\n                        ...doc.data()\r\n                    })) as Task[];\r\n                    setTasks(tasksList);\r\n                }\r\n                setLoading(false);\r\n            },\r\n            (err: unknown) => {\r\n                console.error('Error fetching tasks:', err);\r\n                setError(err instanceof Error ? err.message : 'Unknown error');\r\n                setLoading(false);\r\n            }\r\n        );\r\n\r\n        return () => unsubscribe();\r\n    }, [circleId]);\r\n\r\n    // Check for daily reset on load\r\n    useEffect(() => {\r\n        if (circleId && tasks.length > 0) {\r\n            checkDailyReset(circleId, tasks);\r\n        }\r\n    }, [circleId, tasks.length > 0]);\r\n\r\n    const checkDailyReset = async (cId: string, currentTasks: Task[]) => {\r\n        try {\r\n            const today = new Date().toISOString().split('T')[0]; // YYYY-MM-DD\r\n            const circleRef = doc(db, 'careCircles', cId);\r\n            const circleDoc = await getDoc(circleRef);\r\n\r\n            if (circleDoc.exists()) {\r\n                const data = circleDoc.data();\r\n                if (data.lastResetDate !== today) {\r\n                    console.log('游깬 New day detected! Resetting daily tasks...');\r\n                    await performDailyReset(cId, currentTasks, today);\r\n                }\r\n            }\r\n        } catch (err) {\r\n            console.error('Error checking daily reset:', err);\r\n        }\r\n    };\r\n\r\n    const performDailyReset = async (cId: string, currentTasks: Task[], dateStr: string) => {\r\n        try {\r\n            // 1. Reset all recurring tasks\r\n            for (const task of currentTasks) {\r\n                // Medication tasks are recurring by default\r\n                const isMedication = task.type === 'medication' || task.title?.toLowerCase().includes('medicin');\r\n                const isRecurring = task.recurring || isMedication;\r\n\r\n                if (isRecurring) {\r\n                    const docId = task.id.startsWith('task_') ? task.id : `task_${task.id}`;\r\n                    await updateDoc(doc(db, 'careCircles', cId, 'tasks', docId), {\r\n                        completed: false,\r\n                        completedAt: null\r\n                    });\r\n                } else if (task.completed) {\r\n                    // Optional: Archive or delete old non-recurring tasks\r\n                    // For now, we'll just leave them or you could delete them if they are older than 24h\r\n                }\r\n            }\r\n\r\n            // 2. Update the reset date\r\n            await updateDoc(doc(db, 'careCircles', cId), {\r\n                lastResetDate: dateStr\r\n            });\r\n            console.log('九 Daily reset complete for', dateStr);\r\n        } catch (err) {\r\n            console.error('Error performing daily reset:', err);\r\n        }\r\n    };\r\n\r\n\r\n\r\n    // Toggle task completion\r\n    const toggleTask = useCallback(async (taskId: string) => {\r\n        if (!circleId) return;\r\n\r\n        const task = tasks.find(t => t.id === taskId || t.id === `task_${taskId}`);\r\n        if (!task) return;\r\n\r\n        const taskRef = doc(db, 'careCircles', circleId, 'tasks',\r\n            task.id.startsWith('task_') ? task.id : `task_${task.id}`);\r\n\r\n        try {\r\n            await setDoc(taskRef, {\r\n                completed: !task.completed,\r\n                completedAt: !task.completed ? serverTimestamp() : null,\r\n            }, { merge: true });\r\n        } catch (err: unknown) {\r\n            console.error('Error toggling task:', err);\r\n            setError(err instanceof Error ? err.message : 'Unknown error');\r\n        }\r\n    }, [circleId, tasks]);\r\n\r\n    // Add a new task (from relative or senior)\r\n    const addTask = useCallback(async (newTask: Partial<Task>) => {\r\n        if (!circleId) return;\r\n\r\n        const taskId = `task_${Date.now()}`;\r\n        const taskRef = doc(db, 'careCircles', circleId, 'tasks', taskId);\r\n\r\n        // Default time based on period if not provided\r\n        const defaultTimes: Record<string, string> = {\r\n            morgen: '09:00',\r\n            frokost: '12:00',\r\n            eftermiddag: '15:00',\r\n            aften: '19:00'\r\n        };\r\n\r\n        try {\r\n            await setDoc(taskRef, {\r\n                id: taskId,\r\n                ...newTask,\r\n                time: newTask.time || (newTask.period ? defaultTimes[newTask.period] : '12:00'),\r\n                completed: false,\r\n                recurring: newTask.recurring || false,\r\n                createdAt: serverTimestamp(),\r\n                completedAt: null,\r\n            });\r\n            return taskId;\r\n        } catch (err: unknown) {\r\n            console.error('Error adding task:', err);\r\n            setError(err instanceof Error ? err.message : 'Unknown error');\r\n            throw err;\r\n        }\r\n    }, [circleId]);\r\n\r\n    // Remove a task\r\n    const removeTask = useCallback(async (taskId: string) => {\r\n        if (!circleId) return;\r\n\r\n        const docId = taskId.startsWith('task_') ? taskId : `task_${taskId}`;\r\n        const taskRef = doc(db, 'careCircles', circleId, 'tasks', docId);\r\n\r\n        try {\r\n            await deleteDoc(taskRef);\r\n        } catch (err: unknown) {\r\n            console.error('Error removing task:', err);\r\n            setError(err instanceof Error ? err.message : 'Unknown error');\r\n            throw err;\r\n        }\r\n    }, [circleId]);\r\n\r\n    // Reset all tasks (mark incomplete)\r\n    const resetTasks = useCallback(async () => {\r\n        if (!circleId) return;\r\n\r\n        try {\r\n            for (const task of tasks) {\r\n                const docId = task.id.startsWith('task_') ? task.id : `task_${task.id}`;\r\n                await setDoc(doc(db, 'careCircles', circleId, 'tasks', docId), {\r\n                    completed: false,\r\n                    completedAt: null,\r\n                }, { merge: true });\r\n            }\r\n        } catch (err: unknown) {\r\n            console.error('Error resetting tasks:', err);\r\n            setError(err instanceof Error ? err.message : 'Unknown error');\r\n        }\r\n    }, [circleId, tasks]);\r\n\r\n    return {\r\n        tasks,\r\n        loading,\r\n        error,\r\n        toggleTask,\r\n        addTask,\r\n        removeTask,\r\n        resetTasks,\r\n    };\r\n}\r\n\r\nexport default useTasks;\r\n\r\n// Initialize default tasks for new circles\r\nconst initializeDefaultTasks = async (cId: string) => {\r\n    try {\r\n        for (const task of INITIAL_TASKS) {\r\n            await setDoc(doc(db, 'careCircles', cId, 'tasks', `task_${task.id}`), {\r\n                ...task,\r\n                createdAt: serverTimestamp(),\r\n                completedAt: null,\r\n            });\r\n        }\r\n    } catch (err) {\r\n        console.error('Error initializing tasks:', err);\r\n    }\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\features\\thinkingOfYou\\ThinkingOfYou.tsx","messages":[{"ruleId":"@typescript-eslint/ban-ts-comment","severity":2,"message":"Use \"@ts-expect-error\" instead of \"@ts-ignore\", as \"@ts-ignore\" will do nothing if the following line is error-free.","line":4,"column":1,"nodeType":"Line","messageId":"tsIgnoreInsteadOfExpectError","endLine":4,"endColumn":46,"suggestions":[{"messageId":"replaceTsIgnoreWithTsExpectError","fix":{"range":[160,205],"text":"// @ts-expect-error - sounds util not converted yet"},"desc":"Replace \"@ts-ignore\" with \"@ts-expect-error\"."}]},{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\features\\thinkingOfYou\\ThinkingOfYou.tsx:138:13\n  136 |     useEffect(() => {\n  137 |         if (ping) {\n> 138 |             setIsVisible(true);\n      |             ^^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  139 |             playPingSound();\n  140 |\n  141 |             // Auto-dismiss after 5 seconds","line":138,"column":13,"nodeType":null,"endLine":138,"endColumn":25}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\r\nimport { Heart, Sparkles } from 'lucide-react';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\n// @ts-ignore - sounds util not converted yet\r\nimport { playPingSound } from '../../utils/sounds';\r\nimport { Avatar } from '../../components/ui/Avatar';\r\nimport { Ping } from '../../types';\r\n\r\ninterface FloatingHeart {\r\n    id: number;\r\n    x: number;\r\n    size: number;\r\n    duration: number;\r\n}\r\n\r\n// \"Thinking of you\" ping button - one-tap warmth without obligation\r\nexport const ThinkingOfYouButton: React.FC<{ onSendPing?: () => void, fromName?: string }> = ({ onSendPing }) => {\r\n    const [isSending, setIsSending] = useState(false);\r\n    const [floatingHearts, setFloatingHearts] = useState<FloatingHeart[]>([]);\r\n\r\n    const handleSend = () => {\r\n        setIsSending(true);\r\n        playPingSound();\r\n        onSendPing?.();\r\n\r\n        // Create 5 random floating hearts\r\n        const newHearts = Array.from({ length: 5 }).map((_, i) => ({\r\n            id: Date.now() + i,\r\n            x: Math.random() * 200 - 100, // Range -100 to 100\r\n            size: 15 + Math.random() * 15,\r\n            duration: 1.5 + Math.random() * 1.5\r\n        }));\r\n        setFloatingHearts(newHearts);\r\n\r\n        // Reset animation states\r\n        setTimeout(() => setIsSending(false), 2000);\r\n        setTimeout(() => setFloatingHearts([]), 3000);\r\n    };\r\n\r\n    return (\r\n        <div className=\"relative w-full\">\r\n            <AnimatePresence>\r\n                {floatingHearts.map(heart => (\r\n                    <motion.div\r\n                        key={heart.id}\r\n                        initial={{ opacity: 0, y: 0, x: 0 }}\r\n                        animate={{ opacity: 1, y: -200, x: heart.x }}\r\n                        exit={{ opacity: 0 }}\r\n                        transition={{ duration: heart.duration, ease: \"easeOut\" }}\r\n                        className=\"absolute left-1/2 top-0 pointer-events-none z-50\"\r\n                        style={{ marginLeft: -15 }}\r\n                    >\r\n                        <Heart\r\n                            className=\"text-pink-400 fill-pink-400\"\r\n                            size={heart.size}\r\n                        />\r\n                    </motion.div>\r\n                ))}\r\n            </AnimatePresence>\r\n\r\n            <button\r\n                onClick={handleSend}\r\n                disabled={isSending}\r\n                className={`\r\n                    w-full p-4 rounded-2xl border-2 transition-all duration-300\r\n                    flex items-center justify-center gap-3\r\n                    ${isSending\r\n                        ? 'bg-pink-100 border-pink-300 scale-95 shadow-inner'\r\n                        : 'bg-white border-pink-200 hover:border-pink-400 hover:bg-pink-50 active:scale-95 shadow-sm'\r\n                    }\r\n                `}\r\n            >\r\n                <div className={`relative ${isSending ? 'animate-celebrate' : ''}`}>\r\n                    <Heart\r\n                        className={`w-8 h-8 transition-all duration-300 ${isSending ? 'text-pink-500 fill-pink-500' : 'text-pink-400'}`}\r\n                    />\r\n                    {isSending && (\r\n                        <Sparkles className=\"absolute -top-1 -right-1 w-4 h-4 text-pink-400 animate-glow\" />\r\n                    )}\r\n                </div>\r\n                <span className={`font-semibold text-xl ${isSending ? 'text-pink-600' : 'text-pink-500'}`}>\r\n                    {isSending ? 'Sendt! 仇벒잺' : 'T칝nker p친 dig'}\r\n                </span>\r\n            </button>\r\n        </div>\r\n    );\r\n};\r\n\r\ninterface ThinkingOfYouIconButtonProps {\r\n    onSendPing?: () => void;\r\n}\r\n\r\n// Compact icon-only version for header placement\r\nexport const ThinkingOfYouIconButton: React.FC<ThinkingOfYouIconButtonProps> = ({ onSendPing }) => {\r\n    const [isSending, setIsSending] = useState(false);\r\n\r\n    const handleSend = () => {\r\n        setIsSending(true);\r\n        playPingSound();\r\n        onSendPing?.();\r\n        setTimeout(() => setIsSending(false), 1500);\r\n    };\r\n\r\n    return (\r\n        <button\r\n            onClick={handleSend}\r\n            disabled={isSending}\r\n            aria-label=\"Send k칝rlighed\"\r\n            className={`\r\n                p-2 rounded-full transition-all duration-300 relative\r\n                ${isSending\r\n                    ? 'bg-pink-200 scale-110'\r\n                    : 'bg-pink-50 hover:bg-pink-100 active:scale-95'\r\n                }\r\n            `}\r\n        >\r\n            <Heart\r\n                className={`w-5 h-5 transition-all duration-300 ${isSending ? 'text-pink-500 fill-pink-500' : 'text-pink-400'}`}\r\n            />\r\n            {isSending && (\r\n                <Sparkles className=\"absolute -top-1 -right-1 w-3 h-3 text-pink-400 animate-ping\" />\r\n            )}\r\n        </button>\r\n    );\r\n};\r\n\r\ninterface PingNotificationProps {\r\n    ping: Ping | null;\r\n    onDismiss?: () => void;\r\n}\r\n\r\n// Ping notification that appears in recipient's view\r\nexport const PingNotification: React.FC<PingNotificationProps> = ({ ping, onDismiss }) => {\r\n    const [isVisible, setIsVisible] = useState(false);\r\n\r\n    useEffect(() => {\r\n        if (ping) {\r\n            setIsVisible(true);\r\n            playPingSound();\r\n\r\n            // Auto-dismiss after 5 seconds\r\n            const timer = setTimeout(() => {\r\n                setIsVisible(false);\r\n                setTimeout(() => onDismiss?.(), 500); // Wait for fade-out\r\n            }, 5000);\r\n\r\n            return () => clearTimeout(timer);\r\n        }\r\n    }, [ping, onDismiss]);\r\n\r\n    if (!ping) return null;\r\n\r\n    return (\r\n        <div className={`\r\n            fixed top-20 left-4 right-4 z-50 transition-all duration-500\r\n            ${isVisible ? 'opacity-100 translate-y-0' : 'opacity-0 -translate-y-4'}\r\n        `}>\r\n            <div\r\n                onClick={() => { setIsVisible(false); setTimeout(() => onDismiss?.(), 300); }}\r\n                className=\"bg-gradient-to-r from-pink-500 to-rose-500 p-4 rounded-2xl shadow-xl text-white cursor-pointer\"\r\n            >\r\n                <div className=\"flex items-center gap-3\">\r\n                    <div className=\"bg-white/20 p-1 rounded-full\">\r\n                        <Avatar id={ping.fromName?.toLowerCase() || 'louise'} size=\"md\" className=\"border-2 border-white/50\" />\r\n                    </div>\r\n                    <div>\r\n                        <p className=\"font-bold\">\r\n                            {ping.message || `${ping.fromName} t칝nker p친 dig 仇벒잺`}\r\n                        </p>\r\n                        <p className=\"text-pink-100 text-sm\">\r\n                            {ping.sentAt?.toLocaleTimeString?.('da-DK', { hour: '2-digit', minute: '2-digit' })}\r\n                        </p>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default ThinkingOfYouButton;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\features\\thinkingOfYou\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\features\\thinkingOfYou\\usePings.ts","messages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\features\\thinkingOfYou\\usePings.ts:29:13\n  27 |     useEffect(() => {\n  28 |         if (!circleId) {\n> 29 |             setPings([]);\n     |             ^^^^^^^^ Avoid calling setState() directly within an effect\n  30 |             setLoading(false);\n  31 |             return;\n  32 |         }","line":29,"column":13,"nodeType":null,"endLine":29,"endColumn":21},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'latestPing'. Either include it or remove the dependency array.","line":87,"column":8,"nodeType":"ArrayExpression","endLine":87,"endColumn":33,"suggestions":[{"desc":"Update the dependencies array to be: [circleId, currentUserId, latestPing]","fix":{"range":[3031,3056],"text":"[circleId, currentUserId, latestPing]"}}]},{"ruleId":"react-hooks/preserve-manual-memoization","severity":2,"message":"Compilation Skipped: Existing memoization could not be preserved\n\nReact Compiler has skipped optimizing this component because the existing manual memoization could not be preserved. The inferred dependencies did not match the manually specified dependencies, which could cause the value to change more or less frequently than expected. The inferred dependency was `currentUserId`, but the source dependencies were [circleId]. Inferred different dependency than source.\n\nC:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\features\\thinkingOfYou\\usePings.ts:90:34\n   88 |\n   89 |     // Send a ping\n>  90 |     const sendPing = useCallback(async (toView: 'senior' | 'relative', type: string = 'thinking_of_you', message: string = '') => {\n      |                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n>  91 |         if (!circleId || !currentUserId) return;\n      | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n>  92 |\n      뵢n      | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 109 |         }\n      | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 110 |     }, [circleId]);\n      | ^^^^^^ Could not preserve existing manual memoization\n  111 |\n  112 |     // Dismiss latest ping\n  113 |     const dismissPing = useCallback(() => {","line":90,"column":34,"nodeType":null,"endLine":110,"endColumn":6},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":105,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":105,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3679,3682],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3679,3682],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 'currentUserId'. Either include it or remove the dependency array.","line":110,"column":8,"nodeType":"ArrayExpression","endLine":110,"endColumn":18,"suggestions":[{"desc":"Update the dependencies array to be: [circleId, currentUserId]","fix":{"range":[3821,3831],"text":"[circleId, currentUserId]"}}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\n// Pings hook - real-time \"thinking of you\" sync via Firestore\r\n// Syncs ping notifications across family circle members\r\n\r\nimport { useState, useEffect, useCallback } from 'react';\r\nimport {\r\n    collection,\r\n    doc,\r\n    setDoc,\r\n    onSnapshot,\r\n    serverTimestamp,\r\n    query,\r\n    orderBy,\r\n    limit\r\n} from 'firebase/firestore';\r\nimport { db } from '../../config/firebase';\r\n\r\nimport { Ping } from '../../types';\r\n\r\nexport function usePings(circleId: string | null, currentUserId: string | null) {\r\n    const [pings, setPings] = useState<Ping[]>([]);\r\n    const [latestPing, setLatestPing] = useState<Ping | null>(null);\r\n    const [loading, setLoading] = useState<boolean>(true);\r\n    const [error, setError] = useState<string | null>(null);\r\n\r\n    // Subscribe to recent pings from Firestore\r\n    useEffect(() => {\r\n        if (!circleId) {\r\n            setPings([]);\r\n            setLoading(false);\r\n            return;\r\n        }\r\n\r\n        const pingsRef = collection(db, 'careCircles', circleId, 'pings');\r\n\r\n        const pingsQuery = query(\r\n            pingsRef,\r\n            orderBy('sentAt', 'desc'),\r\n            limit(10)\r\n        );\r\n\r\n        const unsubscribe = onSnapshot(pingsQuery,\r\n            (snapshot) => {\r\n                const pingsList: Ping[] = snapshot.docs.map(doc => {\r\n                    const data = doc.data();\r\n                    // Convert Firestore timestamp to Date\r\n                    const sentAt = data.sentAt?.toDate?.() || new Date();\r\n\r\n                    return {\r\n                        id: doc.id,\r\n                        fromName: data.fromName,\r\n                        fromUserId: data.fromUserId,\r\n                        toRole: data.toRole as 'senior' | 'relative',\r\n                        sentAt,\r\n                        toUserId: data.toUserId,\r\n                        type: data.type,\r\n                        message: data.message\r\n                    };\r\n                });\r\n\r\n                setPings(pingsList);\r\n\r\n                // Set latest ping if it's for this user and recent (within last minute)\r\n                const now = new Date();\r\n                const recentPing = pingsList.find(p => {\r\n                    const pingAge = now.getTime() - p.sentAt.getTime();\r\n                    const isRecent = pingAge < 60000; // Within last minute\r\n                    // const isForMe = p.toUserId !== currentUserId && p.fromUserId !== currentUserId;\r\n                    const isFromOther = p.fromUserId !== currentUserId;\r\n                    return isRecent && isFromOther;\r\n                });\r\n\r\n                if (recentPing && (!latestPing || recentPing.id !== latestPing.id)) {\r\n                    setLatestPing(recentPing);\r\n                }\r\n\r\n                setLoading(false);\r\n            },\r\n            (err) => {\r\n                console.error('Error fetching pings:', err);\r\n                setError(err.message);\r\n                setLoading(false);\r\n            }\r\n        );\r\n\r\n        return () => unsubscribe();\r\n    }, [circleId, currentUserId]);\r\n\r\n    // Send a ping\r\n    const sendPing = useCallback(async (toView: 'senior' | 'relative', type: string = 'thinking_of_you', message: string = '') => {\r\n        if (!circleId || !currentUserId) return;\r\n\r\n        const pingId = `ping_${Date.now()}`;\r\n        const pingRef = doc(db, 'careCircles', circleId, 'pings', pingId);\r\n\r\n        try {\r\n            await setDoc(pingRef, {\r\n                fromUserId: currentUserId,\r\n                toRole: toView,\r\n                sentAt: serverTimestamp(),\r\n                type,\r\n                message\r\n            });\r\n            return pingId;\r\n        } catch (err: any) {\r\n            console.error('Error sending ping:', err);\r\n            setError(err.message);\r\n            throw err;\r\n        }\r\n    }, [circleId]);\r\n\r\n    // Dismiss latest ping\r\n    const dismissPing = useCallback(() => {\r\n        setLatestPing(null);\r\n    }, []);\r\n\r\n    return {\r\n        pings,\r\n        latestPing,\r\n        loading,\r\n        error,\r\n        sendPing,\r\n        dismissPing,\r\n    };\r\n}\r\n\r\nexport default usePings;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\features\\visualizations\\FamilyTree.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\features\\weeklyQuestion\\WeeklyQuestion.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\features\\weeklyQuestion\\WeeklyQuestionWidget.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'e' is defined but never used.","line":24,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":24,"endColumn":15},{"ruleId":null,"message":"Unused eslint-disable directive (no problems were reported from 'react-refresh/only-export-components').","line":37,"column":1,"severity":1,"nodeType":null,"fix":{"range":[1462,1526],"text":" "}},{"ruleId":null,"message":"Unused eslint-disable directive (no problems were reported from 'react-refresh/only-export-components').","line":75,"column":1,"severity":1,"nodeType":null,"fix":{"range":[3181,3245],"text":" "}}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":2,"source":"import React, { useState } from 'react';\r\nimport { MessageCircle, X, Check, Heart, MessageSquare, Send, Sparkles, Loader2, Mic, Play as PlayIcon } from 'lucide-react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { WEEKLY_QUESTIONS, getWeekNumber } from './constants';\r\nimport { WeeklyAnswer, WeeklyReply, Member, FirestoreDate } from '../../types';\r\nimport { AudioRecorder } from '../memories/AudioRecorder';\r\nimport { toJsDate } from '../../utils/dateUtils';\r\nimport { TFunction } from 'i18next';\r\n\r\n// Simple time ago formatter (no external deps)\r\nconst formatTimeAgo = (isoString: FirestoreDate | undefined, t: TFunction) => {\r\n    if (!isoString) return '';\r\n    try {\r\n        const date = toJsDate(isoString);\r\n        if (!date) return '';\r\n\r\n        const now = new Date();\r\n        const diffInSeconds = Math.floor((now.getTime() - date.getTime()) / 1000);\r\n\r\n        if (diffInSeconds < 60) return t('just_now');\r\n        if (diffInSeconds < 3600) return t('minutes_ago', { count: Math.floor(diffInSeconds / 60) });\r\n        if (diffInSeconds < 86400) return t('hours_ago', { count: Math.floor(diffInSeconds / 3600) });\r\n        return t('days_ago_relative', { count: Math.floor(diffInSeconds / 86400) });\r\n    } catch (e) {\r\n        return '';\r\n    }\r\n};\r\n\r\ninterface WeeklyQuestionWidgetProps {\r\n    answers?: WeeklyAnswer[];\r\n    userName: string;\r\n    hasUnread?: boolean;\r\n    onClick: () => void;\r\n}\r\n\r\n// Compact widget for header\r\n// eslint-disable-next-line react-refresh/only-export-components\r\nexport const WeeklyQuestionWidget: React.FC<WeeklyQuestionWidgetProps> = ({ answers = [], userName, hasUnread = false, onClick }) => {\r\n    const { t } = useTranslation();\r\n    const weekNumber = getWeekNumber();\r\n    const questionKey = WEEKLY_QUESTIONS[weekNumber % WEEKLY_QUESTIONS.length];\r\n    const answersThisWeek = answers.filter(a => a.questionId === questionKey);\r\n    const unreadCount = hasUnread ? answersThisWeek.filter(a => a.userName !== userName).length : 0;\r\n\r\n    return (\r\n        <button\r\n            onClick={onClick}\r\n            className=\"relative bg-indigo-100 p-1.5 rounded-full hover:bg-indigo-200 transition-colors flex items-center justify-center shrink-0\"\r\n            aria-label={t('open_weekly_question')}\r\n            style={{ width: '36px', height: '36px' }}\r\n        >\r\n            <MessageCircle className=\"w-5 h-5 text-indigo-600\" />\r\n            {unreadCount > 0 && (\r\n                <span className=\"absolute -top-1 -right-1 w-4 h-4 bg-red-500 text-white text-[10px] font-bold rounded-full flex items-center justify-center border border-white\">\r\n                    {unreadCount}\r\n                </span>\r\n            )}\r\n        </button>\r\n    );\r\n};\r\n\r\ninterface WeeklyQuestionModalProps {\r\n    isOpen: boolean;\r\n    onClose: () => void;\r\n    answers?: WeeklyAnswer[];\r\n    onAnswer?: (answer: Omit<WeeklyAnswer, 'id'>) => void;\r\n    userName: string;\r\n    currentUserId?: string;\r\n    onToggleLike?: (answerId: string, userId: string, isLiked: boolean) => void;\r\n    onReply?: (answerId: string, reply: Omit<WeeklyReply, 'id'>) => void;\r\n    members?: Member[];\r\n}\r\n\r\n// Full modal for answering and viewing\r\n// eslint-disable-next-line react-refresh/only-export-components\r\nexport const WeeklyQuestionModal: React.FC<WeeklyQuestionModalProps> = ({\r\n    isOpen,\r\n    onClose,\r\n    answers = [],\r\n    onAnswer,\r\n    userName,\r\n    currentUserId,\r\n    onToggleLike,\r\n    onReply,\r\n    members = []\r\n}) => {\r\n    const [myAnswer, setMyAnswer] = useState('');\r\n    const [replyText, setReplyText] = useState('');\r\n    const [replyingToId, setReplyingToId] = useState<string | null>(null);\r\n    const [answerType, setAnswerType] = useState<'text' | 'audio'>('text');\r\n    const [audioBlob, setAudioBlob] = useState<Blob | null>(null);\r\n    const { t } = useTranslation();\r\n    const [isUploading] = useState(false); // Local state since audio upload isn't implemented yet\r\n\r\n    const weekNumber = getWeekNumber();\r\n    const questionKey = WEEKLY_QUESTIONS[weekNumber % WEEKLY_QUESTIONS.length];\r\n    const question = t(questionKey);\r\n\r\n    // Filter answers for this week's question\r\n    const answersThisWeek = answers.filter(a => a.questionId === questionKey);\r\n    const hasAnsweredThisWeek = answersThisWeek.some(a => a.userName === userName);\r\n\r\n    // Logic for Strict Barrier\r\n    // Count ALL members (Senior + Relatives) as participants\r\n    const participants = members;\r\n    const totalParticipants = participants.length;\r\n\r\n    // Count unique users who answered\r\n    const uniqueAnswerers = new Set(answersThisWeek.map(a => a.userId)).size;\r\n\r\n    // If we have members data, enforce the barrier.\r\n    const allAnswered = totalParticipants > 0 ? uniqueAnswerers >= totalParticipants : true;\r\n\r\n\r\n    // Sorting: Popularity (likes) -> Newest\r\n    const sortedAnswers = [...answersThisWeek].sort((a, b) => {\r\n        const likesA = a.likes?.length || 0;\r\n        const likesB = b.likes?.length || 0;\r\n        if (likesA !== likesB) return likesB - likesA; // Most likes first\r\n        // Fallback to time if available (newest first)\r\n        const timeA = toJsDate(a.answeredAt)?.getTime() || 0;\r\n        const timeB = toJsDate(b.answeredAt)?.getTime() || 0;\r\n        return timeB - timeA;\r\n    });\r\n\r\n    const handleSubmit = async () => {\r\n        if (answerType === 'text' && myAnswer.trim()) {\r\n            onAnswer?.({\r\n                questionId: questionKey,\r\n                text: myAnswer.trim(),\r\n                answeredAt: new Date(),\r\n                userName\r\n            });\r\n            setMyAnswer('');\r\n        } else if (answerType === 'audio' && audioBlob) {\r\n            // Audio submission logic will be handled here\r\n            onAnswer?.({\r\n                questionId: questionKey,\r\n                text: t('audio_answer_placeholder'),\r\n                answeredAt: new Date(),\r\n                userName\r\n            });\r\n            setAudioBlob(null);\r\n        }\r\n    };\r\n\r\n    const handleReplySubmit = (answerId: string) => {\r\n        if (!replyText.trim() || !currentUserId) return;\r\n\r\n        onReply?.(answerId, {\r\n            userId: currentUserId,\r\n            userName: userName,\r\n            text: replyText.trim(),\r\n            createdAt: new Date().toISOString()\r\n        });\r\n        setReplyText('');\r\n        setReplyingToId(null);\r\n    };\r\n\r\n    const toggleReplyInput = (answerId: string) => {\r\n        if (replyingToId === answerId) {\r\n            setReplyingToId(null);\r\n        } else {\r\n            setReplyingToId(answerId);\r\n            setReplyText('');\r\n        }\r\n    };\r\n\r\n    if (!isOpen) return null;\r\n\r\n    return (\r\n        <div className=\"fixed inset-0 bg-black/50 z-50 flex items-end justify-center animate-fade-in pb-0 sm:pb-0\">\r\n            <div className=\"bg-white w-full max-w-md rounded-t-[2.5rem] h-[85vh] flex flex-col animate-slide-up shadow-[0_-10px_40px_-15px_rgba(0,0,0,0.3)] safe-area-bottom\">\r\n                {/* Drag Handle Indicator */}\r\n                <div className=\"w-full flex justify-center pt-3 pb-1\" onTouchStart={onClose}>\r\n                    <div className=\"w-12 h-1.5 bg-stone-200 rounded-full\" />\r\n                </div>\r\n                <div className=\"flex items-center justify-between p-4 border-b border-stone-200\">\r\n                    <div className=\"flex items-center gap-2\">\r\n                        <div className=\"bg-indigo-100 p-2 rounded-full\">\r\n                            <MessageCircle className=\"w-5 h-5 text-indigo-600\" />\r\n                        </div>\r\n                        <span className=\"font-bold text-stone-800\">{t('weekly_question_title')}</span>\r\n                    </div>\r\n                    <button onClick={onClose} className=\"p-2 hover:bg-stone-100 rounded-full\">\r\n                        <X className=\"w-6 h-6 text-stone-500\" />\r\n                    </button>\r\n                </div>\r\n\r\n                {/* Content */}\r\n                <div className=\"flex-1 overflow-y-auto p-4 space-y-4 pb-20\">\r\n                    {/* Question */}\r\n                    <div className=\"bg-gradient-to-br from-indigo-500 to-purple-600 rounded-2xl p-6 text-white shadow-lg\">\r\n                        <p className=\"text-indigo-200 text-sm mb-2 uppercase tracking-wide font-bold\">{t('weekly_question_header')}</p>\r\n                        <p className=\"text-xl font-bold leading-relaxed\">{question}</p>\r\n                    </div>\r\n\r\n                    {/* Answer input (only if not answered) */}\r\n                    {!hasAnsweredThisWeek ? (\r\n                        <div className=\"space-y-4 animate-fade-in\">\r\n                            {/* Toggle between text and audio */}\r\n                            <div className=\"flex bg-stone-100 p-1 rounded-2xl\">\r\n                                <button\r\n                                    onClick={() => setAnswerType('text')}\r\n                                    className={`flex-1 py-3 rounded-xl font-bold transition-all ${answerType === 'text' ? 'bg-white shadow-sm text-indigo-600' : 'text-stone-500'}`}\r\n                                >\r\n                                    <div className=\"flex items-center justify-center gap-2\">\r\n                                        <MessageSquare className=\"w-4 h-4\" />\r\n                                        {t('text_answer')}\r\n                                    </div>\r\n                                </button>\r\n                                <button\r\n                                    onClick={() => setAnswerType('audio')}\r\n                                    className={`flex-1 py-3 rounded-xl font-bold transition-all ${answerType === 'audio' ? 'bg-white shadow-sm text-indigo-600' : 'text-stone-500'}`}\r\n                                >\r\n                                    <div className=\"flex items-center justify-center gap-2\">\r\n                                        <Mic className=\"w-4 h-4\" />\r\n                                        {t('audio_answer')}\r\n                                    </div>\r\n                                </button>\r\n                            </div>\r\n\r\n                            <div className=\"relative\">\r\n                                {answerType === 'text' ? (\r\n                                    <textarea\r\n                                        value={myAnswer}\r\n                                        onChange={(e) => setMyAnswer(e.target.value)}\r\n                                        placeholder={t('write_answer_placeholder')}\r\n                                        className=\"w-full p-4 rounded-2xl border-2 border-stone-200 focus:border-indigo-400 focus:outline-none resize-none h-32 text-lg shadow-sm\"\r\n                                    />\r\n                                ) : (\r\n                                    <AudioRecorder\r\n                                        onRecordingComplete={(blob) => setAudioBlob(blob)}\r\n                                        onReset={() => setAudioBlob(null)}\r\n                                        placeholder={t('tell_your_story_placeholder')}\r\n                                    />\r\n                                )}\r\n                            </div>\r\n                            <button\r\n                                onClick={handleSubmit}\r\n                                disabled={answerType === 'text' ? !myAnswer.trim() : (!audioBlob || isUploading)}\r\n                                className=\"w-full p-4 bg-indigo-600 text-white font-bold rounded-2xl hover:bg-indigo-700 transition-colors flex items-center justify-center gap-2 disabled:opacity-50 shadow-md active:scale-95 transform transition-transform\"\r\n                            >\r\n                                {isUploading ? (\r\n                                    <Loader2 className=\"w-5 h-5 animate-spin\" />\r\n                                ) : (\r\n                                    <Sparkles className=\"w-5 h-5\" />\r\n                                )}\r\n                                {isUploading ? t('uploading') : t('share_your_answer')}\r\n                            </button>\r\n                        </div>\r\n                    ) : (\r\n                        <div className=\"bg-green-50 border border-green-200 rounded-xl p-3 text-center mb-4 flex items-center justify-center gap-2\">\r\n                            <div className=\"bg-green-100 p-1 rounded-full\">\r\n                                <Check className=\"w-4 h-4 text-green-700\" />\r\n                            </div>\r\n                            <p className=\"text-green-700 font-medium\">{t('thanks_for_answer')}</p>\r\n                        </div>\r\n                    )}\r\n\r\n                    {/* All Answers Feed - STRICT BARRIER */}\r\n                    <div className=\"space-y-4\">\r\n                        {!allAnswered && hasAnsweredThisWeek ? (\r\n                            <div className=\"bg-stone-50 rounded-2xl p-6 text-center border-2 border-stone-100 border-dashed animate-fade-in\">\r\n                                <div className=\"bg-indigo-100 w-12 h-12 rounded-full flex items-center justify-center mx-auto mb-3\">\r\n                                    <Sparkles className=\"w-6 h-6 text-indigo-500\" />\r\n                                </div>\r\n                                <h3 className=\"text-lg font-bold text-stone-700 mb-1\">{t('waiting_for_family')}</h3>\r\n                                <p className=\"text-stone-500 mb-4\">{t('waiting_for_family_desc', { count: totalParticipants - uniqueAnswerers })}</p>\r\n                                <div className=\"w-full bg-stone-200 rounded-full h-2 overflow-hidden\">\r\n                                    <div\r\n                                        className=\"bg-indigo-500 h-full transition-all duration-1000\"\r\n                                        style={{ width: `${(uniqueAnswerers / totalParticipants) * 100}%` }}\r\n                                    />\r\n                                </div>\r\n                                <p className=\"text-xs font-bold text-indigo-600 mt-2 text-right\">\r\n                                    {uniqueAnswerers} / {totalParticipants} {t('answers')}\r\n                                </p>\r\n                            </div>\r\n                        ) : sortedAnswers.length > 0 ? (\r\n                            <>\r\n                                <p className=\"text-stone-500 text-sm font-bold ml-1 uppercase tracking-wide\">{t('family_answers_count', { count: sortedAnswers.length })}</p>\r\n                                {sortedAnswers.map((answer) => {\r\n                                    const isLiked = currentUserId && answer.likes?.includes(currentUserId);\r\n                                    const likeCount = answer.likes?.length || 0;\r\n                                    const isReplying = replyingToId === answer.id;\r\n\r\n                                    return (\r\n                                        <div key={answer.id} className=\"bg-white rounded-2xl p-4 border border-stone-200 shadow-sm transition-all hover:shadow-md\">\r\n                                            {/* Answer Header */}\r\n                                            <div className=\"flex justify-between items-start mb-2\">\r\n                                                <div>\r\n                                                    <p className=\"font-bold text-stone-800 text-lg\">{answer.userName}</p>\r\n                                                    {answer.answeredAt && (\r\n                                                        <p className=\"text-xs text-stone-400\">\r\n                                                            {formatTimeAgo(answer.answeredAt, t)}\r\n                                                        </p>\r\n                                                    )}\r\n                                                </div>\r\n                                                {/* Like Button */}\r\n                                                <button\r\n                                                    onClick={() => currentUserId && onToggleLike?.(answer.id, currentUserId, !!isLiked)}\r\n                                                    className={`flex items-center gap-1 px-3 py-1.5 rounded-full transition-colors ${isLiked\r\n                                                        ? 'bg-rose-50 text-rose-600'\r\n                                                        : 'bg-stone-50 text-stone-500 hover:bg-stone-100'\r\n                                                        }`}\r\n                                                >\r\n                                                    <Heart className={`w-4 h-4 ${isLiked ? 'fill-rose-500' : ''}`} />\r\n                                                    <span className=\"text-sm font-bold\">{likeCount > 0 ? likeCount : ''}</span>\r\n                                                </button>\r\n                                            </div>\r\n\r\n                                            {/* Answer Text */}\r\n                                            {answer.audioUrl ? (\r\n                                                <div className=\"mb-4 bg-stone-50 p-3 rounded-xl border border-stone-100 flex items-center gap-3\">\r\n                                                    <button\r\n                                                        onClick={() => new Audio(answer.audioUrl).play()}\r\n                                                        className=\"w-10 h-10 bg-indigo-100 flex items-center justify-center rounded-full text-indigo-600 hover:bg-indigo-200\"\r\n                                                    >\r\n                                                        <PlayIcon size={20} fill=\"currentColor\" />\r\n                                                    </button>\r\n                                                    <div className=\"flex-1 h-1 bg-stone-200 rounded-full\" />\r\n                                                    <Mic size={16} className=\"text-stone-300\" />\r\n                                                </div>\r\n                                            ) : (\r\n                                                <p className=\"text-stone-700 text-lg leading-relaxed mb-4\">{answer.text}</p>\r\n                                            )}\r\n\r\n                                            {/* Action Bar */}\r\n                                            <div className=\"flex items-center gap-4 border-t border-stone-100 pt-3\">\r\n                                                <button\r\n                                                    onClick={() => toggleReplyInput(answer.id)}\r\n                                                    className=\"flex items-center gap-2 text-stone-500 hover:text-indigo-600 transition-colors text-sm font-medium\"\r\n                                                >\r\n                                                    <MessageSquare className=\"w-4 h-4\" />\r\n                                                    {answer.replies?.length ? t('replies_count', { count: answer.replies.length }) : t('reply_verb')}\r\n                                                </button>\r\n                                            </div>\r\n\r\n                                            {/* Replies Section */}\r\n                                            {(isReplying || (answer.replies && answer.replies.length > 0)) && (\r\n                                                <div className=\"mt-3 pl-4 border-l-2 border-stone-100 space-y-3\">\r\n                                                    {/* Existing Replies */}\r\n                                                    {answer.replies?.map((reply) => (\r\n                                                        <div key={reply.id} className=\"bg-stone-50 rounded-lg p-3 text-sm\">\r\n                                                            <div className=\"flex justify-between items-baseline mb-1\">\r\n                                                                <span className=\"font-bold text-stone-700\">{reply.userName}</span>\r\n                                                                {/* <span className=\"text-xs text-stone-400\">tid siden</span> */}\r\n                                                            </div>\r\n                                                            <p className=\"text-stone-600\">{reply.text}</p>\r\n                                                        </div>\r\n                                                    ))}\r\n\r\n                                                    {/* Reply Input */}\r\n                                                    {isReplying && (\r\n                                                        <div className=\"flex gap-2 items-end animate-fade-in mt-2\">\r\n                                                            <textarea\r\n                                                                value={replyText}\r\n                                                                onChange={(e) => setReplyText(e.target.value)}\r\n                                                                placeholder={t('write_reply_placeholder')}\r\n                                                                className=\"flex-1 bg-stone-50 border border-stone-200 rounded-xl p-2 text-sm focus:border-indigo-400 focus:outline-none resize-none h-20\"\r\n                                                                autoFocus\r\n                                                            />\r\n                                                            <button\r\n                                                                onClick={() => handleReplySubmit(answer.id)}\r\n                                                                disabled={!replyText.trim()}\r\n                                                                className=\"p-2 bg-indigo-600 text-white rounded-full hover:bg-indigo-700 disabled:opacity-50 shadow-sm\"\r\n                                                            >\r\n                                                                <Send className=\"w-4 h-4\" />\r\n                                                            </button>\r\n                                                        </div>\r\n                                                    )}\r\n                                                </div>\r\n                                            )}\r\n                                        </div>\r\n                                    );\r\n                                })}\r\n                            </>\r\n                        ) : (\r\n                            <div className=\"text-center py-8 text-stone-400\">\r\n                                <p>{t('no_answers_yet')}</p>\r\n                            </div>\r\n                        )}\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default WeeklyQuestionModal;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\features\\weeklyQuestion\\constants.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\features\\weeklyQuestion\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\features\\weeklyQuestion\\useWeeklyQuestions.ts","messages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\features\\weeklyQuestion\\useWeeklyQuestions.ts:31:13\n  29 |     useEffect(() => {\n  30 |         if (!circleId) {\n> 31 |             setAnswers([]);\n     |             ^^^^^^^^^^ Avoid calling setState() directly within an effect\n  32 |             setLoading(false);\n  33 |             return;\n  34 |         }","line":31,"column":13,"nodeType":null,"endLine":31,"endColumn":23},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":48,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":48,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1491,1494],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1491,1494],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":71,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":71,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2220,2223],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2220,2223],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\n// Weekly Questions hook - real-time sync via Firestore\r\n// Syncs weekly question answers across family circle members\r\n\r\nimport { useState, useEffect, useCallback } from 'react';\r\nimport {\r\n    collection,\r\n    doc,\r\n    setDoc,\r\n    onSnapshot,\r\n    serverTimestamp,\r\n    query,\r\n    orderBy,\r\n    limit,\r\n    updateDoc,\r\n    arrayUnion,\r\n    arrayRemove\r\n} from 'firebase/firestore';\r\nimport { db } from '../../config/firebase';\r\n\r\nimport { WeeklyAnswer, WeeklyReply } from '../../types';\r\n\r\nexport function useWeeklyQuestions(circleId: string | null) {\r\n    const [answers, setAnswers] = useState<WeeklyAnswer[]>([]);\r\n    const [loading, setLoading] = useState<boolean>(true);\r\n    const [error, setError] = useState<string | null>(null);\r\n\r\n    // Subscribe to weekly answers from Firestore\r\n    useEffect(() => {\r\n        if (!circleId) {\r\n            setAnswers([]);\r\n            setLoading(false);\r\n            return;\r\n        }\r\n\r\n        const answersRef = collection(db, 'careCircles', circleId, 'weeklyAnswers');\r\n        const answersQuery = query(answersRef, orderBy('answeredAt', 'desc'), limit(20));\r\n\r\n        const unsubscribe = onSnapshot(answersQuery,\r\n            (snapshot) => {\r\n                const answersList = snapshot.docs.map(doc => ({\r\n                    id: doc.id,\r\n                    ...doc.data()\r\n                })) as WeeklyAnswer[];\r\n                setAnswers(answersList);\r\n                setLoading(false);\r\n            },\r\n            (err: any) => {\r\n                console.error('Error fetching weekly answers:', err);\r\n                setError(err.message);\r\n                setLoading(false);\r\n            }\r\n        );\r\n\r\n        return () => unsubscribe();\r\n    }, [circleId]);\r\n\r\n    // Add new answer\r\n    const addAnswer = useCallback(async (answerData: Partial<WeeklyAnswer>) => {\r\n        if (!circleId) return;\r\n\r\n        const answerId = `answer_${Date.now()}`;\r\n        const answerRef = doc(db, 'careCircles', circleId, 'weeklyAnswers', answerId);\r\n\r\n        try {\r\n            await setDoc(answerRef, {\r\n                ...answerData,\r\n                answeredAt: serverTimestamp(),\r\n            });\r\n            return answerId;\r\n        } catch (err: any) {\r\n            console.error('Error adding weekly answer:', err);\r\n            setError(err.message);\r\n            throw err;\r\n        }\r\n    }, [circleId]);\r\n\r\n    // Toggle Like\r\n    const toggleLike = useCallback(async (answerId: string, userId: string, isLiked: boolean) => {\r\n        if (!circleId) return;\r\n        const answerRef = doc(db, 'careCircles', circleId, 'weeklyAnswers', answerId);\r\n        try {\r\n            await updateDoc(answerRef, {\r\n                likes: isLiked ? arrayRemove(userId) : arrayUnion(userId)\r\n            });\r\n        } catch (err) {\r\n            console.error('Error toggling like:', err);\r\n        }\r\n    }, [circleId]);\r\n\r\n    // Add Reply\r\n    const addReply = useCallback(async (answerId: string, reply: Omit<WeeklyReply, 'id'>) => {\r\n        if (!circleId) return;\r\n        const answerRef = doc(db, 'careCircles', circleId, 'weeklyAnswers', answerId);\r\n        const newReply: WeeklyReply = {\r\n            id: `reply_${Date.now()}`,\r\n            ...reply\r\n        };\r\n\r\n        try {\r\n            await updateDoc(answerRef, {\r\n                replies: arrayUnion(newReply)\r\n            });\r\n        } catch (err) {\r\n            console.error('Error adding reply:', err);\r\n        }\r\n    }, [circleId]);\r\n\r\n    return {\r\n        answers,\r\n        loading,\r\n        error,\r\n        addAnswer,\r\n        toggleLike,\r\n        addReply\r\n    };\r\n}\r\n\r\nexport default useWeeklyQuestions;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\features\\wordGame\\Leaderboard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\features\\wordGame\\Spillehjoernet.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\features\\wordGame\\WordGame.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\features\\wordGame\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\features\\wordGame\\useWordGame.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\hooks\\useAuth.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\hooks\\useCareCircle.ts","messages":[],"suppressedMessages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'_userProfile' is defined but never used.","line":33,"column":59,"nodeType":null,"messageId":"unusedVar","endLine":33,"endColumn":71,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\hooks\\useCheckIn.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\hooks\\useCircadianTheme.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\hooks\\useLocalStorage.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\hooks\\useScrollLock.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\hooks\\useSettings.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\i18n.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\lib\\utils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\main.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\test\\components.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\test\\features.test.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'key' is defined but never used. Allowed unused args must match /^_/u.","line":12,"column":44,"nodeType":null,"messageId":"unusedVar","endLine":12,"endColumn":47},{"ruleId":"@typescript-eslint/ban-ts-comment","severity":2,"message":"Use \"@ts-expect-error\" instead of \"@ts-ignore\", as \"@ts-ignore\" will do nothing if the following line is error-free.","line":24,"column":9,"nodeType":"Line","messageId":"tsIgnoreInsteadOfExpectError","endLine":24,"endColumn":58,"suggestions":[{"messageId":"replaceTsIgnoreWithTsExpectError","fix":{"range":[866,915],"text":"// @ts-expect-error - Testing fallback for unknown keys"},"desc":"Replace \"@ts-ignore\" with \"@ts-expect-error\"."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// Tests for feature flags\r\nimport { describe, it, expect } from 'vitest'\r\nimport { FEATURES, isFeatureEnabled } from '../config/features'\r\n\r\ndescribe('Feature Flags', () => {\r\n    it('FEATURES object exists and has expected structure', () => {\r\n        expect(FEATURES).toBeDefined()\r\n        expect(typeof FEATURES).toBe('object')\r\n    })\r\n\r\n    it('all feature values are booleans', () => {\r\n        Object.entries(FEATURES).forEach(([key, value]) => {\r\n            expect(typeof value).toBe('boolean')\r\n        })\r\n    })\r\n\r\n    it('isFeatureEnabled returns correct value for existing features', () => {\r\n        Object.entries(FEATURES).forEach(([key, value]) => {\r\n            expect(isFeatureEnabled(key as keyof typeof FEATURES)).toBe(value)\r\n        })\r\n    })\r\n\r\n    it('isFeatureEnabled returns true for unknown features (safe default)', () => {\r\n        // @ts-ignore - Testing fallback for unknown keys\r\n        expect(isFeatureEnabled('unknownFeature')).toBe(true)\r\n    })\r\n\r\n    it('critical features are defined', () => {\r\n        // These features must exist - breaking if removed\r\n        const criticalFeatures = [\r\n            'tabbedLayout',\r\n            'thinkingOfYou',\r\n            'weeklyQuestion',\r\n            'helpExchange',\r\n            'familyStatusCard'\r\n        ]\r\n\r\n        criticalFeatures.forEach(feature => {\r\n            expect(FEATURES).toHaveProperty(feature)\r\n        })\r\n    })\r\n})\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\test\\hooks.test.ts","messages":[{"ruleId":"@typescript-eslint/ban-ts-comment","severity":2,"message":"Use \"@ts-expect-error\" instead of \"@ts-ignore\", as \"@ts-ignore\" will do nothing if the following line is error-free.","line":23,"column":9,"nodeType":"Line","messageId":"tsIgnoreInsteadOfExpectError","endLine":23,"endColumn":22,"suggestions":[{"messageId":"replaceTsIgnoreWithTsExpectError","fix":{"range":[632,645],"text":"// @ts-expect-error"},"desc":"Replace \"@ts-ignore\" with \"@ts-expect-error\"."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// P1 Hook Tests - Core functionality verification\r\n// Tests for useMemberStatus, useHelpExchange, useTasks\r\n\r\nimport { describe, it, expect, vi } from 'vitest'\r\nimport { renderHook } from '@testing-library/react'\r\n\r\n// Mock Firebase\r\nvi.mock('../config/firebase', () => ({\r\n    db: {},\r\n    auth: { currentUser: { uid: 'test-user' } },\r\n    storage: {}\r\n}))\r\n\r\n// Mock Firestore functions\r\nvi.mock('firebase/firestore', () => ({\r\n    collection: vi.fn(),\r\n    doc: vi.fn(),\r\n    query: vi.fn(),\r\n    orderBy: vi.fn(),\r\n    limit: vi.fn(),\r\n    onSnapshot: vi.fn((_query, callback) => {\r\n        // Simulate empty snapshot\r\n        // @ts-ignore\r\n        callback({ docs: [] })\r\n        return vi.fn() // unsubscribe\r\n    }),\r\n    setDoc: vi.fn(() => Promise.resolve()),\r\n    deleteDoc: vi.fn(() => Promise.resolve()),\r\n    serverTimestamp: vi.fn(() => new Date()),\r\n    Timestamp: { now: vi.fn(() => ({ toDate: () => new Date() })) }\r\n}))\r\n\r\ndescribe('useMemberStatus Hook', () => {\r\n    it('can be imported without error', async () => {\r\n        const { useMemberStatus } = await import('../features/familyPresence')\r\n        expect(useMemberStatus).toBeDefined()\r\n        expect(typeof useMemberStatus).toBe('function')\r\n    })\r\n\r\n    it('returns expected shape with empty data', async () => {\r\n        const { useMemberStatus } = await import('../features/familyPresence')\r\n\r\n        const { result } = renderHook(() =>\r\n            useMemberStatus('circle123', 'user123', 'TestUser', 'relative')\r\n        )\r\n\r\n        // Should return the expected object shape\r\n        expect(result.current).toHaveProperty('memberStatuses')\r\n        expect(result.current).toHaveProperty('myStatus')\r\n        expect(result.current).toHaveProperty('setMyStatus')\r\n        expect(result.current).toHaveProperty('relativeStatuses')\r\n        expect(result.current).toHaveProperty('seniorStatus')\r\n    })\r\n\r\n    it('handles null circleId gracefully', async () => {\r\n        const { useMemberStatus } = await import('../features/familyPresence')\r\n\r\n        const { result } = renderHook(() =>\r\n            useMemberStatus(null, 'user123', 'TestUser', 'relative')\r\n        )\r\n\r\n        expect(result.current.memberStatuses).toEqual([])\r\n        expect(result.current.myStatus).toBe('home')\r\n    })\r\n})\r\n\r\ndescribe('useHelpExchange Hook', () => {\r\n    it('can be imported without error', async () => {\r\n        const { useHelpExchange } = await import('../features/helpExchange')\r\n        expect(useHelpExchange).toBeDefined()\r\n    })\r\n\r\n    it('returns expected shape', async () => {\r\n        const { useHelpExchange } = await import('../features/helpExchange')\r\n\r\n        const { result } = renderHook(() =>\r\n            useHelpExchange('circle123', 'user123', 'relative', 'TestUser')\r\n        )\r\n\r\n        expect(result.current).toHaveProperty('helpOffers')\r\n        expect(result.current).toHaveProperty('helpRequests')\r\n        expect(result.current).toHaveProperty('addOffer')\r\n        expect(result.current).toHaveProperty('addRequest')\r\n        expect(result.current).toHaveProperty('removeOffer')\r\n        expect(result.current).toHaveProperty('removeRequest')\r\n    })\r\n\r\n    it('handles null circleId gracefully', async () => {\r\n        const { useHelpExchange } = await import('../features/helpExchange')\r\n\r\n        const { result } = renderHook(() =>\r\n            useHelpExchange(null, 'user123', 'relative', 'TestUser')\r\n        )\r\n\r\n        expect(result.current.helpOffers).toEqual([])\r\n        expect(result.current.helpRequests).toEqual([])\r\n    })\r\n})\r\n\r\ndescribe('useTasks Hook', () => {\r\n    it('can be imported without error', async () => {\r\n        const { useTasks } = await import('../features/tasks')\r\n        expect(useTasks).toBeDefined()\r\n    })\r\n\r\n    it('returns expected shape', async () => {\r\n        const { useTasks } = await import('../features/tasks')\r\n\r\n        const { result } = renderHook(() => useTasks('circle123'))\r\n\r\n        expect(result.current).toHaveProperty('tasks')\r\n        expect(result.current).toHaveProperty('toggleTask')\r\n        expect(result.current).toHaveProperty('addTask')\r\n        expect(Array.isArray(result.current.tasks)).toBe(true)\r\n    })\r\n\r\n    it('falls back to INITIAL_TASKS when no circleId', async () => {\r\n        const { useTasks } = await import('../features/tasks')\r\n\r\n        const { result } = renderHook(() => useTasks(null))\r\n\r\n        // Should have default tasks\r\n        expect(result.current.tasks.length).toBeGreaterThan(0)\r\n    })\r\n})\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\test\\integration.test.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'render' is defined but never used.","line":5,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":5,"endColumn":16}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// P3 Integration Tests - End-to-end feature validation\r\n// Tests for CoordinationTab\r\n\r\nimport { describe, it, expect, vi } from 'vitest'\r\nimport { render, screen } from '@testing-library/react'\r\nimport { renderWithContext } from './test-utils'\r\nimport type { MemberStatus, Member } from '../types'\r\n\r\n// Mock Firebase and hooks\r\nvi.mock('../config/firebase', () => ({\r\n    db: {},\r\n    auth: {},\r\n    storage: {}\r\n}))\r\n\r\n// Mock all hooks that use Firebase\r\nvi.mock('../features/helpExchange', () => ({\r\n    useHelpExchange: () => ({\r\n        helpOffers: [],\r\n        helpRequests: [],\r\n        addOffer: vi.fn(),\r\n        addRequest: vi.fn(),\r\n        removeOffer: vi.fn(),\r\n        removeRequest: vi.fn()\r\n    }),\r\n    useHelpExchangeMatch: () => ({\r\n        topMatch: null,\r\n        hasMatches: false,\r\n        match: null,\r\n        dismissMatch: vi.fn()\r\n    }),\r\n    HelpExchange: () => <div data-testid=\"help-exchange\">HelpExchange Mock</div>,\r\n    MatchBanner: () => <div data-testid=\"match-banner\">MatchBanner Mock</div>,\r\n    MatchCelebration: () => <div data-testid=\"match-celebration\">MatchCelebration Mock</div>,\r\n    RELATIVE_OFFERS: [],\r\n    RELATIVE_REQUESTS: [],\r\n    MATCH_PAIRS: [],\r\n    STATUS_MATCHES: ['mock']\r\n}))\r\n\r\n// Mock deep dependencies of CoordinationTab to prevent Firebase calls\r\nvi.mock('../features/symptoms', () => ({\r\n    SymptomSummary: () => <div data-testid=\"symptom-summary\">SymptomSummary</div>\r\n}))\r\nvi.mock('../features/memories/MemoriesGallery', () => ({\r\n    MemoriesGallery: () => <div data-testid=\"memories-gallery\">MemoriesGallery</div>\r\n}))\r\nvi.mock('../features/visualizations/FamilyTree', () => ({\r\n    FamilyTree: () => <div data-testid=\"family-tree\">FamilyTree</div>\r\n}))\r\nvi.mock('../features/onboarding/RelationshipMatrix', () => ({\r\n    RelationshipMatrix: () => <div data-testid=\"relationship-matrix\">RelationshipMatrix</div>\r\n}))\r\nvi.mock('../features/familyPresence', () => ({\r\n    FamilyPresence: () => <div>Familien nu (Mock)</div>,\r\n    StatusSelector: () => <div>StatusSelector</div>,\r\n    STATUS_OPTIONS: [{ id: 'home', icon: 'div' }]\r\n}))\r\n\r\ndescribe('CoordinationTab Integration', () => {\r\n    it('can be imported without error', async () => {\r\n        const { CoordinationTab } = await import('../components/CoordinationTab')\r\n        expect(CoordinationTab).toBeDefined()\r\n    })\r\n\r\n    it('renders with minimal props', async () => {\r\n        const { CoordinationTab } = await import('../components/CoordinationTab')\r\n\r\n        const { container } = renderWithContext(\r\n            <CoordinationTab\r\n                onMatchAction={vi.fn()}\r\n            />, {\r\n            seniorName: 'Brad',\r\n            userName: 'Louise',\r\n            setMyStatus: vi.fn()\r\n        })\r\n        expect(container).toBeTruthy()\r\n    })\r\n\r\n    it('renders FamilyPresence when members provided', async () => {\r\n        const { CoordinationTab } = await import('../components/CoordinationTab')\r\n\r\n        const memberStatuses: MemberStatus[] = [\r\n            { docId: 'brad', displayName: 'Brad', status: 'good', role: 'senior' as const }\r\n        ]\r\n        const members: Member[] = [\r\n            { docId: 'brad', displayName: 'Brad', role: 'senior', userId: 'brad' }\r\n        ]\r\n\r\n        const { container } = renderWithContext(\r\n            <CoordinationTab\r\n                onMatchAction={vi.fn()}\r\n            />, {\r\n            seniorName: 'Brad',\r\n            userName: 'Louise',\r\n            memberStatuses: memberStatuses,\r\n            members: members,\r\n            currentUserId: 'louise',\r\n            setMyStatus: vi.fn()\r\n        })\r\n\r\n        expect(container).toBeTruthy()\r\n        // FamilyPresence render condition depends on members.length > 0\r\n        // Mock renders \"Familien nu (Mock)\"\r\n        expect(screen.getByText(/Familien nu/i)).toBeTruthy()\r\n    })\r\n\r\n    it('shows status selector for user', async () => {\r\n        const { CoordinationTab } = await import('../components/CoordinationTab')\r\n\r\n        renderWithContext(\r\n            <CoordinationTab\r\n                onMatchAction={vi.fn()}\r\n            />, {\r\n            seniorName: 'Brad',\r\n            userName: 'Louise',\r\n            myStatus: 'home',\r\n            setMyStatus: vi.fn()\r\n        })\r\n\r\n        // Should show status section header. Mock t() returns keys.\r\n        // Expect \"din_status\"\r\n        expect(screen.getByText(/din_status/i)).toBeTruthy()\r\n    })\r\n})\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\test\\mocks\\pwa-register.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\test\\setup.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'destination' is defined but never used.","line":65,"column":23,"nodeType":null,"messageId":"unusedVar","endLine":65,"endColumn":34},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'destination' is defined but never used.","line":74,"column":23,"nodeType":null,"messageId":"unusedVar","endLine":74,"endColumn":34}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// Vitest setup file\r\nimport '@testing-library/jest-dom'\r\nimport { vi } from 'vitest'\r\n\r\n// Initialize i18next mock\r\nvi.mock('react-i18next', () => ({\r\n    useTranslation: () => ({\r\n        t: (key: string) => key,\r\n        i18n: {\r\n            changeLanguage: () => new Promise(() => { }),\r\n            language: 'da',\r\n        },\r\n    }),\r\n    initReactI18next: {\r\n        type: '3rdParty',\r\n        init: () => { },\r\n    },\r\n}));\r\n\r\n// Mock Firebase GLOBALLY to prevent initialization errors\r\nvi.mock('firebase/app', () => ({\r\n    initializeApp: vi.fn(),\r\n    getApp: vi.fn(),\r\n    getApps: vi.fn(() => []),\r\n}));\r\n\r\nvi.mock('firebase/auth', () => ({\r\n    getAuth: vi.fn(() => ({})), // Return object\r\n    onAuthStateChanged: vi.fn((auth, callback) => {\r\n        callback({ uid: 'test-user' });\r\n        return vi.fn();\r\n    }),\r\n    GoogleAuthProvider: vi.fn(),\r\n    deleteUser: vi.fn(),\r\n    reauthenticateWithPopup: vi.fn(),\r\n}));\r\n\r\nvi.mock('firebase/firestore', () => ({\r\n    getFirestore: vi.fn(() => ({})), // Return object\r\n    collection: vi.fn(),\r\n    doc: vi.fn(),\r\n    onSnapshot: vi.fn(() => vi.fn()),\r\n    enableMultiTabIndexedDbPersistence: vi.fn(() => Promise.resolve()),\r\n}));\r\n\r\nvi.mock('firebase/storage', () => ({\r\n    getStorage: vi.fn(() => ({})), // Return object\r\n    ref: vi.fn(),\r\n    uploadBytes: vi.fn(),\r\n    getDownloadURL: vi.fn(),\r\n}));\r\n\r\n// Mock AudioContext\r\n(globalThis as unknown as { AudioContext: unknown }).AudioContext = class AudioContext {\r\n    state = 'running';\r\n    baseLatency = 0;\r\n    outputLatency = 0;\r\n    currentTime = 0;\r\n    destination = {} as AudioDestinationNode;\r\n    sampleRate = 44100;\r\n    listener = {} as AudioListener;\r\n    onstatechange = null;\r\n    createOscillator() {\r\n        return {\r\n            connect: (destination: AudioNode | AudioParam) => { }, // Fix signature\r\n            type: 'sine',\r\n            frequency: { setValueAtTime: () => { } },\r\n            start: () => { },\r\n            stop: () => { },\r\n        } as unknown as OscillatorNode;\r\n    }\r\n    createGain() {\r\n        return {\r\n            connect: (destination: AudioNode | AudioParam) => { }, // Fix signature\r\n            gain: {\r\n                setValueAtTime: () => { },\r\n                linearRampToValueAtTime: () => { },\r\n                exponentialRampToValueAtTime: () => { },\r\n            },\r\n        } as unknown as GainNode;\r\n    }\r\n    resume() { return Promise.resolve(); }\r\n    suspend() { return Promise.resolve(); }\r\n    close() { return Promise.resolve(); }\r\n    createMediaElementSource() { return {} as MediaElementAudioSourceNode }\r\n    createMediaStreamSource() { return {} as MediaStreamAudioSourceNode }\r\n    createMediaStreamDestination() { return {} as MediaStreamAudioDestinationNode }\r\n    createBuffer() { return {} as AudioBuffer }\r\n    createBufferSource() { return {} as AudioBufferSourceNode }\r\n    createAnalyser() { return {} as AnalyserNode }\r\n    createBiquadFilter() { return {} as BiquadFilterNode }\r\n    createChannelMerger() { return {} as ChannelMergerNode }\r\n    createChannelSplitter() { return {} as ChannelSplitterNode }\r\n    createConvolver() { return {} as ConvolverNode }\r\n    createDelay() { return {} as DelayNode }\r\n    createDynamicsCompressor() { return {} as DynamicsCompressorNode }\r\n    createIIRFilter() { return {} as IIRFilterNode }\r\n    createPanner() { return {} as PannerNode }\r\n    createPeriodicWave() { return {} as PeriodicWave }\r\n    createScriptProcessor() { return {} as ScriptProcessorNode }\r\n    createStereoPanner() { return {} as StereoPannerNode }\r\n    createWaveShaper() { return {} as WaveShaperNode }\r\n    decodeAudioData() { return Promise.resolve({} as AudioBuffer) }\r\n    dispatchEvent() { return true }\r\n    addEventListener() { }\r\n    removeEventListener() { }\r\n} as unknown as typeof AudioContext;\r\n\r\n(globalThis as unknown as { webkitAudioContext: unknown }).webkitAudioContext = (globalThis as unknown as { AudioContext: unknown }).AudioContext;\r\n\r\n// Mock vite-plugin-pwa\r\nvi.mock('virtual:pwa-register/react', () => ({\r\n    useRegisterSW: () => ({\r\n        offlineReady: [false, () => { }],\r\n        needRefresh: [false, () => { }],\r\n        updateServiceWorker: () => Promise.resolve(),\r\n    }),\r\n}));\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\test\\smoke.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\test\\test-utils.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\test\\useLocalStorage.test.ts","messages":[{"ruleId":"@typescript-eslint/ban-ts-comment","severity":2,"message":"Use \"@ts-expect-error\" instead of \"@ts-ignore\", as \"@ts-ignore\" will do nothing if the following line is error-free.","line":26,"column":9,"nodeType":"Line","messageId":"tsIgnoreInsteadOfExpectError","endLine":26,"endColumn":22,"suggestions":[{"messageId":"replaceTsIgnoreWithTsExpectError","fix":{"range":[897,910],"text":"// @ts-expect-error"},"desc":"Replace \"@ts-ignore\" with \"@ts-expect-error\"."}]},{"ruleId":"@typescript-eslint/ban-ts-comment","severity":2,"message":"Use \"@ts-expect-error\" instead of \"@ts-ignore\", as \"@ts-ignore\" will do nothing if the following line is error-free.","line":43,"column":13,"nodeType":"Line","messageId":"tsIgnoreInsteadOfExpectError","endLine":43,"endColumn":26,"suggestions":[{"messageId":"replaceTsIgnoreWithTsExpectError","fix":{"range":[1527,1540],"text":"// @ts-expect-error"},"desc":"Replace \"@ts-ignore\" with \"@ts-expect-error\"."}]},{"ruleId":"@typescript-eslint/ban-ts-comment","severity":2,"message":"Use \"@ts-expect-error\" instead of \"@ts-ignore\", as \"@ts-ignore\" will do nothing if the following line is error-free.","line":55,"column":13,"nodeType":"Line","messageId":"tsIgnoreInsteadOfExpectError","endLine":55,"endColumn":26,"suggestions":[{"messageId":"replaceTsIgnoreWithTsExpectError","fix":{"range":[1907,1920],"text":"// @ts-expect-error"},"desc":"Replace \"@ts-ignore\" with \"@ts-expect-error\"."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// Tests for useLocalStorage hook\r\nimport { describe, it, expect, beforeEach, vi } from 'vitest'\r\nimport { renderHook, act } from '@testing-library/react'\r\nimport { useLocalStorage } from '../hooks/useLocalStorage'\r\n\r\ndescribe('useLocalStorage', () => {\r\n    beforeEach(() => {\r\n        // Clear localStorage before each test\r\n        localStorage.clear()\r\n        vi.clearAllMocks()\r\n    })\r\n\r\n    it('returns initial value when localStorage is empty', () => {\r\n        const { result } = renderHook(() => useLocalStorage('test-key', 'initial'))\r\n        expect(result.current[0]).toBe('initial')\r\n    })\r\n\r\n    it('stores value in localStorage when updated', () => {\r\n        const { result } = renderHook(() => useLocalStorage('test-key', 'initial'))\r\n\r\n        act(() => {\r\n            result.current[1]('new value')\r\n        })\r\n\r\n        expect(result.current[0]).toBe('new value')\r\n        // @ts-ignore\r\n        expect(JSON.parse(localStorage.getItem('test-key')!)).toBe('new value')\r\n    })\r\n\r\n    it('retrieves existing value from localStorage', () => {\r\n        localStorage.setItem('existing-key', JSON.stringify('stored value'))\r\n\r\n        const { result } = renderHook(() => useLocalStorage('existing-key', 'initial'))\r\n\r\n        expect(result.current[0]).toBe('stored value')\r\n    })\r\n\r\n    it('handles objects correctly', () => {\r\n        const testObject = { name: 'Birthe', tasks: [1, 2, 3] }\r\n        const { result } = renderHook(() => useLocalStorage('object-key', {}))\r\n\r\n        act(() => {\r\n            // @ts-ignore\r\n            result.current[1](testObject)\r\n        })\r\n\r\n        expect(result.current[0]).toEqual(testObject)\r\n    })\r\n\r\n    it('handles arrays correctly', () => {\r\n        const testArray = [{ id: 1, completed: false }, { id: 2, completed: true }]\r\n        const { result } = renderHook(() => useLocalStorage('array-key', []))\r\n\r\n        act(() => {\r\n            // @ts-ignore\r\n            result.current[1](testArray)\r\n        })\r\n\r\n        expect(result.current[0]).toEqual(testArray)\r\n    })\r\n})\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\test\\views.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\types.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\utils\\assetUtils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\utils\\briefing.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'_seniorName' is assigned a value but never used.","line":129,"column":54,"nodeType":null,"messageId":"unusedVar","endLine":129,"endColumn":65}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * Daily Briefing Generator\r\n * \r\n * Creates natural language summaries of the senior's day.\r\n * Designed to reduce anxiety for relatives by providing\r\n * a human-readable status instead of raw data.\r\n */\r\n\r\nimport { Task, SymptomLog, FirestoreDate } from '../types';\r\nimport { TFunction } from 'i18next';\r\n\r\ninterface BriefingParams {\r\n    tasks?: Task[];\r\n    symptoms?: SymptomLog[];\r\n    seniorName?: string;\r\n    lastCheckIn?: string | null;\r\n    t: TFunction; // i18next t function\r\n}\r\n\r\n/**\r\n * Helper to check if a timestamp is from today\r\n */\r\nconst isToday = (date: FirestoreDate | undefined): boolean => {\r\n    if (!date) return false;\r\n    let d: Date;\r\n    if (date && typeof date === 'object' && 'toDate' in date) {\r\n        d = date.toDate();\r\n    } else if (typeof date === 'string') {\r\n        d = new Date(date);\r\n    } else {\r\n        d = new Date(date);\r\n    }\r\n    const today = new Date();\r\n    return d.toDateString() === today.toDateString();\r\n};\r\n\r\n/**\r\n * Generate a natural language daily briefing\r\n */\r\nexport function getDailyBriefing({ tasks = [], symptoms = [], seniorName = 'Mor', lastCheckIn = null, t }: BriefingParams) {\r\n    const firstName = seniorName.split(' ')[0]; // Use first name for warmth\r\n\r\n    // Calculate task stats\r\n    const medicineTasks = tasks.filter(t =>\r\n        t.title?.toLowerCase().includes('medicin') ||\r\n        t.title?.toLowerCase().includes('pille') ||\r\n        (t as unknown as { type: string }).type === 'medication'\r\n    );\r\n    const allTasksComplete = tasks.length > 0 && tasks.every(t => t.completed);\r\n    const allMedicineComplete = medicineTasks.length > 0 && medicineTasks.every(t => t.completed);\r\n    const completedMedicine = medicineTasks.filter(t => t.completed).length;\r\n\r\n    // Today's symptoms\r\n    const todaySymptoms = symptoms.filter(s => isToday(s.loggedAt));\r\n    const hasSymptoms = todaySymptoms.length > 0;\r\n\r\n    // Calculate medicine streak (simplified - just check if today's done)\r\n    // In a real app, you'd query historical data\r\n    // const streak = allMedicineComplete ? Math.floor(Math.random() * 7) + 1 : 0; // Placeholder - unused\r\n\r\n    // Generate briefing based on conditions\r\n\r\n    // Best case: Everything done, no symptoms\r\n    if (allMedicineComplete && !hasSymptoms) {\r\n        if (allTasksComplete) {\r\n            return {\r\n                message: t('daily_briefing_all_fine', { name: firstName }),\r\n                emoji: '九',\r\n                type: 'success' as const\r\n            };\r\n        }\r\n        return {\r\n            message: t('daily_briefing_meds_fine', { name: firstName }),\r\n            emoji: '游눜',\r\n            type: 'success' as const\r\n        };\r\n    }\r\n\r\n    // Symptoms logged but medicine taken\r\n    if (allMedicineComplete && hasSymptoms) {\r\n        // Hero card already shows \"New Symptoms\", so we silence the briefing to avoid redundancy.\r\n        return null;\r\n    }\r\n\r\n    // Medicine not complete but symptoms logged\r\n    if (!allMedicineComplete && hasSymptoms) {\r\n        if (medicineTasks.length === 0) {\r\n            // Hero card already shows \"New Symptoms\", so we silence the briefing to avoid redundancy.\r\n            return null;\r\n        }\r\n\r\n        return {\r\n            message: t('daily_briefing_symptom_warning', { name: firstName, completed: completedMedicine, total: medicineTasks.length }),\r\n            emoji: '丘멆잺',\r\n            type: 'warning' as const\r\n        };\r\n    }\r\n\r\n    // Medicine not complete, no symptoms\r\n    if (!allMedicineComplete && medicineTasks.length > 0) {\r\n        const remaining = medicineTasks.length - completedMedicine;\r\n        return {\r\n            message: t('daily_briefing_meds_missing', { name: firstName, count: remaining }),\r\n            emoji: '游눍',\r\n            type: 'info' as const\r\n        };\r\n    }\r\n\r\n    // No tasks at all - show neutral status\r\n    if (lastCheckIn && isToday(lastCheckIn)) {\r\n        return {\r\n            message: t('daily_briefing_checked_in', { name: firstName }),\r\n            emoji: '游녨',\r\n            type: 'success' as const\r\n        };\r\n    }\r\n\r\n    // No activity yet today\r\n    return {\r\n        message: t('daily_briefing_no_activity', { name: firstName }),\r\n        emoji: '游눣',\r\n        type: 'info' as const\r\n    };\r\n}\r\n\r\n/**\r\n * Get streak message if applicable\r\n */\r\nexport function getStreakMessage(streakDays: number, _seniorName = 'Mor', t: TFunction) {\r\n    if (streakDays >= 7) {\r\n        return t('streak_msg_7', { count: streakDays });\r\n    }\r\n    if (streakDays >= 3) {\r\n        return t('streak_msg_3', { count: streakDays });\r\n    }\r\n    return null;\r\n}\r\n\r\nexport default getDailyBriefing;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\utils\\dateUtils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\utils\\imageUtils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\utils\\notifications.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\dinko\\Projects\\PNWS\\tryg-app\\src\\utils\\sounds.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]}]